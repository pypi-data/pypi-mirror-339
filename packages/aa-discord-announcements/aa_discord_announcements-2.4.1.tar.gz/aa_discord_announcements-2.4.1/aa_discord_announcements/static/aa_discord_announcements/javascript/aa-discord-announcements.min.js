$(document).ready(()=>{const n=$("select#id_announcement_target"),s=$("select#id_announcement_channel"),t=$('input[name="csrfmiddlewaretoken"]'),a=$('textarea[name="announcement_text"]'),o=$("#aa-discord-announcements-form"),e=()=>{$.ajax({url:discordAnnouncementsSettings.url.getAnnouncementTargets,success:e=>{$(n).html(e)}})},c=()=>{$.ajax({url:discordAnnouncementsSettings.url.getAnnouncementWebhooks,success:e=>{$(s).html(e)}})},r=(e,n=10)=>{$(e).fadeTo(1e3*n,500).slideUp(500,()=>{$(e).remove()})},d=(e,n)=>{$(n).html(`<div class="alert alert-success alert-dismissible alert-message-success d-flex align-items-center fade show">${e}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>`),r(".alert-message-success")},i=(e,n)=>{$(n).html(`<div class="alert alert-danger alert-dismissible alert-message-error d-flex align-items-center fade show">${e}<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>`),r(".alert-message-error",9999)},m=()=>{const n=new ClipboardJS("button#copyDiscordAnnouncement");n.on("success",e=>{d(discordAnnouncementsTranslations.copyToClipboard.success,".aa-discord-announcements-announcement-copyresult"),e.clearSelection(),n.destroy()}),n.on("error",()=>{i(discordAnnouncementsTranslations.copyToClipboard.error,".aa-discord-announcements-announcement-copyresult"),n.destroy()})};o.submit(e=>{e.preventDefault(),$(".aa-discord-announcements-form-message div").remove();const n=[a.val()];if(n.includes(""))return i(discordAnnouncementsTranslations.error.missingFields,".aa-discord-announcements-form-message"),!1;const s=o.serializeArray().reduce((e,n)=>(e[n.name]=n.value,e),{});fetch(discordAnnouncementsSettings.url.createAnnouncement,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":t.val()},body:JSON.stringify(s)}).then(e=>e.json()).then(e=>{!0===e.success?($(".aa-discord-announcements-no-announcement").hide("fast"),$(".aa-discord-announcements-announcement").show("fast"),$(".aa-discord-announcements-announcement-text").html(e.announcement_context),e.message&&d(e.message,".aa-discord-announcements-form-message")):e.message?i(e.message,".aa-discord-announcements-form-message"):i("Something went wrong, no details given.",".aa-discord-announcements-form-message")}).catch(()=>{i("Something went wrong, no details given.",".aa-discord-announcements-form-message")})}),$("button#copyDiscordAnnouncement").on("click",()=>{m()}),e(),c()});
//# sourceMappingURL=aa-discord-announcements.min.js.map