(function(){"use strict";function Mt(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}var At={value:()=>{}};function st(){for(var t=0,n=arguments.length,e={},r;t<n;++t){if(!(r=arguments[t]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new V(e)}function V(t){this._=t}function kt(t,n){return t.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}V.prototype=st.prototype={constructor:V,on:function(t,n){var e=this._,r=kt(t+"",e),i,a=-1,l=r.length;if(arguments.length<2){for(;++a<l;)if((i=(t=r[a]).type)&&(i=Tt(e[i],t.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++a<l;)if(i=(t=r[a]).type)e[i]=ut(e[i],t.name,n);else if(n==null)for(i in e)e[i]=ut(e[i],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new V(t)},call:function(t,n){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,a;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,i=a.length;r<i;++r)a[r].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(n,e)}};function Tt(t,n){for(var e=0,r=t.length,i;e<r;++e)if((i=t[e]).name===n)return i.value}function ut(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=At,t=t.slice(0,r).concat(t.slice(r+1));break}return e!=null&&t.push({name:n,value:e}),t}var $=0,P=0,B=0,ft=1e3,Z,X,G=0,b=0,H=0,L=typeof performance=="object"&&performance.now?performance:Date,lt=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ct(){return b||(lt(Et),b=L.now()+H)}function Et(){b=0}function W(){this._call=this._time=this._next=null}W.prototype=ht.prototype={constructor:W,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?ct():+e)+(n==null?0:+n),!this._next&&X!==this&&(X?X._next=this:Z=this,X=this),this._call=t,this._time=e,K()},stop:function(){this._call&&(this._call=null,this._time=1/0,K())}};function ht(t,n,e){var r=new W;return r.restart(t,n,e),r}function Ct(){ct(),++$;for(var t=Z,n;t;)(n=b-t._time)>=0&&t._call.call(void 0,n),t=t._next;--$}function gt(){b=(G=L.now())+H,$=P=0;try{Ct()}finally{$=0,jt(),b=0}}function Dt(){var t=L.now(),n=t-G;n>ft&&(H-=n,G=t)}function jt(){for(var t,n=Z,e,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Z=e);X=t,K(r)}function K(t){if(!$){P&&(P=clearTimeout(P));var n=t-b;n>24?(t<1/0&&(P=setTimeout(gt,t-L.now()-H)),B&&(B=clearInterval(B))):(B||(G=L.now(),B=setInterval(Dt,ft)),$=1,lt(gt))}}var vt={},tt={},nt=34,q=10,et=13;function yt(t){return new Function("d","return {"+t.map(function(n,e){return JSON.stringify(n)+": d["+e+'] || ""'}).join(",")+"}")}function It(t,n){var e=yt(t);return function(r,i){return n(e(r),i,t)}}function pt(t){var n=Object.create(null),e=[];return t.forEach(function(r){for(var i in r)i in n||e.push(n[i]=i)}),e}function C(t,n){var e=t+"",r=e.length;return r<n?new Array(n-r+1).join(0)+e:e}function St(t){return t<0?"-"+C(-t,6):t>9999?"+"+C(t,6):C(t,4)}function Ft(t){var n=t.getUTCHours(),e=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":St(t.getUTCFullYear())+"-"+C(t.getUTCMonth()+1,2)+"-"+C(t.getUTCDate(),2)+(i?"T"+C(n,2)+":"+C(e,2)+":"+C(r,2)+"."+C(i,3)+"Z":r?"T"+C(n,2)+":"+C(e,2)+":"+C(r,2)+"Z":e||n?"T"+C(n,2)+":"+C(e,2)+"Z":"")}function zt(t){var n=new RegExp('["'+t+`
\r]`),e=t.charCodeAt(0);function r(h,v){var f,p,u=i(h,function(s,c){if(f)return f(s,c-1);p=s,f=v?It(s,v):yt(s)});return u.columns=p||[],u}function i(h,v){var f=[],p=h.length,u=0,s=0,c,d=p<=0,_=!1;h.charCodeAt(p-1)===q&&--p,h.charCodeAt(p-1)===et&&--p;function x(){if(d)return tt;if(_)return _=!1,vt;var M,A=u,N;if(h.charCodeAt(A)===nt){for(;u++<p&&h.charCodeAt(u)!==nt||h.charCodeAt(++u)===nt;);return(M=u)>=p?d=!0:(N=h.charCodeAt(u++))===q?_=!0:N===et&&(_=!0,h.charCodeAt(u)===q&&++u),h.slice(A+1,M-1).replace(/""/g,'"')}for(;u<p;){if((N=h.charCodeAt(M=u++))===q)_=!0;else if(N===et)_=!0,h.charCodeAt(u)===q&&++u;else if(N!==e)continue;return h.slice(A,M)}return d=!0,h.slice(A,p)}for(;(c=x())!==tt;){for(var m=[];c!==vt&&c!==tt;)m.push(c),c=x();v&&(m=v(m,s++))==null||f.push(m)}return f}function a(h,v){return h.map(function(f){return v.map(function(p){return y(f[p])}).join(t)})}function l(h,v){return v==null&&(v=pt(h)),[v.map(y).join(t)].concat(a(h,v)).join(`
`)}function g(h,v){return v==null&&(v=pt(h)),a(h,v).join(`
`)}function w(h){return h.map(o).join(`
`)}function o(h){return h.map(y).join(t)}function y(h){return h==null?"":h instanceof Date?Ft(h):n.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:r,parseRows:i,format:l,formatBody:g,formatRows:w,formatRow:o,formatValue:y}}var Rt=zt(","),Ut=Rt.parse;function Ot(t,n){var e,r=1;t==null&&(t=0),n==null&&(n=0);function i(){var a,l=e.length,g,w=0,o=0;for(a=0;a<l;++a)g=e[a],w+=g.x,o+=g.y;for(w=(w/l-t)*r,o=(o/l-n)*r,a=0;a<l;++a)g=e[a],g.x-=w,g.y-=o}return i.initialize=function(a){e=a},i.x=function(a){return arguments.length?(t=+a,i):t},i.y=function(a){return arguments.length?(n=+a,i):n},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function bt(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return dt(this.cover(n,e),n,e,t)}function dt(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,a=t._root,l={data:r},g=t._x0,w=t._y0,o=t._x1,y=t._y1,h,v,f,p,u,s,c,d;if(!a)return t._root=l,t;for(;a.length;)if((u=n>=(h=(g+o)/2))?g=h:o=h,(s=e>=(v=(w+y)/2))?w=v:y=v,i=a,!(a=a[c=s<<1|u]))return i[c]=l,t;if(f=+t._x.call(null,a.data),p=+t._y.call(null,a.data),n===f&&e===p)return l.next=a,i?i[c]=l:t._root=l,t;do i=i?i[c]=new Array(4):t._root=new Array(4),(u=n>=(h=(g+o)/2))?g=h:o=h,(s=e>=(v=(w+y)/2))?w=v:y=v;while((c=s<<1|u)===(d=(p>=v)<<1|f>=h));return i[d]=a,i[c]=l,t}function Yt(t){var n,e,r=t.length,i,a,l=new Array(r),g=new Array(r),w=1/0,o=1/0,y=-1/0,h=-1/0;for(e=0;e<r;++e)isNaN(i=+this._x.call(null,n=t[e]))||isNaN(a=+this._y.call(null,n))||(l[e]=i,g[e]=a,i<w&&(w=i),i>y&&(y=i),a<o&&(o=a),a>h&&(h=a));if(w>y||o>h)return this;for(this.cover(w,o).cover(y,h),e=0;e<r;++e)dt(this,l[e],g[e],t[e]);return this}function $t(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,a=(r=Math.floor(n))+1;else{for(var l=i-e||1,g=this._root,w,o;e>t||t>=i||r>n||n>=a;)switch(o=(n<r)<<1|t<e,w=new Array(4),w[o]=g,g=w,l*=2,o){case 0:i=e+l,a=r+l;break;case 1:e=i-l,a=r+l;break;case 2:i=e+l,r=a-l;break;case 3:e=i-l,r=a-l;break}this._root&&this._root.length&&(this._root=g)}return this._x0=e,this._y0=r,this._x1=i,this._y1=a,this}function Pt(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function Bt(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function T(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function Xt(t,n,e){var r,i=this._x0,a=this._y0,l,g,w,o,y=this._x1,h=this._y1,v=[],f=this._root,p,u;for(f&&v.push(new T(f,i,a,y,h)),e==null?e=1/0:(i=t-e,a=n-e,y=t+e,h=n+e,e*=e);p=v.pop();)if(!(!(f=p.node)||(l=p.x0)>y||(g=p.y0)>h||(w=p.x1)<i||(o=p.y1)<a))if(f.length){var s=(l+w)/2,c=(g+o)/2;v.push(new T(f[3],s,c,w,o),new T(f[2],l,c,s,o),new T(f[1],s,g,w,c),new T(f[0],l,g,s,c)),(u=(n>=c)<<1|t>=s)&&(p=v[v.length-1],v[v.length-1]=v[v.length-1-u],v[v.length-1-u]=p)}else{var d=t-+this._x.call(null,f.data),_=n-+this._y.call(null,f.data),x=d*d+_*_;if(x<e){var m=Math.sqrt(e=x);i=t-m,a=n-m,y=t+m,h=n+m,r=f.data}}return r}function Lt(t){if(isNaN(y=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var n,e=this._root,r,i,a,l=this._x0,g=this._y0,w=this._x1,o=this._y1,y,h,v,f,p,u,s,c;if(!e)return this;if(e.length)for(;;){if((p=y>=(v=(l+w)/2))?l=v:w=v,(u=h>=(f=(g+o)/2))?g=f:o=f,n=e,!(e=e[s=u<<1|p]))return this;if(!e.length)break;(n[s+1&3]||n[s+2&3]||n[s+3&3])&&(r=n,c=s)}for(;e.data!==t;)if(i=e,!(e=e.next))return this;return(a=e.next)&&delete e.next,i?(a?i.next=a:delete i.next,this):n?(a?n[s]=a:delete n[s],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(r?r[c]=e:this._root=e),this):(this._root=a,this)}function qt(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function Qt(){return this._root}function Vt(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function Zt(t){var n=[],e,r=this._root,i,a,l,g,w;for(r&&n.push(new T(r,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(r=e.node,a=e.x0,l=e.y0,g=e.x1,w=e.y1)&&r.length){var o=(a+g)/2,y=(l+w)/2;(i=r[3])&&n.push(new T(i,o,y,g,w)),(i=r[2])&&n.push(new T(i,a,y,o,w)),(i=r[1])&&n.push(new T(i,o,l,g,y)),(i=r[0])&&n.push(new T(i,a,l,o,y))}return this}function Gt(t){var n=[],e=[],r;for(this._root&&n.push(new T(this._root,this._x0,this._y0,this._x1,this._y1));r=n.pop();){var i=r.node;if(i.length){var a,l=r.x0,g=r.y0,w=r.x1,o=r.y1,y=(l+w)/2,h=(g+o)/2;(a=i[0])&&n.push(new T(a,l,g,y,h)),(a=i[1])&&n.push(new T(a,y,g,w,h)),(a=i[2])&&n.push(new T(a,l,h,y,o)),(a=i[3])&&n.push(new T(a,y,h,w,o))}e.push(r)}for(;r=e.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function Ht(t){return t[0]}function Jt(t){return arguments.length?(this._x=t,this):this._x}function Wt(t){return t[1]}function Kt(t){return arguments.length?(this._y=t,this):this._y}function rt(t,n,e){var r=new it(n??Ht,e??Wt,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function it(t,n,e,r,i,a){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function wt(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var E=rt.prototype=it.prototype;E.copy=function(){var t=new it(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,r;if(!n)return t;if(!n.length)return t._root=wt(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var i=0;i<4;++i)(r=n.source[i])&&(r.length?e.push({source:r,target:n.target[i]=new Array(4)}):n.target[i]=wt(r));return t},E.add=bt,E.addAll=Yt,E.cover=$t,E.data=Pt,E.extent=Bt,E.find=Xt,E.remove=Lt,E.removeAll=qt,E.root=Qt,E.size=Vt,E.visit=Zt,E.visitAfter=Gt,E.x=Jt,E.y=Kt;function j(t){return function(){return t}}function F(t){return(t()-.5)*1e-6}function tn(t){return t.x+t.vx}function nn(t){return t.y+t.vy}function en(t){var n,e,r,i=1,a=1;typeof t!="function"&&(t=j(t==null?1:+t));function l(){for(var o,y=n.length,h,v,f,p,u,s,c=0;c<a;++c)for(h=rt(n,tn,nn).visitAfter(g),o=0;o<y;++o)v=n[o],u=e[v.index],s=u*u,f=v.x+v.vx,p=v.y+v.vy,h.visit(d);function d(_,x,m,M,A){var N=_.data,I=_.r,k=u+I;if(N){if(N.index>v.index){var U=f-N.x-N.vx,O=p-N.y-N.vy,S=U*U+O*O;S<k*k&&(U===0&&(U=F(r),S+=U*U),O===0&&(O=F(r),S+=O*O),S=(k-(S=Math.sqrt(S)))/S*i,v.vx+=(U*=S)*(k=(I*=I)/(s+I)),v.vy+=(O*=S)*k,N.vx-=U*(k=1-k),N.vy-=O*k)}return}return x>f+k||M<f-k||m>p+k||A<p-k}}function g(o){if(o.data)return o.r=e[o.data.index];for(var y=o.r=0;y<4;++y)o[y]&&o[y].r>o.r&&(o.r=o[y].r)}function w(){if(n){var o,y=n.length,h;for(e=new Array(y),o=0;o<y;++o)h=n[o],e[h.index]=+t(h,o,n)}}return l.initialize=function(o,y){n=o,r=y,w()},l.iterations=function(o){return arguments.length?(a=+o,l):a},l.strength=function(o){return arguments.length?(i=+o,l):i},l.radius=function(o){return arguments.length?(t=typeof o=="function"?o:j(+o),w(),l):t},l}function rn(t){return t.index}function xt(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function on(t){var n=rn,e=h,r,i=j(30),a,l,g,w,o,y=1;t==null&&(t=[]);function h(s){return 1/Math.min(g[s.source.index],g[s.target.index])}function v(s){for(var c=0,d=t.length;c<y;++c)for(var _=0,x,m,M,A,N,I,k;_<d;++_)x=t[_],m=x.source,M=x.target,A=M.x+M.vx-m.x-m.vx||F(o),N=M.y+M.vy-m.y-m.vy||F(o),I=Math.sqrt(A*A+N*N),I=(I-a[_])/I*s*r[_],A*=I,N*=I,M.vx-=A*(k=w[_]),M.vy-=N*k,m.vx+=A*(k=1-k),m.vy+=N*k}function f(){if(l){var s,c=l.length,d=t.length,_=new Map(l.map((m,M)=>[n(m,M,l),m])),x;for(s=0,g=new Array(c);s<d;++s)x=t[s],x.index=s,typeof x.source!="object"&&(x.source=xt(_,x.source)),typeof x.target!="object"&&(x.target=xt(_,x.target)),g[x.source.index]=(g[x.source.index]||0)+1,g[x.target.index]=(g[x.target.index]||0)+1;for(s=0,w=new Array(d);s<d;++s)x=t[s],w[s]=g[x.source.index]/(g[x.source.index]+g[x.target.index]);r=new Array(d),p(),a=new Array(d),u()}}function p(){if(l)for(var s=0,c=t.length;s<c;++s)r[s]=+e(t[s],s,t)}function u(){if(l)for(var s=0,c=t.length;s<c;++s)a[s]=+i(t[s],s,t)}return v.initialize=function(s,c){l=s,o=c,f()},v.links=function(s){return arguments.length?(t=s,f(),v):t},v.id=function(s){return arguments.length?(n=s,v):n},v.iterations=function(s){return arguments.length?(y=+s,v):y},v.strength=function(s){return arguments.length?(e=typeof s=="function"?s:j(+s),p(),v):e},v.distance=function(s){return arguments.length?(i=typeof s=="function"?s:j(+s),u(),v):i},v}const an=1664525,sn=1013904223,_t=4294967296;function un(){let t=1;return()=>(t=(an*t+sn)%_t)/_t}function fn(t){return t.x}function ln(t){return t.y}var cn=10,hn=Math.PI*(3-Math.sqrt(5));function gn(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),a=0,l=.6,g=new Map,w=ht(h),o=st("tick","end"),y=un();t==null&&(t=[]);function h(){v(),o.call("tick",n),e<r&&(w.stop(),o.call("end",n))}function v(u){var s,c=t.length,d;u===void 0&&(u=1);for(var _=0;_<u;++_)for(e+=(a-e)*i,g.forEach(function(x){x(e)}),s=0;s<c;++s)d=t[s],d.fx==null?d.x+=d.vx*=l:(d.x=d.fx,d.vx=0),d.fy==null?d.y+=d.vy*=l:(d.y=d.fy,d.vy=0);return n}function f(){for(var u=0,s=t.length,c;u<s;++u){if(c=t[u],c.index=u,c.fx!=null&&(c.x=c.fx),c.fy!=null&&(c.y=c.fy),isNaN(c.x)||isNaN(c.y)){var d=cn*Math.sqrt(.5+u),_=u*hn;c.x=d*Math.cos(_),c.y=d*Math.sin(_)}(isNaN(c.vx)||isNaN(c.vy))&&(c.vx=c.vy=0)}}function p(u){return u.initialize&&u.initialize(t,y),u}return f(),n={tick:v,restart:function(){return w.restart(h),n},stop:function(){return w.stop(),n},nodes:function(u){return arguments.length?(t=u,f(),g.forEach(p),n):t},alpha:function(u){return arguments.length?(e=+u,n):e},alphaMin:function(u){return arguments.length?(r=+u,n):r},alphaDecay:function(u){return arguments.length?(i=+u,n):+i},alphaTarget:function(u){return arguments.length?(a=+u,n):a},velocityDecay:function(u){return arguments.length?(l=1-u,n):1-l},randomSource:function(u){return arguments.length?(y=u,g.forEach(p),n):y},force:function(u,s){return arguments.length>1?(s==null?g.delete(u):g.set(u,p(s)),n):g.get(u)},find:function(u,s,c){var d=0,_=t.length,x,m,M,A,N;for(c==null?c=1/0:c*=c,d=0;d<_;++d)A=t[d],x=u-A.x,m=s-A.y,M=x*x+m*m,M<c&&(N=A,c=M);return N},on:function(u,s){return arguments.length>1?(o.on(u,s),n):o.on(u)}}}function vn(){var t,n,e,r,i=j(-30),a,l=1,g=1/0,w=.81;function o(f){var p,u=t.length,s=rt(t,fn,ln).visitAfter(h);for(r=f,p=0;p<u;++p)n=t[p],s.visit(v)}function y(){if(t){var f,p=t.length,u;for(a=new Array(p),f=0;f<p;++f)u=t[f],a[u.index]=+i(u,f,t)}}function h(f){var p=0,u,s,c=0,d,_,x;if(f.length){for(d=_=x=0;x<4;++x)(u=f[x])&&(s=Math.abs(u.value))&&(p+=u.value,c+=s,d+=s*u.x,_+=s*u.y);f.x=d/c,f.y=_/c}else{u=f,u.x=u.data.x,u.y=u.data.y;do p+=a[u.data.index];while(u=u.next)}f.value=p}function v(f,p,u,s){if(!f.value)return!0;var c=f.x-n.x,d=f.y-n.y,_=s-p,x=c*c+d*d;if(_*_/w<x)return x<g&&(c===0&&(c=F(e),x+=c*c),d===0&&(d=F(e),x+=d*d),x<l&&(x=Math.sqrt(l*x)),n.vx+=c*f.value*r/x,n.vy+=d*f.value*r/x),!0;if(f.length||x>=g)return;(f.data!==n||f.next)&&(c===0&&(c=F(e),x+=c*c),d===0&&(d=F(e),x+=d*d),x<l&&(x=Math.sqrt(l*x)));do f.data!==n&&(_=a[f.data.index]*r/x,n.vx+=c*_,n.vy+=d*_);while(f=f.next)}return o.initialize=function(f,p){t=f,e=p,y()},o.strength=function(f){return arguments.length?(i=typeof f=="function"?f:j(+f),y(),o):i},o.distanceMin=function(f){return arguments.length?(l=f*f,o):Math.sqrt(l)},o.distanceMax=function(f){return arguments.length?(g=f*f,o):Math.sqrt(g)},o.theta=function(f){return arguments.length?(w=f*f,o):Math.sqrt(w)},o}function yn(t,n,e){var r,i=j(.1),a,l;typeof t!="function"&&(t=j(+t)),n==null&&(n=0),e==null&&(e=0);function g(o){for(var y=0,h=r.length;y<h;++y){var v=r[y],f=v.x-n||1e-6,p=v.y-e||1e-6,u=Math.sqrt(f*f+p*p),s=(l[y]-u)*a[y]*o/u;v.vx+=f*s,v.vy+=p*s}}function w(){if(r){var o,y=r.length;for(a=new Array(y),l=new Array(y),o=0;o<y;++o)l[o]=+t(r[o],o,r),a[o]=isNaN(l[o])?0:+i(r[o],o,r)}}return g.initialize=function(o){r=o,w()},g.strength=function(o){return arguments.length?(i=typeof o=="function"?o:j(+o),w(),g):i},g.radius=function(o){return arguments.length?(t=typeof o=="function"?o:j(+o),w(),g):t},g.x=function(o){return arguments.length?(n=+o,g):n},g.y=function(o){return arguments.length?(e=+o,g):e},g}function Q(t,n,e){this.k=t,this.x=n,this.y=e}Q.prototype={constructor:Q,scale:function(t){return t===1?this:new Q(this.k*t,this.x,this.y)},translate:function(t,n){return t===0&n===0?this:new Q(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},Q.prototype,postMessage({type:"ready"});let mt=1,z=1,pn={inverseMinDegree:(t,n,e)=>z*t.weight/Math.min(t.source.degree,t.target.degree),inverseSumDegree:(t,n,e)=>z/(t.source.degree+t.target.degree),inverseSumSqrtDegree:(t,n,e)=>z/(Math.sqrt(t.source.degree)+Math.sqrt(t.target.degree)),constant:(t,n,e)=>z,radius:(t,n,e)=>z*z/Math.min(R.radius()(t.source,0,[]),R.radius()(t.target,0,[]))},dn={sumSqrtDegree:(t,n,e)=>(Math.sqrt(t.source.degree)+Math.sqrt(t.target.degree))*mt/t.weight,constant:(t,n,e)=>mt/20,radius:(t,n,e)=>(2-z)*(R.radius()(t.source,0,[])+R.radius()(t.target,0,[]))},Y=on().id(t=>t.id).distance(dn.sumSqrtDegree).strength(pn.inverseMinDegree),J=vn(),R=en(),ot=Ot(),at=yn(0),D=gn().alphaMin(0).alphaTarget(0).alphaDecay(0).stop();const Nt=t=>{function n(){postMessage({type:"positions",positions:t.nodes.map(r=>({x:r.x,y:r.y}))})}t.links=t.links||t.edges,t.links=t.links.map(r=>{let i=r;return Array.isArray(i)&&(i={source:r[0],target:r[1],weight:r[2]===void 0?1:r[2]}),i.source=""+i.source,i.target=""+i.target,i.weight=i.weight===void 0?1:+i.weight,i}),t.nodes||(t.nodes=Array.from(new Set([...t.links.map(r=>r.source),...t.links.map(r=>r.target)])).map((r,i)=>({degree:0,id:r,index:i})));const e={};t.nodes.forEach((r,i)=>{r.degree=0,r.id=""+r.id,r.index=i,e[r.id]=r}),t.links=t.links.filter(r=>e[r.source]&&e[r.target]),t.links.forEach(r=>{const i=r.weight!==void 0?+r.weight:1;e[r.source].degree=+e[r.source].degree+i,e[r.target].degree=+e[r.target].degree+i}),t.nodes.sort((r,i)=>Mt(r.degree,i.degree)),D.nodes(t.nodes).alpha(1).on("tick",n),postMessage({type:"graph",graph:t}),postMessage({type:"positions",positions:t.nodes.map(r=>({x:r.x,y:r.y}))}),Y.links(t.links),D.force("link",Y),D.force("charge",J),D.force("collide",R),D.force("center",ot),D.force("gravity",at)};onmessage=function(t){if(t.data.type==="start")D.restart();else if(t.data.type==="stop")D.stop();else if(t.data.type==="loadCSV")Nt({links:Ut(t.data.text)});else if(t.data.type==="loadGraph")Nt(t.data.graph);else if(t.data.type==="chargeApproximation")J.theta(t.data.value);else if(t.data.type==="energy")D.alpha(t.data.value);else if(t.data.type==="radii")R.radius((n,e)=>t.data.value[e]);else if(t.data.type==="linkFactor")D.force("link",t.data.value?Y:null),z=t.data.value,Y.distance(Y.distance()),Y.strength(Y.strength());else if(t.data.type==="chargeStrength")D.force("charge",t.data.value?J:null),J.strength(-t.data.value);else if(t.data.type==="collideFactor")D.force("collide",t.data.value?R:null),R.strength(t.data.value);else if(t.data.type==="centerForce")D.force("center",t.data.value?ot:null),ot.strength(t.data.value);else if(t.data.type==="gravity")D.force("gravity",t.data.value?at:null),at.strength(t.data.value);else throw Error(`Unknown message type '${t.data.type}'`)}})();
