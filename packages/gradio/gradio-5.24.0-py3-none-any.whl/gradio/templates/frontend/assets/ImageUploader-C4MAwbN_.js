import"./IconButtonWrapper.svelte_svelte_type_style_lang-Bcv5C2d8.js";import"./MarkdownCode.svelte_svelte_type_style_lang-BAImCCw0.js";import{B as _t}from"./BlockLabel-DblqP5Sf.js";import{I as ft}from"./IconButton-BgomsPvt.js";import{C as mt}from"./Clear-By3xiIwg.js";import{I as dt,F as gt}from"./FullscreenButton-CwT-XVTN.js";import{W as ht,a as pt,S as bt}from"./SelectSource-DE5C9IlG.js";import{I as wt}from"./IconButtonWrapper-BPnBuW_R.js";import{g as vt}from"./utils-Gtzs_Zla.js";import{D as rt}from"./DropdownArrow-Cz8zw9hm.js";import{S as kt}from"./Square-oAGqOwsh.js";import"./StreamingBar.svelte_svelte_type_style_lang-CDNxkBIr.js";import{f as yt}from"./index-pMlXmYRY.js";import{S as It}from"./StreamingBar-BU9S4hA7.js";import{f as zt}from"./index-DoYKQVZE.js";import{a as Ct}from"./Upload-B1t_Goh5.js";import"./DownloadLink.svelte_svelte_type_style_lang-C_5UIfol.js";import{I as St}from"./Image-CnqB5dbD.js";const{SvelteComponent:Dt,append:Ve,attr:A,detach:qt,init:Et,insert:Wt,noop:Te,safe_not_equal:Bt,svg_element:je}=window.__gradio__svelte__internal;function Mt(l){let e,t,n;return{c(){e=je("svg"),t=je("path"),n=je("circle"),A(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),A(n,"cx","12"),A(n,"cy","13"),A(n,"r","4"),A(e,"xmlns","http://www.w3.org/2000/svg"),A(e,"width","100%"),A(e,"height","100%"),A(e,"viewBox","0 0 24 24"),A(e,"fill","none"),A(e,"stroke","currentColor"),A(e,"stroke-width","1.5"),A(e,"stroke-linecap","round"),A(e,"stroke-linejoin","round"),A(e,"class","feather feather-camera")},m(i,s){Wt(i,e,s),Ve(e,t),Ve(e,n)},p:Te,i:Te,o:Te,d(i){i&&qt(e)}}}class Rt extends Dt{constructor(e){super(),Et(this,e,null,Mt,Bt,{})}}const{SvelteComponent:$t,append:Tt,attr:P,detach:jt,init:Nt,insert:Ut,noop:Ne,safe_not_equal:Lt,svg_element:Ge}=window.__gradio__svelte__internal;function Ft(l){let e,t;return{c(){e=Ge("svg"),t=Ge("circle"),P(t,"cx","12"),P(t,"cy","12"),P(t,"r","10"),P(e,"xmlns","http://www.w3.org/2000/svg"),P(e,"width","100%"),P(e,"height","100%"),P(e,"viewBox","0 0 24 24"),P(e,"stroke-width","1.5"),P(e,"stroke-linecap","round"),P(e,"stroke-linejoin","round"),P(e,"class","feather feather-circle")},m(n,i){Ut(n,e,i),Tt(e,t)},p:Ne,i:Ne,o:Ne,d(n){n&&jt(e)}}}class At extends $t{constructor(e){super(),Nt(this,e,null,Ft,Lt,{})}}const{SvelteComponent:Ht,append:ke,attr:Ue,create_component:Ot,destroy_component:Pt,detach:Vt,element:Le,init:Gt,insert:Jt,listen:Kt,mount_component:Qt,noop:Xt,safe_not_equal:Yt,set_style:Zt,space:xt,text:en,transition_in:tn,transition_out:nn}=window.__gradio__svelte__internal,{createEventDispatcher:ln}=window.__gradio__svelte__internal;function rn(l){let e,t,n,i,s,r="Click to Access Webcam",c,o,u,f;return i=new ht({}),{c(){e=Le("button"),t=Le("div"),n=Le("span"),Ot(i.$$.fragment),s=xt(),c=en(r),Ue(n,"class","icon-wrap svelte-qbrfs"),Ue(t,"class","wrap svelte-qbrfs"),Ue(e,"class","svelte-qbrfs"),Zt(e,"height","100%")},m(_,w){Jt(_,e,w),ke(e,t),ke(t,n),Qt(i,n,null),ke(t,s),ke(t,c),o=!0,u||(f=Kt(e,"click",l[1]),u=!0)},p:Xt,i(_){o||(tn(i.$$.fragment,_),o=!0)},o(_){nn(i.$$.fragment,_),o=!1},d(_){_&&Vt(e),Pt(i),u=!1,f()}}}function sn(l){const e=ln();return[e,()=>e("click")]}class on extends Ht{constructor(e){super(),Gt(this,e,sn,rn,Yt,{})}}function an(){return navigator.mediaDevices.enumerateDevices()}function cn(l,e){e.srcObject=l,e.muted=!0,e.play()}async function Je(l,e,t,n){const i={video:n?{deviceId:{exact:n},...t?.video}:t?.video||{width:{ideal:1920},height:{ideal:1440}},audio:l&&(t?.audio??!0)};return navigator.mediaDevices.getUserMedia(i).then(s=>(cn(s,e),s))}function un(l){return l.filter(t=>t.kind==="videoinput")}const{SvelteComponent:_n,action_destroyer:fn,add_render_callback:mn,append:S,attr:y,binding_callbacks:dn,check_outros:me,create_component:x,create_in_transition:gn,destroy_component:ee,destroy_each:hn,detach:j,element:M,empty:He,ensure_array_like:Ke,flush:V,group_outros:de,init:pn,insert:N,listen:Ce,mount_component:te,noop:Oe,run_all:bn,safe_not_equal:wn,set_data:we,set_input_value:Fe,set_style:st,space:K,src_url_equal:Qe,stop_propagation:vn,text:ve,toggle_class:re,transition_in:D,transition_out:B}=window.__gradio__svelte__internal,{createEventDispatcher:kn,onDestroy:yn,onMount:In}=window.__gradio__svelte__internal;function Xe(l,e,t){const n=l.slice();return n[39]=e[t],n}function zn(l){let e,t,n,i,s,r,c,o,u,f,_;const w=[Dn,Sn],I=[];function $(b,k){return b[2]==="video"||b[1]?0:1}n=$(l),i=I[n]=w[n](l);let g=!l[11]&&Ye(l),p=l[13]&&l[8]&&Ze(l);return{c(){e=M("div"),t=M("button"),i.c(),r=K(),g&&g.c(),c=K(),p&&p.c(),o=He(),y(t,"aria-label",s=l[2]==="image"?"capture photo":"start recording"),y(t,"class","svelte-10cpz3p"),y(e,"class","button-wrap svelte-10cpz3p")},m(b,k){N(b,e,k),S(e,t),I[n].m(t,null),S(e,r),g&&g.m(e,null),N(b,c,k),p&&p.m(b,k),N(b,o,k),u=!0,f||(_=Ce(t,"click",l[28]),f=!0)},p(b,k){let U=n;n=$(b),n===U?I[n].p(b,k):(de(),B(I[U],1,1,()=>{I[U]=null}),me(),i=I[n],i?i.p(b,k):(i=I[n]=w[n](b),i.c()),D(i,1),i.m(t,null)),(!u||k[0]&4&&s!==(s=b[2]==="image"?"capture photo":"start recording"))&&y(t,"aria-label",s),b[11]?g&&(de(),B(g,1,1,()=>{g=null}),me()):g?(g.p(b,k),k[0]&2048&&D(g,1)):(g=Ye(b),g.c(),D(g,1),g.m(e,null)),b[13]&&b[8]?p?(p.p(b,k),k[0]&8448&&D(p,1)):(p=Ze(b),p.c(),D(p,1),p.m(o.parentNode,o)):p&&(de(),B(p,1,1,()=>{p=null}),me())},i(b){u||(D(i),D(g),D(p),u=!0)},o(b){B(i),B(g),B(p),u=!1},d(b){b&&(j(e),j(c),j(o)),I[n].d(),g&&g.d(),p&&p.d(b),f=!1,_()}}}function Cn(l){let e,t,n,i;return t=new on({}),t.$on("click",l[27]),{c(){e=M("div"),x(t.$$.fragment),y(e,"title","grant webcam access"),st(e,"height","100%")},m(s,r){N(s,e,r),te(t,e,null),i=!0},p:Oe,i(s){i||(D(t.$$.fragment,s),s&&(n||mn(()=>{n=gn(e,yt,{delay:100,duration:200}),n.start()})),i=!0)},o(s){B(t.$$.fragment,s),i=!1},d(s){s&&j(e),ee(t)}}}function Sn(l){let e,t,n;return t=new Rt({}),{c(){e=M("div"),x(t.$$.fragment),y(e,"class","icon svelte-10cpz3p"),y(e,"title","capture photo")},m(i,s){N(i,e,s),te(t,e,null),n=!0},p:Oe,i(i){n||(D(t.$$.fragment,i),n=!0)},o(i){B(t.$$.fragment,i),n=!1},d(i){i&&j(e),ee(t)}}}function Dn(l){let e,t,n,i;const s=[Wn,En,qn],r=[];function c(o,u){return o[1]&&o[10]==="waiting"?0:o[1]&&o[10]==="open"||!o[1]&&o[11]?1:2}return e=c(l),t=r[e]=s[e](l),{c(){t.c(),n=He()},m(o,u){r[e].m(o,u),N(o,n,u),i=!0},p(o,u){let f=e;e=c(o),e===f?r[e].p(o,u):(de(),B(r[f],1,1,()=>{r[f]=null}),me(),t=r[e],t?t.p(o,u):(t=r[e]=s[e](o),t.c()),D(t,1),t.m(n.parentNode,n))},i(o){i||(D(t),i=!0)},o(o){B(t),i=!1},d(o){o&&j(n),r[e].d(o)}}}function qn(l){let e,t,n,i,s=l[4]("audio.record")+"",r,c;return n=new At({}),{c(){e=M("div"),t=M("div"),x(n.$$.fragment),i=K(),r=ve(s),y(t,"class","icon color-primary svelte-10cpz3p"),y(t,"title","start recording"),y(e,"class","icon-with-text svelte-10cpz3p")},m(o,u){N(o,e,u),S(e,t),te(n,t,null),S(e,i),S(e,r),c=!0},p(o,u){(!c||u[0]&16)&&s!==(s=o[4]("audio.record")+"")&&we(r,s)},i(o){c||(D(n.$$.fragment,o),c=!0)},o(o){B(n.$$.fragment,o),c=!1},d(o){o&&j(e),ee(n)}}}function En(l){let e,t,n,i,s=l[4]("audio.stop")+"",r,c;return n=new kt({}),{c(){e=M("div"),t=M("div"),x(n.$$.fragment),i=K(),r=ve(s),y(t,"class","icon color-primary svelte-10cpz3p"),y(t,"title","stop recording"),y(e,"class","icon-with-text svelte-10cpz3p")},m(o,u){N(o,e,u),S(e,t),te(n,t,null),S(e,i),S(e,r),c=!0},p(o,u){(!c||u[0]&16)&&s!==(s=o[4]("audio.stop")+"")&&we(r,s)},i(o){c||(D(n.$$.fragment,o),c=!0)},o(o){B(n.$$.fragment,o),c=!1},d(o){o&&j(e),ee(n)}}}function Wn(l){let e,t,n,i,s=l[4]("audio.waiting")+"",r,c;return n=new pt({}),{c(){e=M("div"),t=M("div"),x(n.$$.fragment),i=K(),r=ve(s),y(t,"class","icon color-primary svelte-10cpz3p"),y(t,"title","spinner"),y(e,"class","icon-with-text svelte-10cpz3p"),st(e,"width","var(--size-24)")},m(o,u){N(o,e,u),S(e,t),te(n,t,null),S(e,i),S(e,r),c=!0},p(o,u){(!c||u[0]&16)&&s!==(s=o[4]("audio.waiting")+"")&&we(r,s)},i(o){c||(D(n.$$.fragment,o),c=!0)},o(o){B(n.$$.fragment,o),c=!1},d(o){o&&j(e),ee(n)}}}function Ye(l){let e,t,n,i,s;return t=new rt({}),{c(){e=M("button"),x(t.$$.fragment),y(e,"class","icon svelte-10cpz3p"),y(e,"aria-label","select input source")},m(r,c){N(r,e,c),te(t,e,null),n=!0,i||(s=Ce(e,"click",l[29]),i=!0)},p:Oe,i(r){n||(D(t.$$.fragment,r),n=!0)},o(r){B(t.$$.fragment,r),n=!1},d(r){r&&j(e),ee(t),i=!1,s()}}}function Ze(l){let e,t,n,i,s,r,c;n=new rt({});function o(_,w){return _[7].length===0?Mn:Bn}let u=o(l),f=u(l);return{c(){e=M("select"),t=M("button"),x(n.$$.fragment),i=K(),f.c(),y(t,"class","inset-icon svelte-10cpz3p"),y(e,"class","select-wrap svelte-10cpz3p"),y(e,"aria-label","select source")},m(_,w){N(_,e,w),S(e,t),te(n,t,null),S(t,i),f.m(e,null),s=!0,r||(c=[Ce(t,"click",vn(l[30])),fn(Pe.call(null,e,l[17])),Ce(e,"change",l[14])],r=!0)},p(_,w){u===(u=o(_))&&f?f.p(_,w):(f.d(1),f=u(_),f&&(f.c(),f.m(e,null)))},i(_){s||(D(n.$$.fragment,_),s=!0)},o(_){B(n.$$.fragment,_),s=!1},d(_){_&&j(e),ee(n),f.d(),r=!1,bn(c)}}}function Bn(l){let e,t=Ke(l[7]),n=[];for(let i=0;i<t.length;i+=1)n[i]=xe(Xe(l,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=He()},m(i,s){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(i,s);N(i,e,s)},p(i,s){if(s[0]&384){t=Ke(i[7]);let r;for(r=0;r<t.length;r+=1){const c=Xe(i,t,r);n[r]?n[r].p(c,s):(n[r]=xe(c),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&j(e),hn(n,i)}}}function Mn(l){let e,t=l[4]("common.no_devices")+"",n;return{c(){e=M("option"),n=ve(t),e.__value="",Fe(e,e.__value),y(e,"class","svelte-10cpz3p")},m(i,s){N(i,e,s),S(e,n)},p(i,s){s[0]&16&&t!==(t=i[4]("common.no_devices")+"")&&we(n,t)},d(i){i&&j(e)}}}function xe(l){let e,t=l[39].label+"",n,i,s,r;return{c(){e=M("option"),n=ve(t),i=K(),e.__value=s=l[39].deviceId,Fe(e,e.__value),e.selected=r=l[8].deviceId===l[39].deviceId,y(e,"class","svelte-10cpz3p")},m(c,o){N(c,e,o),S(e,n),S(e,i)},p(c,o){o[0]&128&&t!==(t=c[39].label+"")&&we(n,t),o[0]&128&&s!==(s=c[39].deviceId)&&(e.__value=s,Fe(e,e.__value)),o[0]&384&&r!==(r=c[8].deviceId===c[39].deviceId)&&(e.selected=r)},d(c){c&&j(e)}}}function Rn(l){let e,t,n,i,s,r,c,o,u,f,_;t=new It({props:{time_limit:l[9]}});const w=[Cn,zn],I=[];function $(g,p){return g[12]?1:0}return u=$(l),f=I[u]=w[u](l),{c(){e=M("div"),x(t.$$.fragment),n=K(),i=M("video"),s=K(),r=M("img"),o=K(),f.c(),y(i,"class","svelte-10cpz3p"),re(i,"flip",l[3]),re(i,"hide",!l[12]||l[12]&&!!l[0]),Qe(r.src,c=l[0]?.url)||y(r,"src",c),y(r,"class","svelte-10cpz3p"),re(r,"hide",!l[12]||l[12]&&!l[0]),y(e,"class","wrap svelte-10cpz3p")},m(g,p){N(g,e,p),te(t,e,null),S(e,n),S(e,i),l[26](i),S(e,s),S(e,r),S(e,o),I[u].m(e,null),_=!0},p(g,p){const b={};p[0]&512&&(b.time_limit=g[9]),t.$set(b),(!_||p[0]&8)&&re(i,"flip",g[3]),(!_||p[0]&4097)&&re(i,"hide",!g[12]||g[12]&&!!g[0]),(!_||p[0]&1&&!Qe(r.src,c=g[0]?.url))&&y(r,"src",c),(!_||p[0]&4097)&&re(r,"hide",!g[12]||g[12]&&!g[0]);let k=u;u=$(g),u===k?I[u].p(g,p):(de(),B(I[k],1,1,()=>{I[k]=null}),me(),f=I[u],f?f.p(g,p):(f=I[u]=w[u](g),f.c()),D(f,1),f.m(e,null))},i(g){_||(D(t.$$.fragment,g),D(f),_=!0)},o(g){B(t.$$.fragment,g),B(f),_=!1},d(g){g&&j(e),ee(t),l[26](null),I[u].d()}}}function Pe(l,e){const t=n=>{l&&!l.contains(n.target)&&!n.defaultPrevented&&e(n)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function $n(l,e,t){let n,i=[],s=null,r=null,c="closed";const o=d=>{d==="closed"?(t(9,r=null),t(10,c="closed"),t(0,H=null)):d==="waiting"?t(10,c="waiting"):t(10,c="open")},u=d=>{T&&t(9,r=d)};let f,{streaming:_=!1}=e,{pending:w=!1}=e,{root:I=""}=e,{stream_every:$=1}=e,{mode:g="image"}=e,{mirror_webcam:p}=e,{include_audio:b}=e,{webcam_constraints:k=null}=e,{i18n:U}=e,{upload:R}=e,{value:H=null}=e;const v=kn();In(()=>{f=document.createElement("canvas"),_&&g==="image"&&window.setInterval(()=>{n&&!w&&L()},$*1e3)});const m=async d=>{const J=d.target.value;await Je(b,n,k,J).then(async ue=>{O=ue,t(8,s=i.find(_e=>_e.deviceId===J)||null),t(13,Q=!1)})};async function h(){try{Je(b,n,k).then(async d=>{t(12,ae=!0),t(7,i=await an()),O=d}).then(()=>un(i)).then(d=>{t(7,i=d);const q=O.getTracks().map(J=>J.getSettings()?.deviceId)[0];t(8,s=q&&d.find(J=>J.deviceId===q)||i[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&v("error",U("image.no_webcam_support"))}catch(d){if(d instanceof DOMException&&d.name=="NotAllowedError")v("error",U("image.allow_webcam_access"));else throw d}}function L(){var d=f.getContext("2d");if((!_||_&&T)&&n.videoWidth&&n.videoHeight){if(f.width=n.videoWidth,f.height=n.videoHeight,d.drawImage(n,0,0,n.videoWidth,n.videoHeight),p&&(d.scale(-1,1),d.drawImage(n,-n.videoWidth,0)),_&&(!T||c==="waiting"))return;if(_){const q=f.toDataURL("image/jpeg");v("stream",q);return}f.toBlob(q=>{v(_?"stream":"capture",q)},`image/${_?"jpeg":"png"}`,.8)}}let T=!1,W=[],O,G,F;function ne(){if(T){F.stop();let d=new Blob(W,{type:G}),q=new FileReader;q.onload=async function(J){if(J.target){let ue=new File([d],"sample."+G.substring(6));const _e=await zt([ue]);let Re=(await R(_e,I))?.filter(Boolean)[0];v("capture",Re),v("stop_recording")}},q.readAsDataURL(d)}else if(typeof MediaRecorder<"u"){v("start_recording"),W=[];let d=["video/webm","video/mp4"];for(let q of d)if(MediaRecorder.isTypeSupported(q)){G=q;break}if(G===null){console.error("No supported MediaRecorder mimeType");return}F=new MediaRecorder(O,{mimeType:G}),F.addEventListener("dataavailable",function(q){W.push(q.data)}),F.start(200)}t(11,T=!T)}let ae=!1;function ce({destroy:d}={}){g==="image"&&_&&t(11,T=!T),d||(g==="image"?L():ne()),!T&&O&&(v("close_stream"),O.getTracks().forEach(q=>q.stop()),t(6,n.srcObject=null,n),t(12,ae=!1),window.setTimeout(()=>{t(0,H=null)},500),t(0,H=null))}let Q=!1;function De(d){d.preventDefault(),d.stopPropagation(),t(13,Q=!1)}yn(()=>{typeof window>"u"||(ce({destroy:!0}),O?.getTracks().forEach(d=>d.stop()))});function qe(d){dn[d?"unshift":"push"](()=>{n=d,t(6,n)})}const Ee=async()=>h(),We=()=>ce(),Be=()=>t(13,Q=!0),Me=()=>t(13,Q=!1);return l.$$set=d=>{"streaming"in d&&t(1,_=d.streaming),"pending"in d&&t(20,w=d.pending),"root"in d&&t(21,I=d.root),"stream_every"in d&&t(22,$=d.stream_every),"mode"in d&&t(2,g=d.mode),"mirror_webcam"in d&&t(3,p=d.mirror_webcam),"include_audio"in d&&t(23,b=d.include_audio),"webcam_constraints"in d&&t(24,k=d.webcam_constraints),"i18n"in d&&t(4,U=d.i18n),"upload"in d&&t(25,R=d.upload),"value"in d&&t(0,H=d.value)},[H,_,g,p,U,Pe,n,i,s,r,c,T,ae,Q,m,h,ce,De,o,u,w,I,$,b,k,R,qe,Ee,We,Be,Me]}class Tn extends _n{constructor(e){super(),pn(this,e,$n,Rn,wn,{modify_stream:18,set_time_limit:19,streaming:1,pending:20,root:21,stream_every:22,mode:2,mirror_webcam:3,include_audio:23,webcam_constraints:24,i18n:4,upload:25,value:0,click_outside:5},null,[-1,-1])}get modify_stream(){return this.$$.ctx[18]}get set_time_limit(){return this.$$.ctx[19]}get streaming(){return this.$$.ctx[1]}set streaming(e){this.$$set({streaming:e}),V()}get pending(){return this.$$.ctx[20]}set pending(e){this.$$set({pending:e}),V()}get root(){return this.$$.ctx[21]}set root(e){this.$$set({root:e}),V()}get stream_every(){return this.$$.ctx[22]}set stream_every(e){this.$$set({stream_every:e}),V()}get mode(){return this.$$.ctx[2]}set mode(e){this.$$set({mode:e}),V()}get mirror_webcam(){return this.$$.ctx[3]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),V()}get include_audio(){return this.$$.ctx[23]}set include_audio(e){this.$$set({include_audio:e}),V()}get webcam_constraints(){return this.$$.ctx[24]}set webcam_constraints(e){this.$$set({webcam_constraints:e}),V()}get i18n(){return this.$$.ctx[4]}set i18n(e){this.$$set({i18n:e}),V()}get upload(){return this.$$.ctx[25]}set upload(e){this.$$set({upload:e}),V()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),V()}get click_outside(){return Pe}}const jn=Tn,{SvelteComponent:Nn,add_flush_callback:ge,append:ye,attr:ze,bind:he,binding_callbacks:le,bubble:Ie,check_outros:pe,create_component:X,create_slot:Un,destroy_component:Y,detach:se,element:Ae,empty:ot,flush:C,get_all_dirty_from_scope:Ln,get_slot_changes:Fn,group_outros:be,init:An,insert:oe,listen:Hn,mount_component:Z,safe_not_equal:On,set_style:et,space:fe,toggle_class:Se,transition_in:z,transition_out:E,update_slot_base:Pn}=window.__gradio__svelte__internal,{createEventDispatcher:Vn,tick:Gn}=window.__gradio__svelte__internal;function tt(l){let e,t,n,i=l[18]&&nt(l);return t=new ft({props:{Icon:mt,label:"Remove Image"}}),t.$on("click",l[31]),{c(){i&&i.c(),e=fe(),X(t.$$.fragment)},m(s,r){i&&i.m(s,r),oe(s,e,r),Z(t,s,r),n=!0},p(s,r){s[18]?i?(i.p(s,r),r[0]&262144&&z(i,1)):(i=nt(s),i.c(),z(i,1),i.m(e.parentNode,e)):i&&(be(),E(i,1,1,()=>{i=null}),pe())},i(s){n||(z(i),z(t.$$.fragment,s),n=!0)},o(s){E(i),E(t.$$.fragment,s),n=!1},d(s){s&&se(e),i&&i.d(s),Y(t,s)}}}function nt(l){let e,t;return e=new gt({props:{container:l[22]}}),{c(){X(e.$$.fragment)},m(n,i){Z(e,n,i),t=!0},p(n,i){const s={};i[0]&4194304&&(s.container=n[22]),e.$set(s)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){E(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function Jn(l){let e,t,n=l[3]?.url&&!l[20]&&tt(l);return{c(){n&&n.c(),e=ot()},m(i,s){n&&n.m(i,s),oe(i,e,s),t=!0},p(i,s){i[3]?.url&&!i[20]?n?(n.p(i,s),s[0]&1048584&&z(n,1)):(n=tt(i),n.c(),z(n,1),n.m(e.parentNode,e)):n&&(be(),E(n,1,1,()=>{n=null}),pe())},i(i){t||(z(n),t=!0)},o(i){E(n),t=!1},d(i){i&&se(e),n&&n.d(i)}}}function it(l){let e;const t=l[30].default,n=Un(t,l,l[46],null);return{c(){n&&n.c()},m(i,s){n&&n.m(i,s),e=!0},p(i,s){n&&n.p&&(!e||s[1]&32768)&&Pn(n,t,i,i[46],e?Fn(t,i[46],s,null):Ln(i[46]),null)},i(i){e||(z(n,i),e=!0)},o(i){E(n,i),e=!1},d(i){n&&n.d(i)}}}function Kn(l){let e,t,n=l[3]===null&&it(l);return{c(){n&&n.c(),e=ot()},m(i,s){n&&n.m(i,s),oe(i,e,s),t=!0},p(i,s){i[3]===null?n?(n.p(i,s),s[0]&8&&z(n,1)):(n=it(i),n.c(),z(n,1),n.m(e.parentNode,e)):n&&(be(),E(n,1,1,()=>{n=null}),pe())},i(i){t||(z(n),t=!0)},o(i){E(n),t=!1},d(i){i&&se(e),n&&n.d(i)}}}function Qn(l){let e,t,n,i,s;return t=new St({props:{src:l[3].url,alt:l[3].alt_text}}),{c(){e=Ae("div"),X(t.$$.fragment),ze(e,"class","image-frame svelte-11chud3"),Se(e,"selectable",l[11])},m(r,c){oe(r,e,c),Z(t,e,null),n=!0,i||(s=Hn(e,"click",l[27]),i=!0)},p(r,c){const o={};c[0]&8&&(o.src=r[3].url),c[0]&8&&(o.alt=r[3].alt_text),t.$set(o),(!n||c[0]&2048)&&Se(e,"selectable",r[11])},i(r){n||(z(t.$$.fragment,r),n=!0)},o(r){E(t.$$.fragment,r),n=!1},d(r){r&&se(e),Y(t),i=!1,s()}}}function Xn(l){let e,t,n,i;function s(o){l[36](o)}function r(o){l[37](o)}let c={root:l[12],value:l[3],mirror_webcam:l[10],stream_every:l[17],streaming:l[9],mode:"image",include_audio:!1,i18n:l[13],upload:l[15],webcam_constraints:l[19]};return l[4]!==void 0&&(c.modify_stream=l[4]),l[5]!==void 0&&(c.set_time_limit=l[5]),e=new jn({props:c}),le.push(()=>he(e,"modify_stream",s)),le.push(()=>he(e,"set_time_limit",r)),e.$on("capture",l[38]),e.$on("stream",l[39]),e.$on("error",l[40]),e.$on("drag",l[41]),e.$on("upload",l[42]),e.$on("close_stream",l[43]),{c(){X(e.$$.fragment)},m(o,u){Z(e,o,u),i=!0},p(o,u){const f={};u[0]&4096&&(f.root=o[12]),u[0]&8&&(f.value=o[3]),u[0]&1024&&(f.mirror_webcam=o[10]),u[0]&131072&&(f.stream_every=o[17]),u[0]&512&&(f.streaming=o[9]),u[0]&8192&&(f.i18n=o[13]),u[0]&32768&&(f.upload=o[15]),u[0]&524288&&(f.webcam_constraints=o[19]),!t&&u[0]&16&&(t=!0,f.modify_stream=o[4],ge(()=>t=!1)),!n&&u[0]&32&&(n=!0,f.set_time_limit=o[5],ge(()=>n=!1)),e.$set(f)},i(o){i||(z(e.$$.fragment,o),i=!0)},o(o){E(e.$$.fragment,o),i=!1},d(o){Y(e,o)}}}function lt(l){let e,t,n;function i(r){l[44](r)}let s={sources:l[8],handle_clear:l[24],handle_select:l[28]};return l[1]!==void 0&&(s.active_source=l[1]),e=new bt({props:s}),le.push(()=>he(e,"active_source",i)),{c(){X(e.$$.fragment)},m(r,c){Z(e,r,c),n=!0},p(r,c){const o={};c[0]&256&&(o.sources=r[8]),!t&&c[0]&2&&(t=!0,o.active_source=r[1],ge(()=>t=!1)),e.$set(o)},i(r){n||(z(e.$$.fragment,r),n=!0)},o(r){E(e.$$.fragment,r),n=!1},d(r){Y(e,r)}}}function Yn(l){let e,t,n,i,s,r,c,o,u,f,_,w,I,$=l[8].length>1||l[8].includes("clipboard"),g;e=new _t({props:{show_label:l[7],Icon:dt,label:l[6]||"Image"}}),i=new wt({props:{$$slots:{default:[Jn]},$$scope:{ctx:l}}});function p(m){l[33](m)}function b(m){l[34](m)}let k={hidden:l[3]!==null||l[1]==="webcam",filetype:l[1]==="clipboard"?"clipboard":"image/*",root:l[12],max_file_size:l[14],disable_click:!l[8].includes("upload")||l[3]!==null,upload:l[15],stream_handler:l[16],aria_label:l[13]("image.drop_to_upload"),$$slots:{default:[Kn]},$$scope:{ctx:l}};l[0]!==void 0&&(k.uploading=l[0]),l[2]!==void 0&&(k.dragging=l[2]),c=new Ct({props:k}),l[32](c),le.push(()=>he(c,"uploading",p)),le.push(()=>he(c,"dragging",b)),c.$on("load",l[23]),c.$on("error",l[35]);const U=[Xn,Qn],R=[];function H(m,h){return m[1]==="webcam"&&(m[9]||!m[9]&&!m[3])?0:m[3]!==null&&!m[9]?1:-1}~(_=H(l))&&(w=R[_]=U[_](l));let v=$&&lt(l);return{c(){X(e.$$.fragment),t=fe(),n=Ae("div"),X(i.$$.fragment),s=fe(),r=Ae("div"),X(c.$$.fragment),f=fe(),w&&w.c(),I=fe(),v&&v.c(),ze(r,"class","upload-container svelte-11chud3"),Se(r,"reduced-height",l[8].length>1),et(r,"width",l[3]?"auto":"100%"),ze(n,"data-testid","image"),ze(n,"class","image-container svelte-11chud3")},m(m,h){Z(e,m,h),oe(m,t,h),oe(m,n,h),Z(i,n,null),ye(n,s),ye(n,r),Z(c,r,null),ye(r,f),~_&&R[_].m(r,null),ye(n,I),v&&v.m(n,null),l[45](n),g=!0},p(m,h){const L={};h[0]&128&&(L.show_label=m[7]),h[0]&64&&(L.label=m[6]||"Image"),e.$set(L);const T={};h[0]&5505032|h[1]&32768&&(T.$$scope={dirty:h,ctx:m}),i.$set(T);const W={};h[0]&10&&(W.hidden=m[3]!==null||m[1]==="webcam"),h[0]&2&&(W.filetype=m[1]==="clipboard"?"clipboard":"image/*"),h[0]&4096&&(W.root=m[12]),h[0]&16384&&(W.max_file_size=m[14]),h[0]&264&&(W.disable_click=!m[8].includes("upload")||m[3]!==null),h[0]&32768&&(W.upload=m[15]),h[0]&65536&&(W.stream_handler=m[16]),h[0]&8192&&(W.aria_label=m[13]("image.drop_to_upload")),h[0]&8|h[1]&32768&&(W.$$scope={dirty:h,ctx:m}),!o&&h[0]&1&&(o=!0,W.uploading=m[0],ge(()=>o=!1)),!u&&h[0]&4&&(u=!0,W.dragging=m[2],ge(()=>u=!1)),c.$set(W);let O=_;_=H(m),_===O?~_&&R[_].p(m,h):(w&&(be(),E(R[O],1,1,()=>{R[O]=null}),pe()),~_?(w=R[_],w?w.p(m,h):(w=R[_]=U[_](m),w.c()),z(w,1),w.m(r,null)):w=null),(!g||h[0]&256)&&Se(r,"reduced-height",m[8].length>1),h[0]&8&&et(r,"width",m[3]?"auto":"100%"),h[0]&256&&($=m[8].length>1||m[8].includes("clipboard")),$?v?(v.p(m,h),h[0]&256&&z(v,1)):(v=lt(m),v.c(),z(v,1),v.m(n,null)):v&&(be(),E(v,1,1,()=>{v=null}),pe())},i(m){g||(z(e.$$.fragment,m),z(i.$$.fragment,m),z(c.$$.fragment,m),z(w),z(v),g=!0)},o(m){E(e.$$.fragment,m),E(i.$$.fragment,m),E(c.$$.fragment,m),E(w),E(v),g=!1},d(m){m&&(se(t),se(n)),Y(e,m),Y(i),l[32](null),Y(c),~_&&R[_].d(),v&&v.d(),l[45](null)}}}function Zn(l,e,t){let n,{$$slots:i={},$$scope:s}=e,{value:r=null}=e,{label:c=void 0}=e,{show_label:o}=e,{sources:u=["upload","clipboard","webcam"]}=e,{streaming:f=!1}=e,{pending:_=!1}=e,{mirror_webcam:w}=e,{selectable:I=!1}=e,{root:$}=e,{i18n:g}=e,{max_file_size:p=null}=e,{upload:b}=e,{stream_handler:k}=e,{stream_every:U}=e,{modify_stream:R}=e,{set_time_limit:H}=e,{show_fullscreen_button:v=!0}=e,m,{uploading:h=!1}=e,{active_source:L=null}=e,{webcam_constraints:T=void 0}=e;async function W({detail:a}){if(!f){if(a.path?.toLowerCase().endsWith(".svg")&&a.url){const $e=await(await fetch(a.url)).text();t(3,r={...a,url:`data:image/svg+xml,${encodeURIComponent($e)}`})}else t(3,r=a);F("upload")}}function O(){t(3,r=null),F("clear"),F("change",null)}async function G(a,ie){if(ie==="stream"){F("stream",{value:{url:a},is_value_data:!0});return}t(29,_=!0);const $e=await m.load_files([new File([a],`image/${f?"jpeg":"png"}`)]);(ie==="change"||ie==="upload")&&(t(3,r=$e?.[0]||null),await Gn(),F("change")),t(29,_=!1)}const F=Vn();let{dragging:ne=!1}=e;function ae(a){let ie=vt(a);ie&&F("select",{index:ie,value:null})}async function ce(a){switch(a){case"clipboard":m.paste_clipboard();break}}let Q;const De=a=>{t(3,r=null),F("clear"),a.stopPropagation()};function qe(a){le[a?"unshift":"push"](()=>{m=a,t(21,m)})}function Ee(a){h=a,t(0,h)}function We(a){ne=a,t(2,ne)}function Be(a){Ie.call(this,l,a)}function Me(a){R=a,t(4,R)}function d(a){H=a,t(5,H)}const q=a=>G(a.detail,"change"),J=a=>G(a.detail,"stream");function ue(a){Ie.call(this,l,a)}function _e(a){Ie.call(this,l,a)}const Re=a=>G(a.detail,"upload");function at(a){Ie.call(this,l,a)}function ct(a){L=a,t(1,L),t(8,u)}function ut(a){le[a?"unshift":"push"](()=>{Q=a,t(22,Q)})}return l.$$set=a=>{"value"in a&&t(3,r=a.value),"label"in a&&t(6,c=a.label),"show_label"in a&&t(7,o=a.show_label),"sources"in a&&t(8,u=a.sources),"streaming"in a&&t(9,f=a.streaming),"pending"in a&&t(29,_=a.pending),"mirror_webcam"in a&&t(10,w=a.mirror_webcam),"selectable"in a&&t(11,I=a.selectable),"root"in a&&t(12,$=a.root),"i18n"in a&&t(13,g=a.i18n),"max_file_size"in a&&t(14,p=a.max_file_size),"upload"in a&&t(15,b=a.upload),"stream_handler"in a&&t(16,k=a.stream_handler),"stream_every"in a&&t(17,U=a.stream_every),"modify_stream"in a&&t(4,R=a.modify_stream),"set_time_limit"in a&&t(5,H=a.set_time_limit),"show_fullscreen_button"in a&&t(18,v=a.show_fullscreen_button),"uploading"in a&&t(0,h=a.uploading),"active_source"in a&&t(1,L=a.active_source),"webcam_constraints"in a&&t(19,T=a.webcam_constraints),"dragging"in a&&t(2,ne=a.dragging),"$$scope"in a&&t(46,s=a.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&258&&!L&&u&&t(1,L=u[0]),l.$$.dirty[0]&514&&t(20,n=f&&L==="webcam"),l.$$.dirty[0]&1048577&&h&&!n&&t(3,r=null),l.$$.dirty[0]&4&&F("drag",ne)},[h,L,ne,r,R,H,c,o,u,f,w,I,$,g,p,b,k,U,v,T,n,m,Q,W,O,G,F,ae,ce,_,i,De,qe,Ee,We,Be,Me,d,q,J,ue,_e,Re,at,ct,ut,s]}class xn extends Nn{constructor(e){super(),An(this,e,Zn,Yn,On,{value:3,label:6,show_label:7,sources:8,streaming:9,pending:29,mirror_webcam:10,selectable:11,root:12,i18n:13,max_file_size:14,upload:15,stream_handler:16,stream_every:17,modify_stream:4,set_time_limit:5,show_fullscreen_button:18,uploading:0,active_source:1,webcam_constraints:19,dragging:2},null,[-1,-1])}get value(){return this.$$.ctx[3]}set value(e){this.$$set({value:e}),C()}get label(){return this.$$.ctx[6]}set label(e){this.$$set({label:e}),C()}get show_label(){return this.$$.ctx[7]}set show_label(e){this.$$set({show_label:e}),C()}get sources(){return this.$$.ctx[8]}set sources(e){this.$$set({sources:e}),C()}get streaming(){return this.$$.ctx[9]}set streaming(e){this.$$set({streaming:e}),C()}get pending(){return this.$$.ctx[29]}set pending(e){this.$$set({pending:e}),C()}get mirror_webcam(){return this.$$.ctx[10]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),C()}get selectable(){return this.$$.ctx[11]}set selectable(e){this.$$set({selectable:e}),C()}get root(){return this.$$.ctx[12]}set root(e){this.$$set({root:e}),C()}get i18n(){return this.$$.ctx[13]}set i18n(e){this.$$set({i18n:e}),C()}get max_file_size(){return this.$$.ctx[14]}set max_file_size(e){this.$$set({max_file_size:e}),C()}get upload(){return this.$$.ctx[15]}set upload(e){this.$$set({upload:e}),C()}get stream_handler(){return this.$$.ctx[16]}set stream_handler(e){this.$$set({stream_handler:e}),C()}get stream_every(){return this.$$.ctx[17]}set stream_every(e){this.$$set({stream_every:e}),C()}get modify_stream(){return this.$$.ctx[4]}set modify_stream(e){this.$$set({modify_stream:e}),C()}get set_time_limit(){return this.$$.ctx[5]}set set_time_limit(e){this.$$set({set_time_limit:e}),C()}get show_fullscreen_button(){return this.$$.ctx[18]}set show_fullscreen_button(e){this.$$set({show_fullscreen_button:e}),C()}get uploading(){return this.$$.ctx[0]}set uploading(e){this.$$set({uploading:e}),C()}get active_source(){return this.$$.ctx[1]}set active_source(e){this.$$set({active_source:e}),C()}get webcam_constraints(){return this.$$.ctx[19]}set webcam_constraints(e){this.$$set({webcam_constraints:e}),C()}get dragging(){return this.$$.ctx[2]}set dragging(e){this.$$set({dragging:e}),C()}}const bi=xn;export{At as C,bi as I,jn as W};
//# sourceMappingURL=ImageUploader-C4MAwbN_.js.map
