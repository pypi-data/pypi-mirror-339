"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[2314],{46916:(e,t,n)=>{n.d(t,{E:()=>l});var a=n(71791),s=n(99180),r=n(38621),i=n(9387),o=n(18683);function l(e){const{commandRegistry:t,kernelDesc:n,save:l,sessionConnection:c}=e,[d,u]=(0,i.useState)();return(0,i.useEffect)((()=>{const e=()=>{u(c?.kernel?.status)};return e(),c?.statusChanged.connect(e),c?.connectionStatusChanged.connect(e),()=>{c?.statusChanged.disconnect(e),c?.connectionStatusChanged.disconnect(e)}}),[c]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.Q,{variant:"invisible",size:"small",leadingVisual:r.iKr,disabled:void 0===n?.location,onClick:l,children:"Save"}),(0,o.jsx)(s.Q,{variant:"invisible",size:"small",leadingVisual:r.udU,disabled:!n?.location||"busy"===d,onClick:e=>{t?.execute(a.nx.runAll)},children:"Run all"}),(0,o.jsx)(s.Q,{variant:"invisible",size:"small",leadingVisual:r.wFz,disabled:!n?.location||"busy"!==d,onClick:e=>{t?.execute(a.nx.interrupt)},children:"Interrupt"})]})}},9087:(e,t,n)=>{n.d(t,{g:()=>r});var a=n(49370),s=n(320);const r=()=>{const{requestRun:e}=(0,a.X)({notifyOnError:!1}),{configuration:t}=(0,s._O)();return{createAiAgents:(n,a,s,r,i,{signal:o,baseUrl:l="api/ai-agents/v1"}={})=>e({url:`${t.aiagentsRunUrl}/${l}/agents`,method:"POST",body:{room_id:n,room_type:a,runtime:{ingress:s,token:r,kernel_id:i}},signal:o}),getAiAgents:({signal:n,baseUrl:a="api/ai-agents/v1"}={})=>e({url:`${t.aiagentsRunUrl}/${a}/agents`,method:"GET",signal:n}),deleteAiAgent:(n,{signal:a,baseUrl:s="api/ai-agents/v1"}={})=>e({url:`${t.aiagentsRunUrl}/${s}/agents/${n}`,method:"DELETE",signal:a}),getAiAgent:(n,{signal:a,baseUrl:s="api/ai-agents/v1"}={})=>e({url:`${t.aiagentsRunUrl}/${s}/agents/${n}`,method:"GET",signal:a}),patchAiAgent:(n,a,s,r,{signal:i,baseUrl:o="api/ai-agents/v1"}={})=>e({url:`${t.aiagentsRunUrl}/${o}/agents/${n}`,method:"PATCH",body:{runtime:a&&s&&r?{ingress:a,token:s,kernel_id:r}:null},signal:i})}}},81390:(e,t,n)=>{n.d(t,{Ks:()=>i});var a=n(97283),s=n(7282);const r=(0,a.y)((e=>({agents:[],addAgent:t=>{e((e=>e.agents.includes(t)?{}:{agents:e.agents.concat([t])}))},deleteAgent:t=>{e((e=>({agents:e.agents.filter((e=>e.documentId===t))})))},updateAgent:(t,n)=>{e((e=>{const a=e.agents.findIndex((e=>e.documentId===t));return a>=0?(e.agents[a].runtimeId=n,{agents:[...e.agents]}):{}}))}})));function i(e){return(0,s.Pj)(r,e)}},42314:(e,t,n)=>{n.r(t),n.d(t,{NotebookEdit:()=>nt,default:()=>at,getRandomColor:()=>rt});var a=n(42389),s=n(16476),r=n(2159),i=n(5700),o=n(2606),l=n(29119),c=n(97789),d=n(16950),u=n(38621),m=n(79026),h=n(97096),p=n(98754),g=n(99180),f=n(93054),x=n(77672),v=n(88996),b=n(48371),j=n(64664),y=n(8586),k=n(76818),C=n(9387),w=n(20568),S=n(9403),A=n(18683);const _=e=>{const{data:t,fileName:n,variant:a,extension:s}=e;return(0,A.jsx)(g.Q,{variant:a,leadingVisual:u.s3U,onClick:e=>(0,S.xD)(t,n,s),children:"Download"})};_.defaultProps={variant:"default",name:"data",extension:"json"};var T=n(154),N=n(63948),R=n(43),P=n(88106),$=n(59179),I=n(5279),D=n(9175),E=n(34418),M=n(47785),L=n(39920),U=n(51857),V=function(e){return e[e.None=0]="None",e[e.New=1]="New",e[e.Transfer=2]="Transfer",e}(V||{});function z(e){const{assignKernel:t,sessionConnection:n}=e,{remoteKernels:a,multiServiceManager:s,jupyterLabAdapter:r}=(0,U.xb)(),[i,o]=(0,C.useState)(),[l,c]=(0,C.useState)({}),[d,m]=(0,C.useState)(V.None),[h,g]=(0,C.useState)("");(0,C.useEffect)((()=>{if(n){function e(e){g(`Runtime ${e.kernel?.connectionStatus} - Status: ${e.kernel?.status}`)}return e(n),n?.statusChanged.connect(e),n?.connectionStatusChanged.connect(e),()=>{n?.statusChanged.disconnect(e),n?.connectionStatusChanged.disconnect(e)}}g("No kernel")}),[n]);const f=(0,C.useCallback)((async()=>{s?.remote?.kernels&&await s.remote.kernels.refresh()}),[s?.remote?.kernels]),x=(0,C.useCallback)((()=>{m(V.New)}),[]),v=(0,C.useCallback)((e=>{if(e)switch(d){case V.New:f().then((()=>{o("remote"),t({kernelDesc:e,kernelModel:s?.remote?.kernels.get().find((t=>t.id===e.id))})}));break;case V.Transfer:o("remote"),t({kernelDesc:e,transferState:!0})}m(V.None)}),[f,s?.remote,d]);return(0,C.useEffect)((()=>{r?Promise.all([r.jupyterLab.resolveOptionalService(I.co),r.jupyterLab.resolveOptionalService($.zG)]).then((e=>{c({[I.co.name]:e[0],[$.zG.name]:e[1]})})):c({})}),[r]),(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(D.W,{children:[(0,A.jsx)(D.W.Button,{leadingVisual:()=>{switch(i){case"browser":return(0,A.jsx)(N.A,{});case"remote":return(0,A.jsx)(u.hpF,{});case void 0:return(0,A.jsx)(u.bMW,{})}return(0,A.jsx)(T.Cx,{type:"kernel"})},trailingVisual:()=>n?(0,A.jsx)(p.A,{sx:{paddingTop:"5px"},children:(0,A.jsx)(P.T1,{kernel:n.kernel})}):(0,A.jsx)(A.Fragment,{}),variant:"invisible",children:(0,A.jsx)(E.A,{"aria-label":h,direction:"s",children:n?n.kernel?.name:"Runtimes"})}),(0,A.jsx)(D.W.Overlay,{width:"medium",children:(0,A.jsxs)(M.l,{selectionVariant:"single",showDividers:!0,children:[(0,A.jsxs)(M.l.Group,{children:[(0,A.jsxs)(M.l.Item,{selected:void 0===i,onSelect:()=>{o(void 0),t({kernelDesc:void 0})},children:[(0,A.jsx)(M.l.LeadingVisual,{children:(0,A.jsx)(u.bMW,{})}),"Viewer",(0,A.jsx)(M.l.Description,{variant:"block",children:"A simple Notebook Viewer without Runtime."})]}),(0,A.jsxs)(M.l.Item,{selected:"browser"===i,onSelect:()=>{o("browser"),t({kernelDesc:{name:"pyodide",location:"browser",language:"python"}})},children:[(0,A.jsx)(M.l.LeadingVisual,{children:(0,A.jsx)(N.A,{})}),"Browser Runtime",(0,A.jsx)(M.l.Description,{variant:"block",children:"A Browser Runtime based on Pyodide."})]})]}),a.length>0&&(0,A.jsxs)(M.l.Group,{children:[(0,A.jsx)(M.l.GroupHeading,{children:"Cloud Runtimes"}),a.map((e=>(0,A.jsxs)(M.l.Item,{selected:n?.kernel?.id===e.id,onSelect:()=>{o("remote"),t({kernelDesc:{name:e.environment_name,language:"",location:"remote",displayName:e.kernel_given_name,id:e.id,burningRate:e.burning_rate,podName:e.jupyter_pod_name},kernelModel:e})},children:[(0,A.jsx)(M.l.LeadingVisual,{children:(0,A.jsx)(T.Cx,{type:"kernel"})}),e.kernel_given_name,(0,A.jsx)(M.l.Description,{variant:"block",children:e.environment_name})]},e.id)))]}),(0,A.jsx)(M.l.Divider,{}),(0,A.jsxs)(M.l.Group,{children:[(0,A.jsxs)(M.l.Item,{selected:!1,onSelect:x,children:[(0,A.jsx)(M.l.LeadingVisual,{children:(0,A.jsx)(R.A,{})}),"Launch a new Runtime…"]}),(0,A.jsxs)(M.l.Item,{disabled:"browser"!==i,selected:!1,onSelect:()=>{m(V.Transfer)},title:"Transfer the state of the current Runtime to a new Remote Runtime.",children:[(0,A.jsx)(M.l.LeadingVisual,{children:(0,A.jsx)(u.e0J,{})}),"Transfer state to a new Runtime…"]})]})]})})]}),s?.remote&&d>0&&(0,A.jsx)(L.s,{dialogTitle:d===V.Transfer?"Switch to a new Cloud Runtime":void 0,manager:s.remote,onSubmit:v,markdownParser:l[I.co.name],sanitizer:l[$.zG.name],startKernel:d===V.Transfer?"defer":d===V.New})]})}var O=n(59651),F=n(46343),W=n(20938),G=n(98045),B=n(31906),K=n(59528),Q=n(97734),H=n(24991),q=n(48003),J=n(61783);function Y(e){const{children:t,connection:n,podName:a,multiServiceManager:s,disabled:r}=e,{addKernelSnapshot:i,jupyterRunUrl:o,kernelSnapshots:l,setKernelSnapshots:c}=(0,U.xb)(),{trackAsyncTask:d}=(0,Q.d)(),[u,m]=(0,C.useState)(!1),[h,g]=(0,C.useState)(!1),[f,x]=(0,C.useState)(!1),[b,j]=(0,C.useState)(l[0]?.id??""),[y,k]=(0,C.useState)();(0,C.useEffect)((()=>{(0,H.v2)().then((e=>{c(e),!b&&e.length>0&&j(e[0].id)})).catch((e=>{console.error(`Failed to fetch remote kernel snapshots; ${e}`)}))}),[o]);const w=(0,C.useCallback)((()=>{k(void 0),m(!0)}),[]),S=(0,C.useCallback)((e=>{j(e.target.value)}),[]),_=(0,C.useCallback)((async({id:e,connection:t,podName:n})=>{n?await(0,H.Wm)({id:n,from:e}):t&&await(0,q.M)({connection:t,id:e})}),[]),T=(0,C.useCallback)((async()=>{try{let e,t;x(!0);let r="",o="";if(a&&s?.remote)o=(0,J.m)("cloud"),t=s.remote.kernels.snapshot({podName:a,name:o,description:o,stop:!1}),r=a.split("-",2).reverse()[0],t.then((t=>{e=t}));else if(n&&s?.browser){const a=n.model;r=a.id,o=(0,J.m)("browser");let i=!0;t=(0,q._)({connection:s.browser.kernels.connectTo({model:a}),metadata:{filename:`${o}.data`},onUploadProgress:()=>{i&&(i=!1,(0,H.v2)().then((t=>{e=t.find((e=>e.name===o))})))}})}t&&(d(t,{error:{message:(e,t)=>"Empty snapshot"==e?`Runtime ${r} will not be snapshotted as it does not contain any serializable state.`:`Failed to pause runtime ${r} - ${e}`},pending:{message:`Taking a snapshot of runtime ${r}…`},success:{message:()=>`Runtime ${r} successfully snapshotted as ${o}.`}}),await t,e&&i(e))}finally{x(!1)}}),[n,a,s]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(D.W,{children:[(0,A.jsx)(D.W.Button,{leadingVisual:F.A,variant:"invisible",disabled:h||f||r,children:t}),(0,A.jsx)(D.W.Overlay,{children:(0,A.jsxs)(M.l,{children:[(0,A.jsx)(M.l.Item,{onSelect:w,disabled:h||0==l.length,children:"Load a runtime snapshot…"}),(0,A.jsx)(M.l.Item,{onSelect:T,disabled:f,children:"Take a runtime snapshot"})]})})]}),u&&(0,A.jsx)(K.l,{title:"Choose a runtime snapshot to load",onClose:()=>{m(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:e=>{e.defaultPrevented||(e.preventDefault(),m(!1))}},{buttonType:"primary",content:h?(0,A.jsx)(W.A,{size:"small"}):"Load",disabled:h,onClick:async e=>{if(!e.defaultPrevented){e.preventDefault(),g(!0);try{k(void 0);const e=l.find((e=>e.id===b));e&&(n||a)?await _({connection:n,id:e.id,podName:a}):k("No runtime snapshot found.")}finally{g(!1),m(!1)}}},autoFocus:!0}],children:(0,A.jsxs)(p.A,{as:"form",children:[(0,A.jsxs)(v.A,{children:[(0,A.jsx)(v.A.Label,{children:"Snapshot"}),(0,A.jsx)(G.A,{name:"snapshot",value:b,onChange:S,block:!0,children:l.map((e=>(0,A.jsx)(G.A.Option,{value:e.id,children:e.name?`${e.name} (${e.id})`:e.id},e.id)))})]}),y&&(0,A.jsx)(B.A,{variant:"danger",children:y})]})})]})}Y.defaultProps={disabled:!1};var X=n(63711),Z=n(98238),ee=n(43049),te=n(40402),ne=n(55285),ae=n(2381);const se=1048576;function re({contents:e,documentRegistry:t}){const n=(0,ne.aq)(),{trackAsyncTask:a}=(0,Q.d)(),[s,r]=(0,C.useState)(null),[i,o]=(0,C.useState)(!0),[l,c]=(0,C.useState)(null),[d,u]=(0,C.useState)(null),[m,h]=(0,C.useState)(!1),g=(0,C.useCallback)((()=>{if(l){const t=e.delete(l.path);a(t,{error:{message:e=>{const t=`Failed to delete ${l.path}.`;return console.error(t,e),t}},pending:{message:`Deleting ${l.path}…`},success:{message:()=>`${l.path} deleted.`}}),t.finally((()=>{l.refresh()}))}h(!1)}),[e,l]),f=(0,C.useCallback)((()=>{e.get("").then((e=>{o(!1),r(le(e.content,t))})).catch((t=>{o(!1),console.error(`Failed to fetch folder '' content for manager ${e.serverSettings.appUrl}.`,t)}))}),[e]),x=(0,C.useCallback)((async t=>{const s=()=>{if(!n())return Promise.reject(`Failed to upload ${t.name}; FileBrowser component is unmounted.`)};s();const r=t.size>se,i=l?"directory"===l.type?l.path:X.PathExt.dirname(l.path):"",o=i?X.PathExt.join(i,t.name):t.name,c=t.name,d=async(n,a)=>{s();const r=new FileReader;r.readAsDataURL(n),await new Promise(((e,n)=>{r.onload=e,r.onerror=e=>n(`Failed to upload "${t.name}":`+e)})),s();const i=r.result.split(",")[1],l={type:"file",format:"base64",name:c,chunk:a,content:i};return await e.save(o,l)},u={error:{message:e=>{const n=`Failed to upload ${t.name}.`;return console.error(n,e),n}},pending:{message:`Uploading ${t.name}…`},success:{message:()=>`${t.name} uploaded.`}};if(!r){const e=d(t);return a(e,u),e.then((()=>{l?l.refresh():f()})),e}{const e=new Z.PromiseDelegate;a(e.promise,u);try{let n;for(let a=0;!n;a+=se){const s=a+se,r=s>=t.size,i=r?-1:s/se,o=await d(t.slice(a,s),i);r&&(n=o,e.resolve(n))}return l?l.refresh():f(),n}catch(t){throw e.reject(t),t}}}),[e,l,f]);(0,C.useEffect)((()=>{f()}),[f]);const v=(0,C.useCallback)((e=>{u(d===e?null:e)}),[d]),b=(0,C.useCallback)((()=>{h(!0)}),[]),j=(0,C.useCallback)(((e,t)=>{c(e.path===l?.path?null:{...e,refresh:t})}),[l]);return(0,A.jsxs)(p.A,{sx:{display:"grid",gridTemplateAreas:'\n"header"\n"content"'},children:[(0,A.jsxs)(p.A,{sx:{gridArea:"header",display:"flex",alignItems:"center"},children:[(0,A.jsx)(y.A,{as:"h4",sx:{fontSize:"var(--text-title-size-small)",lineHeight:"var(--text-title-lineHeight-medium)",fontWeight:"var(--text-title-weight-medium)",flex:"1 1 auto"},children:"Storage Browser"}),(0,A.jsx)(p.A,{children:(0,A.jsx)(ae.HF,{label:"Upload a file",multiple:!0,upload:x})})]}),i?(0,A.jsx)(p.A,{sx:{gridArea:"content",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40px",height:"100vh"},children:(0,A.jsx)(W.A,{})}):(0,A.jsx)(p.A,{sx:{gridArea:"content"},children:s?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(ee.G,{children:s?.map((n=>(n.fileType,"directory"===n.type?(0,A.jsx)(ie,{item:n,contents:e,current:l,documentRegistry:t,onContextMenu:v,onSelect:j},n.name):(0,A.jsx)(oe,{item:n,current:l?.path===n.path,onSelect:e=>{j(e,f)},onContextMenu:v},n.name))))}),(0,A.jsx)(D.W,{anchorRef:d??void 0,open:null!==d?.current,onOpenChange:()=>{u(null)},children:(0,A.jsx)(D.W.Overlay,{children:(0,A.jsx)(M.l,{children:(0,A.jsx)(M.l.Item,{title:"Delete the active item.",onSelect:b,children:"Delete…"})})})}),m&&(0,A.jsx)(K.l,{title:"Confirm deletion",onClose:()=>{h(!1)},footerButtons:[{buttonType:"default",content:"Cancel",onClick:()=>{h(!1)}},{buttonType:"danger",content:"Delete",onClick:()=>{g()}}],children:`Are you sure you want to delete ${l?.path}?`})]}):(0,A.jsx)(te.A,{children:(0,A.jsx)(te.A.Heading,{children:"No contents"})})})]})}function ie({item:e,contents:t,current:n,documentRegistry:a,onContextMenu:s,onSelect:r}){const i=(0,C.useRef)(null),[o,l]=(0,C.useState)(null),[c,d]=(0,C.useState)(!1),u=(0,C.useCallback)((()=>{d(!0),t.get(e.path).then((e=>{d(!1),l(le(e.content,a))})).catch((()=>{d(!1)}))}),[t,e,a]),m=(0,C.useCallback)((async e=>{null===o&&e&&u()}),[o,e,t]);return(0,A.jsxs)(ee.G.Item,{ref:i,id:`${e.type}-${e.name}`,onExpandedChange:m,onSelect:()=>{r(e,u)},current:e.path===n?.path,children:[(0,A.jsx)(ee.G.LeadingVisual,{children:(0,A.jsx)(ee.G.DirectoryIcon,{})}),(0,A.jsx)("span",{onContextMenu:t=>{t.preventDefault(),n?.path!==e.path&&r(e,u),s(i)},children:e.name}),(0,A.jsx)(ee.G.SubTree,{state:c?"loading":(o?.length??-1)>=0?"done":"initial",children:o?.map((e=>"directory"===e.type?(0,A.jsx)(ie,{item:e,contents:t,current:n,documentRegistry:a,onContextMenu:s,onSelect:r},e.name):(0,A.jsx)(oe,{item:e,current:e.path===n?.path,onSelect:e=>r(e,u),onContextMenu:s},e.name)))})]})}function oe({item:e,current:t,onSelect:n,onContextMenu:a}){const s=(0,C.useRef)(null),r=e.fileType?.icon;return(0,A.jsxs)(ee.G.Item,{ref:s,id:`${e.type}-${e.name}`,current:t,onSelect:()=>{n(e)},children:[(0,A.jsx)(ee.G.LeadingVisual,{children:r?(0,A.jsx)(r.react,{tag:"span"}):(0,A.jsx)(u.oSV,{})}),(0,A.jsx)("span",{onContextMenu:r=>{r.preventDefault(),t||n(e),a(s)},children:e.name})]},e.name)}function le(e,t){const n=e.map((e=>({...e,fileType:t?.getFileTypeForModel(e)})));return n.sort(((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:"directory"!==e.type&&"directory"===t.type?1:e.name.localeCompare(t.name))),n}var ce=n(46916),de=n(17810),ue=n(23530),me=n(53850),he=n(9087),pe=n(88037),ge=n(26573);function fe(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class xe extends pe._Q{constructor(e){super(),fe(this,"_rows",void 0),fe(this,"_mimeType",void 0),this._mimeType=e.mimeType,this._rows=[]}renderModel(e){const t=e.data[this._mimeType].split("\n").map((e=>e.split(";")));return this._rows=t,Promise.resolve()}render(){return 0===(this._rows.length>0?this._rows[0].length:0)?(0,A.jsx)("div",{children:"No data found!"}):(0,A.jsx)(ge.NP,{children:this._rows.map((e=>(0,A.jsx)(p.A,{mt:3,children:e})))})}}const ve={safe:!0,mimeTypes:["application/vnd.datalayer.csv"],createRenderer:e=>new xe(e)};var be=n(320),je=n(44536),ye=n(97283),ke=n(7282);const Ce=(0,ye.y)(((e,t)=>({datasources:[],updateDatasources:t=>e((e=>({datasources:t})))})));function we(e){return(0,ke.Pj)(Ce,e)}var Se=n(27199),Ae=n(81390),_e=n(85961);function Te(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ne{constructor(e){Te(this,"iamProvider","linkedin"),Te(this,"urn",void 0),Te(this,"id",void 0),this.urn=e;const t=e.split(":");this.id=t[3]}getURL(){return`https://www.linkedin.com/feed/update/${this.urn}`}}var Re=n(43715);const Pe=e=>{const{screenCapture:t}=(0,Se.l5)(),{enqueueToast:n}=(0,Q.d)(),{user:a,iamProvidersAuthorizationURL:s,getIAMProviderAccessToken:r}=(0,je.Y)(),{getLinkedinProfile:i,postLinkedinShareWithUpload:o}=(0,me.E)(),{showBackdrop:l,hideBackdrop:c}=(0,Se.l5)(),[d,u]=(0,C.useState)(),[m,h]=(0,C.useState)(""),[f,b]=(0,C.useState)({shareText:void 0}),[y,k]=(0,C.useState)({shareText:void 0});return(0,C.useEffect)((()=>{k({...y,shareText:void 0===f.shareText?void 0:f.shareText.length>2&&f.shareText.length<1e3})}),[f]),(0,C.useEffect)((()=>{if(a){const e=r(a,"linkedin");e&&i(e).then((e=>{u(e)}))}}),[a]),(0,A.jsx)(A.Fragment,{children:s[Re.W.LinkedIn.name]?d&&(0,A.jsx)(p.A,{display:"flex",children:(0,A.jsxs)(p.A,{ml:3,sx:{width:"100%"},children:[(0,A.jsx)(p.A,{children:(0,A.jsxs)(v.A,{required:!0,children:[(0,A.jsx)(v.A.Label,{children:"Tell something nice"}),(0,A.jsx)(j.Ay,{block:!0,value:f.shareText,onChange:e=>{b((t=>({...t,shareText:e.target.value})))},rows:3}),!1===y.shareText&&(0,A.jsx)(v.A.Validation,{variant:"error",children:"Text must have more than 2 characters and less than 1000."})]})}),(0,A.jsxs)(p.A,{mt:3,children:[(0,A.jsx)(g.Q,{disabled:!y.shareText||!t,leadingVisual:_e.A,onClick:()=>{if(a&&d&&t){l("Posting on LinkedIn.");const e=r(a,"linkedin");o(d,f.shareText,t,e).then((e=>{if(e.success){const t=e.restli;if(t){const e=new Ne(t).getURL();return n("Your post is shared on LinkedIn.",{variant:"success"}),void h(e)}}n("Sorry, we were not able to share your content on LinkedIn...",{variant:"error"})})).finally((()=>{c()}))}},children:"Share on LinkedIn"}),m&&(0,A.jsx)(x.A,{href:m,target:"_blank",children:m})]})]})}):(0,A.jsx)(B.A,{variant:"warning",children:"This deployment is not configured for LinkedIn integration."})})};var $e=n(14809),Ie=n(17310),De=n(6681),Ee=n(26977);function Me(e){const{agents:t,addAgent:n}=(0,Ae.Ks)(),{createAiAgents:a}=(0,he.g)(),{cell:s,extensionProps:r}=e,{notebookId:i}=r,[o,l]=(0,C.useState)(!1),[c,d]=(0,C.useState)(null),[m,h]=(0,C.useState)({prompt:""}),[f,x]=(0,C.useState)({prompt:void 0});(0,C.useEffect)((()=>{const e=(e,t)=>{if("datalayer"==t.key&&c)for(const e of s.model.sharedModel.getMetadata("datalayer")?.ai?.messages??[])if(e.parent_id===c){d(null);break}};return s.model.sharedModel.metadataChanged.connect(e),()=>{s.model?.sharedModel.metadataChanged.disconnect(e)}}),[s,c]),(0,C.useEffect)((()=>{c||l(!1)}),[c]),(0,C.useEffect)((()=>{x({...f,prompt:void 0===m.prompt?void 0:m.prompt.length>0})}),[m]);const b=(0,C.useCallback)((async()=>{const e=r.panel.context.sessionContext.session?.kernel,o=e?.serverSettings,l=e?.id;t.find((e=>e.documentId==i&&e.runtimeId==l))||(await a(i,"notebook_persist",o?.baseUrl,o?.token,l),n({documentId:i,runtimeId:l}));const c=(0,Ee.f)();!function(e,t,n){const a=e.model.getMetadata("datalayer")??{},s=a.ai??{prompts:[],messages:[]},r=s.prompts??[];r.push({id:t,prompt:n,username:void 0,timestamp:Date.now()}),s.prompts=r,a.ai=s,e.model.setMetadata("datalayer",a)}(s,c,m.prompt),d(c)}),[t,s,r.panel.context.sessionContext.session?.kernel,m.prompt,i,a]),y=(0,C.useCallback)((e=>{e.ctrlKey&&"Enter"===e.key&&b()}),[b]);return(0,A.jsx)(ge.NP,{children:(0,A.jsx)(p.A,{display:"flex",style:{justifyContent:"right"},children:(0,A.jsx)(p.A,{className:"dla-cell-ai-agent-button",children:(0,A.jsxs)(D.W,{open:o,onOpenChange:e=>l(e),children:[(0,A.jsx)(D.W.Anchor,{id:"custom-anchor-id",children:(0,A.jsx)(De.K,{icon:u.SD8,variant:"invisible","aria-label":"AI Agents menu"})}),(0,A.jsx)(D.W.Overlay,{width:"large",children:(0,A.jsxs)(p.A,{as:"form",m:3,children:[(0,A.jsxs)(v.A,{children:[(0,A.jsx)(v.A.Label,{visuallyHidden:!0}),(0,A.jsx)(j.Ay,{block:!0,value:m.prompt,onChange:e=>{h((t=>({...t,prompt:e.target.value})))},disabled:!!c,onKeyDown:y})]}),(0,A.jsxs)(p.A,{sx:{display:"flex",width:"100%",gap:"2px",marginTop:"var(--stack-gap-normal)"},children:[(0,A.jsx)(p.A,{flexGrow:1}),(0,A.jsx)(g.Q,{onClick:e=>l(!1),variant:"default",children:"Cancel"}),(0,A.jsx)(g.Q,{leadingVisual:Ie.A,onClick:b,disabled:!f.prompt||!!c,variant:"primary",children:c?(0,A.jsx)(W.A,{size:"small"}):"Ask Joyvan"})]})]})})]})})})})}var Le=n(94247);const Ue=e=>{const{cell:t}=e,{datasources:n}=we(),[a,s]=(0,C.useState)();(0,C.useEffect)((()=>{const e=(e,t)=>{if("datalayer"==(t?.key??"datalayer")){const t=(e=>{const t=e.getMetadata("datalayer");if(t){const e=t.datasource;if(e)return e.id}})(e);if(t)for(const e of n)if(t===e.id){s(t);break}}};return e(t.model),t.model.metadataChanged.connect(e),()=>{t.model?.metadataChanged.disconnect(e)}}),[t,n]);const r=e=>{const n=t.model.getMetadata("datalayer");e?(t.model.setMetadata("datalayer",{...n,sql:!0,datasource:{id:e.id,variant:e.variant,name:e.name,description:e.description,database:e.database,outputBucket:e.outputBucket,destinationVar:"df"}}),s(e.id),t.editor.model.mimeType=Le.bd):(t.model.setMetadata("datalayer",{...n,sql:!1,datasource:{}}),s(void 0),t.editor.model.mimeType=Le.dC)};return(0,A.jsx)(ge.NP,{children:(0,A.jsx)(p.A,{display:"flex",style:{justifyContent:"right"},children:(0,A.jsx)(p.A,{className:"dla-cell-datasource-button",children:(0,A.jsxs)(D.W,{children:[(0,A.jsx)(D.W.Anchor,{id:"custom-anchor-id",children:(0,A.jsx)(De.K,{icon:u.bN0,variant:"invisible","aria-label":"Open Datasources menu"})}),(0,A.jsx)(D.W.Overlay,{width:"medium",children:(0,A.jsx)(M.l,{selectionVariant:"single",showDividers:!0,children:(0,A.jsxs)(M.l.Group,{children:[(0,A.jsx)(M.l.GroupHeading,{children:"Datasources"}),0===n.length&&(0,A.jsxs)(M.l.Item,{onSelect:()=>{},children:["No Datasource available",(0,A.jsx)(M.l.Description,{variant:"block",children:"Create a new Datasource to connect your cell."})]}),n.map((e=>(0,A.jsxs)(M.l.Item,{onSelect:()=>r(e),selected:e.id===a,children:[e.name,(0,A.jsx)(M.l.Description,{variant:"block",children:e.description})]},e.id))),(0,A.jsx)(M.l.Divider,{}),(0,A.jsx)(M.l.Item,{children:(0,A.jsxs)(v.A,{children:[(0,A.jsx)(v.A.Label,{children:"Output Dataframe"}),(0,A.jsx)(b.A,{size:"small",value:"df",disabled:!0})]})}),(0,A.jsx)(M.l.Divider,{}),(0,A.jsx)(M.l.Item,{variant:"danger",onSelect:()=>r(void 0),children:"None"})]})})})]})})})})};function Ve(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ze="dla-CellToolbar-Container";class Oe extends pe._Q{constructor(e,t){super(),Ve(this,"_cell",void 0),Ve(this,"_props",void 0),this._cell=e,this._props=t,this.addClass(ze)}render(){return(0,A.jsxs)(p.A,{display:"flex",children:[(0,A.jsx)(p.A,{flexGrow:1}),(0,A.jsxs)(w.fS,{initialEntries:["/"],children:[(0,A.jsx)(w.BV,{children:(0,A.jsx)(w.qh,{path:"*",element:(0,A.jsx)(Me,{cell:this._cell,extensionProps:this._props})})}),(0,A.jsx)(Ue,{cell:this._cell,extensionProps:this._props})]})]})}}function Fe(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class We extends $e.x0{constructor(e,t){super(),Fe(this,"_panel",void 0),Fe(this,"_props",void 0),this._panel=e,this._props=t,this.updateConnectedCell=this.updateConnectedCell.bind(this);const n=()=>{const e=this._panel.content.model?.cells;if(e){e.changed.connect(this.updateConnectedCell);for(let t=0;t<e.length;++t)this._registerCellChanges(e.get(t))}};n(),this._panel.content.modelChanged.connect((()=>{n()}))}updateConnectedCell(e,t){t.oldValues.forEach(this._deregisterCellChanges.bind(this)),t.newValues.forEach(this._registerCellChanges.bind(this))}_deregisterCellChanges(e){}_registerCellChanges(e){const t=this._getCodeCell(e);t?(t.displayChanged.connect((()=>{this._updateCodeCell(t)})),t.inViewportChanged.connect((()=>{this._updateCodeCell(t)})),this._updateCodeCell(t)):"code"===e.type&&console.error(`Could not find code cell for model: ${e}`)}_getCodeCell(e){return"code"===e.type?this._panel.content.widgets.find((t=>t.model===e)):null}_updateCodeCell(e){if(e.inputArea){const t=e.layout;if(t){const n=t;n.widgets[1].hasClass(ze)||n.insertWidget(1,new Oe(e,this._props))}}}}class Ge{constructor(){var e,t,n;e=this,n=void 0,(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t="_props"))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}init(e){this._props=e}createNew(e,t){new We(e,this._props)}get component(){return null}}var Be=n(34778),Ke=n(52350),Qe=n(10815),He=n(68822);const qe=28,Je="DatalayerSpacer",Ye=3e4;var Xe=function(e){return e.PROGRESS="var(--borderColor-accent-emphasis)",e.ERROR="var(--borderColor-danger-emphasis)",e.SUCCESS="var(--borderColor-success-emphasis)",e}(Xe||{});const Ze={"-1":Xe.ERROR,0:Xe.PROGRESS,1:Xe.SUCCESS};function et({awareness:e,currentUserHandle:t}){const[n,a]=(0,C.useState)([]);return(0,C.useEffect)((()=>{const n=()=>{const n=e.getStates();a(Array.from(n.values()).filter((e=>e.user&&e.user?.name!==t&&!(e.user?.agent??"").startsWith(Je))).reduce(((e,t)=>{const n=t.user,a=!((t.notification?.timestamp??0)+Ye<Date.now()),s=n.agent?{avatarUrl:"https://static.vecteezy.com/system/resources/previews/006/662/139/large_2x/artificial-intelligence-ai-processor-chip-icon-symbol-for-graphic-design-logo-web-site-social-media-mobile-app-ui-illustration-free-vector.jpg",color:n.color,displayName:n.agent,handle:"agent",initials:"AI",username:n.agent,notification:a?`${t.notification?.message} ${(0,Qe.g)(new Date(t.notification.timestamp))}`:void 0,notificationType:a&&void 0!==t.notification?.message_type?Ze[t.notification?.message_type.toString()]:void 0}:{avatarUrl:n.avatar_url,color:n.color,displayName:n.display_name,handle:n.name,initials:n.initials,username:n.username};return e.map((e=>e.username)).includes(s.username)||e.push(s),e}),[]))};n(),e.on("change",n);const s=setInterval(n,Ye/3);return()=>{clearInterval(s),e.off("change",n)}}),[e,t]),(0,A.jsx)(Be.A,{children:n.map((e=>{let t=`${e.displayName}\n${e.handle}`;return e.notification&&(t+=`\n${e.notification}`),(0,A.jsx)(Ke.A,{sx:{border:e.notificationType?`var(--borderWidth-thick) solid ${e.notificationType}`:"none"},title:t,src:e.avatarUrl?(0,He.$K)(e.avatarUrl):(n=e.color,a=e.initials,"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="12" fill="${n}" stroke="none" /><text x="12" y="12" fill="black">${a}</text></svg>`)),size:qe},e.displayName);var n,a}))})}const tt=new a.Od;function nt(){const{notebookId:e}=(0,w.g)();if(!e)return(0,A.jsx)(A.Fragment,{});const t=(0,de.J)(),a=(0,m.S)(),S=(0,ue.Z)(),{configuration:N}=(0,be._O)(),{credits:R,token:P}=(0,je.Y)(),{configuration:$,multiServiceManager:I,jupyterLabAdapter:D,remoteKernels:E}=(0,U.xb)(),[M,L]=(0,C.useState)(tt),[V,F]=(0,C.useState)(void 0),[W,G]=(0,C.useState)(),[B,K]=(0,C.useState)(!1),[J,X]=(0,C.useState)(),[Z,ee]=(0,C.useState)(!1),[te,ne]=(0,C.useState)(!0),[ae,se]=(0,C.useState)(""),{updateDatasources:ie}=we(),{enqueueToast:oe,trackAsyncTask:le}=(0,Q.d)(),{selectNotebookModel:pe,reset:ge}=(0,s.Gx)(),{hideBackdrop:fe,screenCapture:xe,setItem:ye,setScreenCapture:ke,showBackdrop:Ce,showScreenshot:_e,space:Te,triggerItemsRefresh:Ne}=(0,Se.l5)(),{cloneNotebook:Re,deleteItem:$e,getDatasources:Ie,getNotebook:De,refreshDatasources:Ee,refreshNotebook:Me,updateNotebook:Le,updateNotebookModel:Ue}=(0,me.E)(),[Ve,ze]=(0,C.useState)(null),[Oe,Fe]=(0,C.useState)(),[We,Be]=(0,C.useState)(),[Ke,Qe]=(0,C.useState)({name:"",nameConfirm:"",description:""}),[He,qe]=(0,C.useState)({name:void 0,nameConfirm:void 0,description:void 0}),[Je,Ye]=(0,C.useState)(null),{updateAgent:Xe}=(0,Ae.Ks)(),{patchAiAgent:Ze}=(0,he.g)(),nt=function(e){const{agents:t,addAgent:n,deleteAgent:a,updateAgent:s}=(0,Ae.Ks)(),{getAiAgent:r}=(0,he.g)();return(0,C.useEffect)((()=>{let i;const o=setInterval((async()=>{i=new AbortController;try{const o=await r(e,{signal:i.signal});if(!o.success)return void a(e);const l=t.find((t=>t.documentId==e)),c=o.agent.runtime?.id;l?l.runtimeId!==c&&s(e,c):n({documentId:e,runtimeId:c})}catch(t){a(e)}}),6e4);return()=>{i?.abort("Component unmounted"),clearInterval(o)}}),[t,e]),t.find((t=>t.documentId===e))}(e),at=(0,C.useMemo)((()=>({baseURL:N.spacerRunUrl,token:P,roomName:e,type:"datalayer"})),[N.spacerRunUrl,e,P]),st=(0,C.useMemo)((()=>new d.J),[]),it=(0,C.useMemo)((()=>[new Ge,new r._({factory:i.N})]),[]),ot=(0,C.useMemo)((()=>[ve]),[]),lt=(0,C.useMemo)((()=>rt()),[]);(0,C.useEffect)((()=>{if(E&&E.length>0&&!J){const e=E[0];dt({kernelDesc:{name:e.environment_name,language:"",location:"remote",displayName:e.kernel_given_name,id:e.id,burningRate:e.burning_rate,podName:e.jupyter_pod_name},kernelModel:e})}}),[E]),(0,C.useEffect)((()=>{Ve&&Ve.sharedModel.awareness.setLocalStateField("user",{username:t.id,name:t.handle,display_name:t.displayName,initials:`${t.firstName[0]?.toLocaleUpperCase()??"?"}${t.lastName[0]?.toLocaleUpperCase()||"?"}`,color:lt,avatar_url:t.avatarUrl})}),[Ve,t,lt]),(0,C.useEffect)((()=>(Ce(),Me(e).then((t=>{if(fe(),t.success){const t=De(e);t?(Fe(t),Be(t.nbformat),ye(t),Qe({name:t.name,nameConfirm:"",description:t.description})):S("/")}else oe(t.message,{variant:"error"})})).finally((()=>{fe()})),()=>{M.dispose(),Fe(void 0),ge(),ye(void 0)})),[e]),(0,C.useEffect)((()=>{Ee().then((e=>{if(e.success){const e=Ie();ie(e)}}))}),[e]),(0,C.useEffect)((()=>{nt&&ae&&nt.runtimeId!==V&&(Ze(e,M.serverSettings.baseUrl,M.serverSettings.token,V),Xe(e,V))}),[nt,V,e,ae,M]),(0,C.useEffect)((()=>{qe({...He,name:void 0===Ke.name?void 0:Ke.name.length>2,nameConfirm:Ke.nameConfirm===Oe?.name,description:void 0===Ke.description?void 0:Ke.description.length>2})}),[Ke]);const ct=(0,C.useCallback)((async()=>{Ce(),Le(e,Ke.name,Ke.description).then((e=>{e.success&&(oe("The notebook is successfully updated.",{variant:"success"}),Ne(),Fe({...Oe,name:Ke.name,description:Ke.description}))})).finally((()=>{fe()}))}),[e,Ke.name,Ke.description,Oe]),dt=(0,C.useCallback)((async({kernelDesc:a,kernelModel:s,transferState:r})=>{const i=pe(e);i?.model&&Be(i.model.toJSON()),G(a);const o=a?.location;switch(se(""),o){case void 0:F(void 0),ne(!0),K(!1),L(tt);break;case"browser":if(I?.browser){if(D){if(!D.jupyterLab.hasPlugin("@jupyterlite/pyodide-kernel-extension:kernel")){const e=await Promise.all([n.e(2252),n.e(7952)]).then(n.bind(n,10382));D.jupyterLab.registerPluginModule(e)}D.jupyterLab.isPluginActivated("@jupyterlite/pyodide-kernel-extension:kernel")||await D.jupyterLab.activatePlugin("@jupyterlite/pyodide-kernel-extension:kernel")}F(void 0),ne(!1),K(!0),L(I.browser)}else console.error("Unable to use browser kernel. No service manager for it.");break;case"remote":{if(!I?.remote){console.error("Unable to use a remote kernel. No service manager for it.");break}let e;if(r&&M&&M===I?.browser&&J?.kernel)try{Ce();let t=!0;const n=J.kernel.id,a=`pyodide-${n}`,s=(0,q._)({connection:J.kernel,metadata:{filename:`${a}.data`},onUploadProgress:()=>{t&&(t=!1,(0,H.v2)().then((t=>{e=t.find((e=>e.name===a))})))}});if(le(s,{error:{message:e=>`Failed to save the browser kernel state. ${e}`},pending:{message:"Saving the browser kernel state…"},success:{message:()=>"Browser kernel state saved."}}),await s,!e)throw Error("Unable to find snapshot for pyodide state.");await I.browser.kernels.shutdown(n)}finally{fe()}if(!s){const{name:n,displayName:r,params:i}=a,o=await(I?.remote?.kernels.startNew({name:n,kernelType:"notebook",givenName:r,creditsLimit:i?.creditsLimit??(R?.available??0)/Math.max($.maxCellKernels-E.filter((e=>"cell"!==e.kernel_type)).length,1),capabilities:i?.capabilities,snapshot:e?.id},{username:t?.handle,handleComms:!0}));s=await I.remote.kernels.findById(o.id),o.dispose()}K(!1),F(s.id),ne(!1);const n=I.remote.kernels.getServices(s.jupyter_pod_name);se(s.jupyter_pod_name);const i=new c.ServiceManager({contents:n?.contents,kernels:n?.kernels,kernelspecs:n?.kernelspecs,serverSettings:n?.serverSettings,sessions:n?.sessions,events:{dispose:()=>{}},terminals:{connectionFailure:{connect:()=>{}},dispose:()=>{},isAvailable:()=>!1}});L(i),Ye("storage");break}}ht(void 0)}),[$,R,D,e,I,E,M,J]),ut=(0,C.useCallback)((async n=>{a({title:"Are you sure?",content:"Please confirm you want to clone this notebook in your private library."}).then((n=>{n&&(Ce(),Re(e).then((e=>{fe(),e.success&&(oe(e.message,{variant:"success"}),Ne(),S(`/${t.handle}/library/notebooks`))})))}))}),[a,Oe]),mt=(0,C.useCallback)((e=>{ze(e)}),[]),ht=(0,C.useCallback)((e=>{X(e||void 0)}),[]),pt=(0,C.useCallback)((()=>{if(!te&&Ve?.cells){Ce("Saving the notebook...");const t=Ve.toJSON();Ue(e,t).then((n=>{n.success&&(oe("The notebook is successfully updated.",{variant:"success"}),Fe({...Oe,id:e,nbformat:t}))})).finally((()=>{fe()}))}}),[e,Ve,te]),gt=(0,C.useCallback)((()=>{Ye("storage"!==Je&&M&&M!==tt?"storage":null)}),[Je,M]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(h.z,{role:"header","aria-label":"Notebook Editor",children:[(0,A.jsx)(h.z.TitleArea,{variant:"subtitle",children:(0,A.jsx)(h.z.Title,{children:"Notebook Editor"})}),(0,A.jsx)(h.z.Actions,{children:Oe&&Te&&(0,A.jsxs)(p.A,{sx:{flex:"0 0 auto",display:"flex",alignItems:"center"},children:[I?.remote&&J&&J.kernel&&(0,A.jsx)(O.m,{kernelId:J.kernel.id,serviceManager:I.remote,onClick:()=>{S("/runtimes")}},"credits-indicator"),(0,A.jsx)(z,{assignKernel:dt,sessionConnection:J},"kernel-picker"),(0,A.jsx)(Y,{connection:J?.kernel??void 0,multiServiceManager:I,podName:ae,disabled:void 0===W?.location,children:"Snapshots"}),(0,A.jsx)(g.Q,{title:"Browse content on the Remote Runtime",variant:"invisible",size:"small",disabled:!M||M===tt,leadingVisual:()=>(0,A.jsx)(T.Cx,{type:"content"}),onClick:gt,children:"Storage"},"content"),(0,A.jsx)(ce.E,{commandRegistry:st,kernelDesc:W,save:pt,sessionConnection:J},"toolbar"),(0,A.jsx)(g.Q,{variant:"invisible",size:"small",leadingVisual:u.Nc$,onClick:ut,children:"Clone"},"clone"),(0,A.jsx)(g.Q,{title:"Capture screen",variant:"invisible",size:"small",leadingVisual:()=>(0,A.jsx)(u.rVi,{}),onClick:()=>{_e()},children:"Capture"},"capture-screen"),(0,A.jsx)(g.Q,{title:"Share",variant:"invisible",size:"small",leadingVisual:()=>(0,A.jsx)(T.Cx,{type:"share"}),onClick:e=>ee(!Z),children:"Share"},"share"),(0,A.jsx)(g.Q,{variant:"invisible",size:"small",leadingVisual:()=>(0,A.jsx)(T.Cx,{type:"page"}),onClick:t=>S(`/new/page/notebook/${e}`),children:"Publish"},"public"),(0,A.jsx)(g.Q,{variant:"invisible",size:"small",leadingVisual:u.L64,onClick:e=>{Ye("properties"===Je?null:"properties")},children:"Properties"},"properties"),"datalayer"===at.type&&Ve&&(0,A.jsx)(et,{awareness:Ve.sharedModel.awareness,currentUserHandle:t.handle},"peers")]})})]}),(0,A.jsxs)(f.O7,{children:[(0,A.jsxs)(f.O7.Content,{"aria-label":"Notebook Editor",width:"full",padding:"none",children:[xe&&(0,A.jsx)(p.A,{mt:3,children:(0,A.jsxs)(p.A,{display:"flex",children:[(0,A.jsx)(p.A,{children:(0,A.jsx)("img",{src:xe})}),(0,A.jsx)(p.A,{children:(0,A.jsx)(x.A,{href:"javascript: return false;",onClick:e=>ke(void 0),children:(0,A.jsx)(u.uv5,{})})})]})}),Z&&(0,A.jsx)(p.A,{sx:{flexGrow:1},children:(0,A.jsx)(Pe,{})}),We&&(void 0===W?.location?(0,A.jsx)(p.A,{sx:{"& .jp-Cell":{marginTop:30}},children:(0,A.jsx)(o.j,{nbformat:We,outputs:!0})}):(0,A.jsx)(p.A,{sx:{"& .jp-WindowedPanel":{margin:0},"& .jp-WindowedPanel-viewport":{padding:0},"& .dla-CellSidebar-Container":{position:"relative",marginLeft:"auto"},"& .jp-Cell .dla-CellSidebar-Container":{display:"none"},"& .jp-Cell.jp-mod-active .dla-CellSidebar-Container":{display:"block"}},children:(0,A.jsx)(l.E,{commands:st,extensions:it,id:e,collaborationServer:at,nbformat:We,readonly:te,renderers:ot,kernelId:V,serviceManager:M,startDefaultKernel:B,height:"calc(100vh - 150px)",maxHeight:"calc(100vh - 150px)",onNotebookModelChanged:mt,onSessionConnection:ht})}))]}),null!==Je&&(0,A.jsx)(f.O7.Pane,{"aria-label":"storage"===Je?"Remote Runtime Storage":"Notebook Properties",position:"start",width:"large",children:"storage"===Je&&M.contents?(0,A.jsx)(re,{contents:M.contents,documentRegistry:D?.jupyterLab.docRegistry}):"properties"===Je?(0,A.jsxs)(p.A,{as:"form",sx:{label:{marginTop:2}},children:[(0,A.jsxs)(v.A,{children:[(0,A.jsx)(v.A.Label,{children:"Name"}),(0,A.jsx)(b.A,{block:!0,value:Ke.name,onChange:e=>{Qe((t=>({...t,name:e.target.value})))}}),!1===He.name&&(0,A.jsx)(v.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,A.jsxs)(v.A,{children:[(0,A.jsx)(v.A.Label,{children:"Description"}),(0,A.jsx)(j.Ay,{block:!0,value:Ke.description,onChange:e=>{Qe((t=>({...t,description:e.target.value})))}}),!1===He.description&&(0,A.jsx)(v.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,A.jsx)(v.A,{children:(0,A.jsx)(g.Q,{variant:"primary",disabled:!He.name||!He.description,sx:{marginTop:2},onClick:ct,children:"Update Notebook Properties"})}),(0,A.jsx)(p.A,{mt:3}),(0,A.jsx)(_,{variant:"default",data:We,fileName:`notebook-${e}`,extension:"ipynb"}),(0,A.jsxs)(p.A,{sx:{marginTop:3},children:[(0,A.jsx)(y.A,{as:"h2",sx:{fontSize:4,fontWeight:"normal",color:"danger.fg",mb:2},children:"Danger zone"}),(0,A.jsxs)(p.A,{sx:{border:"1px solid",borderColor:"danger.emphasis",borderRadius:2,p:3,alignItems:"center",justifyContent:"space-between",gap:3},children:[(0,A.jsxs)(p.A,{sx:{display:"grid",gap:1},children:[(0,A.jsx)(k.A,{sx:{fontSize:1,fontWeight:"bold",color:"danger.fg"},children:"Confirm the notebook name to delete"}),(0,A.jsx)(v.A,{children:(0,A.jsx)(b.A,{block:!0,value:Ke.nameConfirm,onChange:e=>{Qe((t=>({...t,nameConfirm:e.target.value})))}})}),(0,A.jsx)(k.A,{sx:{fontSize:1,color:"fg.muted"},children:"This operation is not reversible."})]}),(0,A.jsx)(g.Q,{variant:"danger",disabled:!He.nameConfirm,onClick:async()=>{Ce("Deleting the notebook..."),$e(Oe.id).then((e=>{e.success&&(oe("The notebook is successfully deleted.",{variant:"success"}),S("/my-library"))})).finally((()=>{fe()}))},children:"Delete notebook"})]})]})]}):(0,A.jsx)(A.Fragment,{})})]})]})}const at=nt,st=["var(--jp-collaborator-color1)","var(--jp-collaborator-color2)","var(--jp-collaborator-color3)","var(--jp-collaborator-color4)","var(--jp-collaborator-color5)","var(--jp-collaborator-color6)","var(--jp-collaborator-color7)"],rt=()=>st[Math.floor(Math.random()*st.length)]}}]);