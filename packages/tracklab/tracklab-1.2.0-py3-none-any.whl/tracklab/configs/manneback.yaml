# TrackLab config

# The defaults list contains the files that will be used
# to create the final config file. This item *must* be
# the first element in the file.
defaults:
  - datasets:
    - mot17
#    - dancetrack
#    - bee24
#    - sportsmot
#    - posetrack21
#    - mot20
  - eval: trackeval
  - engine: offline
  - state: no_save
  - visualization: no_vis
  - modules/bbox_detector: yolox
  - modules/pose_topdown: rtmpose
  - modules/reid: fastreid
  - modules/track: dd_sort
  - _self_

dataset: ${datasets.mot17}
datasets:
  bee24:
    eval_set: test
  mot17:
    eval_set: test
#    nframes: 50
#    nvid: -1
  dancetrack:
    eval_set: val
#    nvid: 1
    nframes: 100
    vids_dict:
      train: []
      test: []
      val: [] # dancetrack0065, dancetrack0004, dancetrack0010, dancetrack0010, dancetrack0018, dancetrack0097]
#    nvid: 2
#  sportmot:
#    vids_dict:
#      val: [ v_00HRwkvvjtQ_c001, v_00HRwkvvjtQ_c003 ]

# Pipeline definition :
# - Defines the order in which the modules will be called
# - If loading a tracking state from disk, remove modules whose outputs are already provided in the loaded state
# Use 'pipeline: []' for an empty pipeline
pipeline:
#  - bbox_detector
#  - pose_topdown
  - reid
#  - track

# Experiment name
experiment_name: "bee24"

# Path definitions
data_dir: "/globalscratch/ucl/elen/bstandae/shared_datasets"
model_dir: "/globalscratch/ucl/elen/vjoosdtb/reconAIssance/pretrained_models"



#  set_split_idxs:
#    train: 1
n_swap: "???"
modules:
  track:
    training_enabled: True
    train_cfg:
      evaluate_only: False
#    override_cfg:
#      transformer_cfg:
#        _target_: dd_sort.Identity
#      tokenizers_cfg:
#        app_encoder:
#          _enabled_: False
    datamodule:
      multi_dataset_training: null
#    checkpoint_path: /home/ucl/elen/vjoosdtb/global/pretrained_models_bapt/simformer/dancetrack/best_on_val/SimFormer/last.ckpt
#    override_cfg:
#      checkpoint_path: /home/ucl/elen/vjoosdtb/global/pretrained_models_bapt/simformer/dancetrack/combined/best_train/SimFormer/last.ckpt
#    checkpoint_path: /home/ucl/elen/vjoosdtb/global/reconAIssance/pretrained_models/simformer/simformer_53290713_SportsMOT_87.913HOTA_thresh_0.75_Encoder.ckpt
#    datamodule:
#      name: ddsort-kpr-dancetrack
#      path: /globalscratch/ucl/elen/bstandae/shared_datasets/DanceTrack/states/simformer_training4 # absolute path, otherwise it will be created for each job
#      tracker_states:
#        train: /globalscratch/ucl/elen/bstandae/shared_datasets/DanceTrack/states/kpr/train-my_det-hrnetposetrack18-kpr-ocsort.pklz
#        val: /globalscratch/ucl/elen/bstandae/shared_datasets/DanceTrack/states/kpr/val-my_det-hrnetposetrack18-kpr-ocsort.pklz
#        test: /globalscratch/ucl/elen/bstandae/shared_datasets/DanceTrack/states/kpr/test-my_det-hrnetposetrack18-kpr-ocsort.pklz


state:
#  load_file: null
#  load_file: /home/ucl/elen/vjoosdtb/global/outputs/tracklab/2024-10-10/10-07-55/state.pklz
#  load_file: ${dataset.dataset_path}/states/${dataset.eval_set}-yolox-ocsort.pklz # BEE24
  save_file: ${dataset.dataset_path}/states/${dataset.eval_set}-yolox-ghost.pklz # ${dataset.dataset_path}/states/${dataset.eval_set}-yolox-AGW-cache2.pklz # BEE24
#  load_file: ${dataset.dataset_path}/states/kpr/${dataset.eval_set}-my_det-hrnetposetrack18-kpr-ocsort2.pklz # dancetrack
#  load_file: ${dataset.dataset_path}/states/kpr/${dataset.eval_set}-diffmot_yolox_x-hrnetposetrack18-kpr-ocsort-occ-marker.pklz # sportsmot
#  load_file: ${dataset.dataset_path}/states/kpr/${dataset.eval_set}-publicyoloxdets-hrnetposetrack18-kpr-ocsort.pklz
#  load_file: ${dataset.dataset_path}/states/motip/${dataset.eval_set}-r50_deformable_detr_motip_trainval_joint_ch.pklz
#  save_file: tracker_state.pklz
#  save_file: ${dataset.dataset_path}/states/${dataset.eval_set}-publicyoloxdets-hrnetposetrack18-kpr-ocsort2.pklz


#dataset:
#  set_split_idxs:
#    train: 1
# Machine configuration
num_cores: 1
use_wandb: False
use_rich: True

# Flags
test_tracking: True
print_config: False
eval_tracking: True

# configure Hydra to use the current working directory
# and set up the output directory according to experiment_name
project_dir: "${hydra:runtime.cwd}"
hydra:
  job:
    chdir: True
  run:
    dir: "/globalscratch/ucl/elen/vjoosdtb/outputs/${experiment_name}/${now:%Y-%m-%d}/${now:%H-%M-%S}"
  sweep:
    dir: "/globalscratch/ucl/elen/vjoosdtb/multirun_outputs/${experiment_name}/${now:%Y-%m-%d}/${now:%H-%M-%S}"
