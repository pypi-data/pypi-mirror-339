(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2423],{95372:function(e){e.exports=function(e,t,s,n){for(var i=e.length,r=s+(n?1:-1);n?r--:++r<i;)if(t(e[r],r,e))return r;return -1}},56632:function(e,t,s){var n=s(89278),i=s(80068),r=s(50098);e.exports=function(e){return function(t,s,o){var a=Object(t);if(!i(t)){var l=n(s,3);t=r(t),s=function(e){return l(a[e],e,a)}}var d=e(t,s,o);return d>-1?a[l?t[d]:d]:void 0}}},64925:function(e,t,s){var n=s(56632)(s(66259));e.exports=n},66259:function(e,t,s){var n=s(95372),i=s(89278),r=s(47991),o=Math.max;e.exports=function(e,t,s){var a=null==e?0:e.length;if(!a)return -1;var l=null==s?0:r(s);return l<0&&(l=o(a+l,0)),n(e,i(t,3),l)}},94919:function(e,t,s){var n=s(91936),i=1/0;e.exports=function(e){return e?(e=n(e))===i||e===-i?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}},47991:function(e,t,s){var n=s(94919);e.exports=function(e){var t=n(e),s=t%1;return t==t?s?t-s:t:0}},86850:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]",function(){return s(56856)}])},34929:function(e,t,s){"use strict";var n=s(24246),i=s(64925),r=s.n(i),o=s(27378),a=s(16134),l=s(30002),d=s(28079),c=s(57072);let u=()=>{let{isLoading:e}=(0,d.fd)(),t=(0,a.C)(d.U3),{isLoading:s}=(0,c.MO)(),n=(0,a.C)(c.qb),{isLoading:i}=(0,l.te)();return{dataUses:t,dataSubjects:(0,a.C)(l.ZL),dataCategories:n,isLoading:e||s||i}};t.Z=()=>{let{dataUses:e,dataCategories:t,dataSubjects:s,isLoading:i}=u(),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.split(".").slice(0,t).join(".")},l=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=t(e);if(!n)return{};let i=t(a(e,s)),r=!!n.parent_key;return{name:n.name||void 0,primaryName:r&&(null==i?void 0:i.name)!==n.name&&(null==i?void 0:i.name)||void 0}},d=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,{name:i,primaryName:r}=l(e,t,s);return i?r?(0,n.jsxs)(o.Fragment,{children:[(0,n.jsxs)("strong",{children:[r,":"]})," ",i]},e):(0,n.jsx)("strong",{children:i},e):e},c=t=>r()(e,{fides_key:t}),g=e=>r()(t,{fides_key:e}),m=e=>r()(s,{fides_key:e});return{getDataUses:()=>e,getDataUseByKey:c,getDataUseDisplayName:e=>d(e,c,1),getDataUseDisplayNameProps:e=>l(e,c,1),getDataCategories:()=>t,getDataCategoryByKey:g,getDataCategoryDisplayName:e=>d(e,g,2),getDataCategoryDisplayNameProps:e=>l(e,g,2),getDataSubjects:()=>s,getDataSubjectByKey:m,getDataSubjectDisplayName:e=>{let t=m(e);return t?t.name:e},getPrimaryKey:a,isLoading:i}}},37059:function(e,t,s){"use strict";s.d(t,{Ak:function(){return m},EY:function(){return c},Ud:function(){return r},Vr:function(){return v},WJ:function(){return a},nP:function(){return d},nS:function(){return u},rs:function(){return l},sX:function(){return g},wi:function(){return o}});var n=s(78780),i=s(16394);let{useGetAggregateMonitorResultsQuery:r,useGetDiscoveredSystemAggregateQuery:o,useGetDiscoveredAssetsQuery:a,useAddMonitorResultSystemsMutation:l,useIgnoreMonitorResultSystemsMutation:d,useAddMonitorResultAssetsMutation:c,useIgnoreMonitorResultAssetsMutation:u,useUpdateAssetsSystemMutation:g,useUpdateAssetsDataUseMutation:m,useUpdateAssetsMutation:v}=n.u.injectEndpoints({endpoints:e=>({getAggregateMonitorResults:e.query({query:e=>{let{page:t=1,size:s=20,search:n}=e;return{url:"/plus/discovery-monitor/aggregate-results",params:{page:t,size:s,search:n,diff_status:"addition"}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredSystemAggregate:e.query({query:e=>{let{key:t,page:s=1,size:n=20,search:i}=e;return{url:"/plus/discovery-monitor/system-aggregate-results",params:{monitor_config_id:t,page:s,size:n,search:i,diff_status:"addition"}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredAssets:e.query({query:e=>{let{key:t,system:s,page:n=1,size:i=20,search:r,diff_status:o}=e;return{url:"/plus/discovery-monitor/".concat(t,"/results"),params:{resolved_system_id:s,page:n,size:i,search:r,diff_status:o,sort_by:"urn"}}},providesTags:()=>["Discovery Monitor Results"]}),addMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,i.du)(s,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/promote?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,i.du)(s,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/mute?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),addMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/promote?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/mute?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),updateAssetsSystem:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_system_key:e.systemKey}))}),invalidatesTags:["Discovery Monitor Results","System Assets"]}),updateAssetsDataUse:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_data_uses:e.dataUses}))}),invalidatesTags:["Discovery Monitor Results"]}),updateAssets:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.assets}),invalidatesTags:["Discovery Monitor Results"]})})})},78238:function(e,t,s){"use strict";s.d(t,{g:function(){return n}});let n=["essential","functional.service.improve","personalize","analytics","marketing.advertising.first_party.targeted","marketing.advertising.third_party.targeted"];t.Z=e=>n.includes(e)},56856:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return R}});var n=s(24246),i=s(86677),r=s(35287),o=s(77830),a=s(58754),l=s(59003),d=s(92222),c=s(77181),u=s(27378),g=s(812),m=s(14047),v=s(14481),y=s(37059),h=s(31883),f=s(57454),p=s(34929),_=s(72625),x=s(78238),j=e=>{var t,s;let{system:i}=e,{getDataUseDisplayName:r}=(0,p.Z)(),o=(null!==(s=null===(t=i.data_uses)||void 0===t?void 0:t.filter(e=>(0,x.Z)(e)))&&void 0!==s?s:[]).map(e=>({label:r(e),key:e}));return(0,n.jsx)(_.mb,{values:o})};let b=e=>{let{monitorId:t,system:s}=e,[i,{isLoading:r}]=(0,y.rs)(),[a,{isLoading:l}]=(0,y.nP)(),{successAlert:d,errorAlert:u}=(0,m.V)(),v=r||l,{id:h,name:f,system_key:p,total_updates:_}=s,x=async()=>{let e=await i({monitor_config_key:t,resolved_system_ids:[h]});(0,g.D4)(e)?u((0,g.e$)(e.error)):d(p?"".concat(_," assets from ").concat(f," have been added to the system inventory."):"".concat(f," and ").concat(_," assets have been added to the system inventory. ").concat(f," is now configured for consent."),"Confirmed")},j=async()=>{let e=await a({monitor_config_key:t,resolved_system_ids:[h||o.Kl]});(0,g.D4)(e)?u((0,g.e$)(e.error)):d(f?"".concat(_," assets from ").concat(f," have been ignored and will not appear in future scans."):"".concat(_," uncategorized assets have been ignored and will not appear in future scans."),"Confirmed")};return(0,n.jsxs)(c.vyj,{children:[(0,n.jsx)(c.esZ,{title:s.id?void 0:"These assets must be categorized before you can add them to the inventory.",children:(0,n.jsx)(c.wpx,{"data-testid":"add-btn",size:"small",onClick:x,disabled:!s.id||v,loading:r,children:"Add"})}),(0,n.jsx)(c.wpx,{"data-testid":"ignore-btn",size:"small",onClick:j,disabled:v,loading:l,children:"Ignore"})]})};var w=s(56839);let k=e=>{let{system:t}=e;return(0,n.jsxs)(c.kCb,{alignItems:"center",height:"100%",children:[!(null==t?void 0:t.system_key)&&(0,n.jsx)(c.ua7,{label:"New system",children:(0,n.jsx)("span",{children:w.QL.Change})}),(0,n.jsx)(c.xvT,{fontSize:"xs",fontWeight:"semibold",lineHeight:4,overflow:"hidden",textOverflow:"ellipsis",children:(null==t?void 0:t.name)||"Uncategorized assets"})]})},C=e=>{let t=(0,d.Cl)();return{columns:[t.display({id:"select",cell:e=>{let{row:t}=e;return(0,n.jsx)(v.k,{isChecked:t.getIsSelected(),onChange:t.getToggleSelectedHandler(),dataTestId:"select-".concat(t.original.name||t.id)})},header:e=>{let{table:t}=e;return(0,n.jsx)(v.k,{isChecked:t.getIsAllPageRowsSelected(),isIndeterminate:t.getIsSomeRowsSelected(),onChange:t.getToggleAllRowsSelectedHandler(),dataTestId:"select-all-rows"})},maxSize:40,meta:{disableRowClick:!0}}),t.accessor(e=>e.name,{id:"system_name",cell:e=>(0,n.jsx)(k,{system:e.row.original}),header:"System",size:300}),t.accessor(e=>e.total_updates,{id:"total_updates",cell:e=>(0,n.jsx)(v.G3,{value:e.getValue()}),header:"Assets",size:80}),t.display({id:"data_use",cell:e=>(0,n.jsx)(j,{system:e.row.original}),header:"Categories of consent",size:400,meta:{disableRowClick:!0}}),t.accessor(e=>e.locations,{id:"locations",cell:e=>(0,n.jsx)(v.G3,{value:e.getValue().length>1?"".concat(e.getValue().length," locations"):e.getValue()[0]}),header:"Locations"}),t.accessor(e=>e.domains,{id:"domains",cell:e=>(0,n.jsx)(v.G3,{value:e.getValue().length>1?"".concat(e.getValue().length," domains"):e.getValue()[0]}),header:"Domains"}),t.display({id:"actions",cell:t=>(0,n.jsx)(b,{system:t.row.original,monitorId:e}),header:"Actions",meta:{disableRowClick:!0}})]}},D=e=>{let{monitorId:t}=e,s=(0,i.useRouter)(),{PAGE_SIZES:r,pageSize:a,setPageSize:p,onPreviousPageClick:_,isPreviousPageDisabled:x,onNextPageClick:j,isNextPageDisabled:b,startRange:w,endRange:k,pageIndex:D,setTotalPages:R,resetPageIndexToDefault:S}=(0,v.oi)(),[P,{isLoading:T}]=(0,y.rs)(),[A,{isLoading:M}]=(0,y.nP)(),{successAlert:I,errorAlert:z}=(0,m.V)(),[L,N]=(0,u.useState)(""),[q,E]=(0,u.useState)({});(0,u.useEffect)(()=>{S()},[t,L,S]);let{data:U,isLoading:V,isFetching:Z}=(0,y.wi)({key:t,page:D,size:a,search:L});(0,u.useEffect)(()=>{U&&R(U.pages||1)},[U,R]);let{columns:O}=C(t),H=(0,l.b7)({getCoreRowModel:(0,d.sC)(),columns:O,manualPagination:!0,data:(null==U?void 0:U.items)||[],columnResizeMode:"onChange",onRowSelectionChange:E,state:{rowSelection:q}}),K=H.getSelectedRowModel().rows,$=K.some(e=>null===e.original.id);if(V)return(0,n.jsx)(v.I4,{rowHeight:36,numRows:36});let G=async()=>{let e=K.reduce((e,t)=>e+t.original.total_updates,0),s=await P({monitor_config_key:t,resolved_system_ids:K.map(e=>e.original.id)});(0,h.D4)(s)?z((0,g.e$)(s.error)):(I("".concat(e," assets have been added to the system inventory.")),E({}))},W=async()=>{let e=K.reduce((e,t)=>e+t.original.total_updates,0),s=await A({monitor_config_key:t,resolved_system_ids:K.map(e=>{var t;return null!==(t=e.original.id)&&void 0!==t?t:o.Kl})});(0,h.D4)(s)?z((0,g.e$)(s.error)):(I("".concat(e," assets have been ignored and will not appear in future scans.")),E({}))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Q$,{children:(0,n.jsxs)(c.kCb,{direction:"row",alignItems:"center",justifyContent:"space-between",width:"full",children:[(0,n.jsx)(c.kCb,{gap:6,align:"center",children:(0,n.jsx)(c.xuv,{flexShrink:0,children:(0,n.jsx)(f.M,{value:L,onChange:N})})}),(0,n.jsxs)(c.kCb,{align:"center",children:[!!K.length&&(0,n.jsx)(c.xvT,{fontSize:"xs",fontWeight:"semibold",minW:16,mr:6,"data-testid":"selected-count",children:"".concat(K.length," selected")}),(0,n.jsxs)(c.v2r,{children:[(0,n.jsx)(c.j2t,{as:c.wpx,icon:(0,n.jsx)(c.PJP._ME,{}),iconPosition:"end",loading:T||M,"data-testid":"bulk-actions-menu",disabled:!K.length,type:"primary",children:"Actions"}),(0,n.jsxs)(c.qyq,{children:[(0,n.jsx)(c.esZ,{title:$?"Uncategorized assets can't be added to the inventory":null,placement:"left",children:(0,n.jsx)(c.sNh,{fontSize:"small",onClick:G,"data-testid":"bulk-add",isDisabled:$,children:"Add"})}),(0,n.jsx)(c.sNh,{fontSize:"small",onClick:W,"data-testid":"bulk-ignore",children:"Ignore"})]})]})]})]})}),(0,n.jsx)(v.ZK,{tableInstance:H,onRowClick:e=>{var n;s.push("".concat(o.vi,"/").concat(t,"/").concat(null!==(n=e.id)&&void 0!==n?n:o.Kl))},emptyTableNotice:(0,n.jsx)(c.oj8,{image:c.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})}),(0,n.jsx)(v.s8,{totalRows:(null==U?void 0:U.total)||0,pageSizes:r,setPageSize:p,onPreviousPageClick:_,isPreviousPageDisabled:x||Z,onNextPageClick:j,isNextPageDisabled:b||Z,startRange:w,endRange:k})]})};var R=()=>{let e=decodeURIComponent((0,i.useRouter)().query.monitorId);return(0,n.jsxs)(r.Z,{title:"Action center - Discovered assets by system",children:[(0,n.jsx)(a.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:o.vi},{title:e}]}),(0,n.jsx)(D,{monitorId:e})]})}},31883:function(e,t,s){"use strict";s.d(t,{Bw:function(){return n.Bw},D4:function(){return n.D4}});var n=s(19043)}},function(e){e.O(0,[8033,6060,2858,2866,9278,4481,9999,2888,9774,179],function(){return e(e.s=86850)}),_N_E=e.O()}]);