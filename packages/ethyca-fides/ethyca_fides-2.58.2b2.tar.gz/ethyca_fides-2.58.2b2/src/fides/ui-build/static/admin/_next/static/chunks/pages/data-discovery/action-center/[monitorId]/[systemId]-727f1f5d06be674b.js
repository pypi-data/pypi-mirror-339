(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4154],{58095:function(e,t,s){var n=s(8817);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},21796:function(e){e.exports=function(e,t,s){for(var n=-1,a=null==e?0:e.length;++n<a;)if(s(t,e[n]))return!0;return!1}},8817:function(e,t,s){var n=s(95372),a=s(1129),i=s(58263);e.exports=function(e,t,s){return t==t?i(e,t,s):n(e,a,s)}},1129:function(e){e.exports=function(e){return e!=e}},92198:function(e,t,s){var n=s(52485),a=s(58095),i=s(21796),r=s(65581),o=s(47111),l=s(43735);e.exports=function(e,t,s){var d=-1,c=a,u=e.length,m=!0,h=[],v=h;if(s)m=!1,c=i;else if(u>=200){var g=t?null:o(e);if(g)return l(g);m=!1,c=r,v=new n}else v=t?[]:h;e:for(;++d<u;){var p=e[d],x=t?t(p):p;if(p=s||0!==p?p:0,m&&x==x){for(var f=v.length;f--;)if(v[f]===x)continue e;t&&v.push(x),h.push(p)}else c(v,x,s)||(v!==h&&v.push(x),h.push(p))}return h}},47111:function(e,t,s){var n=s(46151),a=s(50344),i=s(43735),r=n&&1/i(new n([,-0]))[1]==1/0?function(e){return new n(e)}:a;e.exports=r},58263:function(e){e.exports=function(e,t,s){for(var n=s-1,a=e.length;++n<a;)if(e[n]===t)return n;return -1}},50344:function(e){e.exports=function(){}},83766:function(e,t,s){var n=s(92198);e.exports=function(e){return e&&e.length?n(e):[]}},25654:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data-discovery/action-center/[monitorId]/[systemId]",function(){return s(45906)}])},66379:function(e,t,s){"use strict";var n=s(24246),a=s(77181),i=s(7617);t.Z=e=>{let{data:t,border:s="partial",borderWidth:r=2,...o}=e;return(0,n.jsx)(a.mQc,{colorScheme:"complimentary",...o,children:(0,n.jsx)(a.tdY,{width:"partial"===s?"max-content":void 0,borderBottomWidth:r,children:t.map(e=>(0,n.jsx)(i.q,{label:e.label,"data-testid":e.label,isDisabled:e.isDisabled,fontSize:o.fontSize},e.label))})})}},35287:function(e,t,s){"use strict";var n=s(24246),a=s(77181),i=s(88038),r=s.n(i);s(27378),t.Z=e=>{let{children:t,title:s,mainProps:i}=e;return(0,n.jsxs)(a.kCb,{"data-testid":s,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 240px)",children:[(0,n.jsxs)(r(),{children:[(0,n.jsxs)("title",{children:["Fides Admin UI - ",s]}),(0,n.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsx)(a.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...i,children:t})]})}},58754:function(e,t,s){"use strict";var n=s(24246),a=s(77181),i=s(70788);t.Z=e=>{let{heading:t,breadcrumbItems:s,isSticky:r=!0,children:o,rightContent:l,style:d,...c}=e;return(0,n.jsxs)("div",{...c,style:r?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...d}:{paddingBottom:"24px",...d},children:[(0,n.jsxs)(a.jqI,{justify:"space-between",children:["string"==typeof t?(0,n.jsx)(a.X6q,{className:s||o?"pb-4":void 0,fontSize:"2xl","data-testid":"page-heading",children:t}):t,l&&(0,n.jsx)("div",{"data-testid":"page-header-right-content",children:l})]}),!!s&&(0,n.jsx)(i.m,{className:o?"pb-4":void 0,items:s,"data-testid":"page-breadcrumb"}),o]})}},97181:function(e,t,s){"use strict";s.d(t,{d:function(){return d}});var n=s(24246),a=s(77181),i=s(34090),r=s(27378),o=s(91613),l=s(40324);let d=e=>{let{name:t,label:s,labelProps:d,tooltip:c,isRequired:u,layout:m="inline",...h}=e,[v,g,{setValue:p}]=(0,i.U$)(t),x=!!(g.touched&&g.error),[f,y]=(0,r.useState)("");v.value||"tags"!==h.mode&&"multiple"!==h.mode||(v.value=[]),"tags"===h.mode&&"string"==typeof v.value&&(v.value=[v.value]);let j="tags"===h.mode?(e,t)=>e?e.value!==f||v.value.includes(f)?h.optionRender?h.optionRender(e,t):e.label:'Create "'.concat(f,'"'):void 0:h.optionRender||void 0,b=e=>{y(e),h.onSearch&&h.onSearch(e)},C=(e,t)=>{p(e),h.onChange&&h.onChange(e,t)};return"inline"===m?(0,n.jsx)(a.NIc,{isInvalid:x,isRequired:u,children:(0,n.jsxs)(a.rjZ,{templateColumns:s?"1fr 3fr":"1fr",children:[s?(0,n.jsx)(l.__,{htmlFor:h.id||t,...d,children:s}):null,(0,n.jsxs)(a.jqI,{align:"center",children:[(0,n.jsxs)(a.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,n.jsx)(a.WPr,{...v,id:h.id||t,"data-testid":"controlled-select-".concat(v.name),...h,optionRender:j,onSearch:"tags"===h.mode?b:void 0,onChange:C,value:v.value||void 0,status:x?"error":void 0}),(0,n.jsx)(l.Bc,{isInvalid:x,message:g.error,fieldName:v.name})]}),c?(0,n.jsx)(o.Z,{label:c}):null]})]})}):(0,n.jsx)(a.NIc,{isInvalid:x,isRequired:u,children:(0,n.jsxs)(a.gCW,{alignItems:"start",children:[(0,n.jsxs)(a.jqI,{align:"center",children:[s?(0,n.jsx)(l.__,{htmlFor:h.id||t,fontSize:"xs",my:0,mr:1,...d,children:s}):null,c?(0,n.jsx)(o.Z,{label:c}):null]}),(0,n.jsx)(a.WPr,{...v,id:h.id||t,"data-testid":"controlled-select-".concat(v.name),...h,optionRender:j,onSearch:"tags"===h.mode?b:void 0,onChange:C,value:v.value||void 0,status:x?"error":void 0}),(0,n.jsx)(l.Bc,{isInvalid:x,message:g.error,fieldName:v.name})]})})}},14047:function(e,t,s){"use strict";s.d(t,{H:function(){return i},V:function(){return n.V}});var n=s(84306),a=s(812);let i=()=>{let{errorAlert:e}=(0,n.V)();return{handleError:t=>{let s="An unexpected error occurred. Please try again.";(0,a.Ot)(t)?s=t.data.detail:(0,a.tB)(t)&&(s=t.data.detail[0].msg),e(s)}}}},84306:function(e,t,s){"use strict";s.d(t,{V:function(){return i}});var n=s(24246),a=s(77181);let i=()=>{let e=(0,a.pmc)();return{errorAlert:(t,s,i)=>{let r={...i,position:(null==i?void 0:i.position)||"top",render:e=>{let{onClose:i}=e;return(0,n.jsxs)(a.bZj,{alignItems:"normal",status:"error","data-testid":"error-alert",children:[(0,n.jsx)(a.zMQ,{}),(0,n.jsxs)(a.xuv,{children:[s&&(0,n.jsx)(a.CdC,{children:s}),(0,n.jsx)(a.XaZ,{children:t})]}),(0,n.jsx)(a.PZ7,{onClick:i,position:"relative",right:0,size:"sm",top:-1})]})}};(null==i?void 0:i.id)&&e.isActive(i.id)?e.update(i.id,r):e(r)},successAlert:(t,s,i)=>{let r={...i,position:(null==i?void 0:i.position)||"top",render:e=>{let{onClose:i}=e;return(0,n.jsxs)(a.bZj,{alignItems:"normal",status:"success",variant:"subtle","data-testid":"success-alert",children:[(0,n.jsx)(a.zMQ,{}),(0,n.jsxs)(a.xuv,{children:[s&&(0,n.jsx)(a.CdC,{children:s}),(0,n.jsx)(a.XaZ,{children:t})]}),(0,n.jsx)(a.PZ7,{onClick:i,position:"relative",right:0,size:"sm",top:-1})]})}};(null==i?void 0:i.id)&&e.isActive(i.id)?e.update(i.id,r):e(r)}}}},45938:function(e,t,s){"use strict";s.d(t,{Gt:function(){return m},eB:function(){return h},oI:function(){return u}});var n=s(24246),a=s(34090),i=s(27378),r=s(16134),o=s(38602),l=s(58452);let d=(0,i.createRef)(),c=(0,i.createRef)(),u=()=>{let e=(0,r.T)(),t=(0,r.C)(o.DB),s=(0,i.useCallback)(()=>{c.current=void 0,d.current=void 0},[]),n=(0,i.useCallback)(()=>{e((0,o.Mr)()),c.current&&(c.current(!0),s())},[e,s]),a=(0,i.useCallback)(()=>{e((0,o.Mr)()),c.current&&(c.current(!1),s())},[e,s]);return{attemptAction:(0,i.useCallback)(()=>t?(e((0,o.h7)()),d.current||(d.current=new Promise(e=>{c.current=e})),d.current):Promise.resolve(!0),[t,e]),onConfirm:n,onClose:a}},m=e=>{let{id:t,name:s}=e,{dirty:n}=(0,a.u6)(),l=(0,r.T)();return(0,i.useEffect)(()=>(l((0,o.Zu)({id:t,name:s})),()=>{l((0,o.dz)({id:t}))}),[l,t,s]),(0,i.useEffect)(()=>{l((0,o.$p)({id:t,isDirty:n}))},[n,l,t]),null},h=()=>{let{onConfirm:e,onClose:t}=u(),s=(0,r.C)(o.uv);return(0,n.jsx)(l.Z,{isOpen:s,onClose:t,onConfirm:e,isCentered:!0,title:"Unsaved Changes",message:"You have unsaved changes"})}},8133:function(e,t,s){"use strict";var n=s(24246),a=s(77181);t.Z=e=>{let{title:t,children:s,isOpen:i,onClose:r,...o}=e;return(0,n.jsxs)(a.u_l,{isOpen:i,onClose:r,isCentered:!0,scrollBehavior:"inside",size:"xl",id:"add-modal",...o,children:[(0,n.jsx)(a.ZAr,{}),(0,n.jsxs)(a.hzk,{textAlign:"left",p:0,"data-testid":"add-modal-content",children:[(0,n.jsx)(a.xBx,{p:0,children:(0,n.jsx)(a.xuv,{backgroundColor:"gray.50",px:6,py:4,border:"1px",borderColor:"gray.200",borderTopRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center",children:(0,n.jsx)(a.X6q,{as:"h3",size:"sm",children:t})})}),(0,n.jsx)(a.fef,{pb:4,overflow:"auto",children:s})]})]})}},70788:function(e,t,s){"use strict";s.d(t,{m:function(){return d}});var n=s(24246),a=s(77181),i=s(79894),r=s.n(i),o=s(27378);let{Text:l}=a.AntTypography,d=e=>{let{items:t,...s}=e,i=(0,o.useMemo)(()=>null==t?void 0:t.map((e,s)=>{let i=s===t.length-1,o={...e},d=o.onClick&&!o.href;return("string"==typeof o.title&&(o.title=(0,n.jsx)(l,{style:{color:"inherit",maxWidth:i?void 0:400},ellipsis:!i,children:o.title})),d)?o.title=(0,n.jsx)(a.wpx,{type:"text",size:"small",icon:o.icon,onClick:o.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:o.title}):(o.icon&&(o.title=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"anticon align-text-bottom",children:o.icon}),o.title]})),o.href&&o.title&&(o.title=(0,n.jsx)(r(),{href:o.href,className:"ant-breadcrumb-link",children:o.title}),delete o.href)),o}),[t]);return(0,n.jsx)(a.zrq,{items:i,...s})}},37059:function(e,t,s){"use strict";s.d(t,{Ak:function(){return h},EY:function(){return c},Ud:function(){return i},Vr:function(){return v},WJ:function(){return o},nP:function(){return d},nS:function(){return u},rs:function(){return l},sX:function(){return m},wi:function(){return r}});var n=s(78780),a=s(16394);let{useGetAggregateMonitorResultsQuery:i,useGetDiscoveredSystemAggregateQuery:r,useGetDiscoveredAssetsQuery:o,useAddMonitorResultSystemsMutation:l,useIgnoreMonitorResultSystemsMutation:d,useAddMonitorResultAssetsMutation:c,useIgnoreMonitorResultAssetsMutation:u,useUpdateAssetsSystemMutation:m,useUpdateAssetsDataUseMutation:h,useUpdateAssetsMutation:v}=n.u.injectEndpoints({endpoints:e=>({getAggregateMonitorResults:e.query({query:e=>{let{page:t=1,size:s=20,search:n}=e;return{url:"/plus/discovery-monitor/aggregate-results",params:{page:t,size:s,search:n,diff_status:"addition"}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredSystemAggregate:e.query({query:e=>{let{key:t,page:s=1,size:n=20,search:a}=e;return{url:"/plus/discovery-monitor/system-aggregate-results",params:{monitor_config_id:t,page:s,size:n,search:a,diff_status:"addition"}}},providesTags:["Discovery Monitor Results"]}),getDiscoveredAssets:e.query({query:e=>{let{key:t,system:s,page:n=1,size:a=20,search:i,diff_status:r}=e;return{url:"/plus/discovery-monitor/".concat(t,"/results"),params:{resolved_system_id:s,page:n,size:a,search:i,diff_status:r,sort_by:"urn"}}},providesTags:()=>["Discovery Monitor Results"]}),addMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,a.du)(s,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/promote?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultSystems:e.mutation({query:e=>{let{monitor_config_key:t,resolved_system_ids:s}=e,n=(0,a.du)(s,"resolved_system_ids");return{method:"POST",url:"/plus/discovery-monitor/".concat(t,"/mute?").concat(n)}},invalidatesTags:["Discovery Monitor Results"]}),addMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/promote?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),ignoreMonitorResultAssets:e.mutation({query:e=>{var t;let s=new URLSearchParams;return null===(t=e.urnList)||void 0===t||t.forEach(e=>s.append("staged_resource_urns",e)),{method:"POST",url:"/plus/discovery-monitor/mute?".concat(s)}},invalidatesTags:["Discovery Monitor Results"]}),updateAssetsSystem:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_system_key:e.systemKey}))}),invalidatesTags:["Discovery Monitor Results","System Assets"]}),updateAssetsDataUse:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.urnList.map(t=>({urn:t,user_assigned_data_uses:e.dataUses}))}),invalidatesTags:["Discovery Monitor Results"]}),updateAssets:e.mutation({query:e=>({method:"PATCH",url:"/plus/discovery-monitor/".concat(e.monitorId,"/results"),body:e.assets}),invalidatesTags:["Discovery Monitor Results"]})})})},33335:function(e,t,s){"use strict";s.d(t,{E:function(){return n}});let n=e=>e.toLowerCase().replace(/ /g,"_").replace(/[^a-zA-Z0-9._<>-]/g,"")},36345:function(e,t,s){"use strict";s.d(t,{Z:function(){return p}});var n=s(24246),a=s(77181),i=s(34090),r=s(27378),o=s(16134),l=s(40324);let d=(0,a.IUT)({displayName:"CompassIcon",viewBox:"0 0 512 512",path:(0,n.jsx)("path",{fill:"currentColor",d:"M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm306.7 69.1L162.4 380.6c-19.4 7.5-38.5-11.6-31-31l55.5-144.3c3.3-8.5 9.9-15.1 18.4-18.4l144.3-55.5c19.4-7.5 38.5 11.6 31 31L325.1 306.7c-3.2 8.5-9.9 15.1-18.4 18.4zM288 256a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"})});var c=s(91613),u=s(57865);let{Text:m}=a.AntTypography,h=e=>{let{searchText:t,suggestion:s,...a}=e;return t&&s?(0,n.jsxs)(m,{"aria-hidden":!0,style:{pointerEvents:"none",position:"absolute",zIndex:10,top:"var(--ant-line-width)",bottom:"var(--ant-line-width)",left:"var(--ant-padding-sm)",lineHeight:"calc(var(--ant-control-height) - var(--ant-line-width))"},...a,children:[(0,n.jsx)(m,{className:"text-transparent",children:t}),(0,n.jsx)(m,{type:"secondary",children:s.substring(t.length)})]}):null},v="Create new system",g=e=>{let{active:t,disabled:s,onRefreshSuggestions:i}=e,r={bg:t?"complimentary.500":"gray.100"};return(0,n.jsxs)(a.gCW,{children:[(0,n.jsx)(a.LZC,{minHeight:"18px"}),(0,n.jsxs)(a.v2r,{children:[(0,n.jsx)(a.j2t,{as:a.hU,size:"sm",isDisabled:s,icon:(0,n.jsx)(d,{color:t?"white":"gray.700",boxSize:4}),"aria-label":"Update information from Compass","data-testid":"refresh-suggestions-btn",_hover:{_disabled:r},...r}),(0,n.jsx)(a.qyq,{children:(0,n.jsx)(a.sNh,{onClick:i,children:(0,n.jsx)(a.xvT,{fontSize:"xs",lineHeight:4,children:"Reset to Compass defaults"})})})]})]})};var p=e=>{var t,s;let{label:d,isCreate:m,lockedForGVL:p,options:x,isLoading:f,onVendorSelected:y}=e,j=(0,o.C)(u.bN),[b,C,{setValue:_}]=(0,i.U$)("name"),w=!!(C.touched&&C.error),S={...b,value:null!==(t=b.value)&&void 0!==t?t:""},{touched:I,values:R,setTouched:k,setFieldValue:T,validateForm:A}=(0,i.u6)(),[D,P]=(0,r.useState)(!0),N=null!==(s=x.find(e=>e.value===S.value))&&void 0!==s?s:{label:S.value,value:S.value,description:""},z=(e,t)=>!!(null==t?void 0:t.label.toLowerCase().startsWith(e.toLowerCase())),[E,L]=(0,r.useState)(""),q=(0,r.useMemo)(()=>x.filter(e=>z(E,e)),[x,E]),M=(0,r.useMemo)(()=>{let e=x;return m&&E&&(e=[...x,{label:"".concat(v,' "').concat(E,'"...'),value:E}]),e},[m,x,E]),Z=!!E&&q.length>0,O=p&&!m;(0,r.useEffect)(()=>{P(!S.value&&!R.vendor_id)},[S.value,R.vendor_id,P]),(0,r.useEffect)(()=>{A()},[D,A]);let U=async()=>{L(""),T("vendor_id",void 0),await _(""),k({...I,vendor_id:!1,name:!1}),y(void 0)},B=async e=>{if(e){let t=x.some(t=>t.value===e.value)?e.value:void 0;T("vendor_id",t),await _(e.label.startsWith(v)?e.value:e.label),k({...I,vendor_id:!0,name:!0}),y(t)}},V=async e=>{S.onBlur(e),E&&await _(E),k({...I,name:!0})},W=async e=>{q.length>0&&E!==q[0].label?(e.preventDefault(),L(q[0].label),T("vendor_id",q[0].value),await _(q[0].label),y(q[0].value)):(T("vendor_id",void 0),await _(E)),k({...I,name:!0})},$=(0,n.jsx)(a.NIc,{isInvalid:w,isRequired:!0,width:"100%",children:(0,n.jsxs)(a.gCW,{alignItems:"start",position:"relative",width:"100%",children:[(0,n.jsxs)(a.Ugi,{spacing:1,children:[(0,n.jsx)(l.__,{htmlFor:"vendorName",fontSize:"xs",my:0,mr:1,children:d}),(0,n.jsx)(c.Z,{label:"Enter the system name"})]}),(0,n.jsxs)(a.xuv,{width:"100%",className:"relative",children:[(0,n.jsx)(a.WPr,{id:"vendorName",labelInValue:!0,autoFocus:!0,allowClear:!0,options:M,loading:f,filterOption:(e,t)=>z(e,t)||!!(null==t?void 0:t.label.startsWith(v)),optionFilterProp:"label",value:N,placeholder:"Enter system name...",disabled:O,onChange:B,onSearch:L,onClear:U,onBlur:V,onInputKeyDown:e=>{E&&"Tab"===e.key&&W(e)},status:w?"error":void 0,"data-testid":"vendor-name-select"}),(0,n.jsx)(h,{searchText:E,suggestion:q.length?q[0].label:""})]}),(0,n.jsx)(l.Bc,{isInvalid:w,message:C.error,fieldName:"name"})]})});return(0,n.jsxs)(a.Ugi,{alignItems:"flex-start",width:"full",children:[D?$:(0,n.jsx)(l.j0,{autoFocus:!0,id:"name",name:"name",label:"System name",tooltip:"Enter the system name",variant:"stacked",disabled:O,isRequired:!0,inputRightElement:O?null:(0,n.jsx)(a.PZ7,{onClick:U,size:"sm","data-testid":"clear-btn"})}),(0,n.jsx)(g,{active:!!R.vendor_id||Z,disabled:!R.vendor_id||"showing"===j,onRefreshSuggestions:()=>y(R.vendor_id)})]})}},45906:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return F}});var n=s(24246),a=s(86677),i=s(27378),r=s(35287),o=s(77830),l=s(58754),d=s(59003),c=s(92222),u=s(77181),m=s(83766),h=s.n(m),v=s(66379),g=s(812),p=s(14047),x=s(14481),f=s(37059),y=s(8133),j=s(70682);let{Text:b}=u.AntTypography;var C=e=>{let{onSave:t,isSaving:s,onClose:a,...r}=e,[o,l]=(0,i.useState)([]),d=()=>{l([]),a()};return(0,n.jsxs)(y.Z,{title:"Add consent category",...r,onClose:d,children:[(0,n.jsxs)(u.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(b,{children:"Assign consent categories to selected assets. This configures the system for consent management. Consent categories apply to both individual assets and the system."}),(0,n.jsx)(j.Z,{mode:"tags",selectedTaxonomies:o,onSelect:(e,t)=>l([...o,t.value]),variant:"outlined"})]}),(0,n.jsxs)(u.jqI,{justify:"space-between",children:[(0,n.jsx)(u.wpx,{htmlType:"reset",onClick:d,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(u.wpx,{htmlType:"submit",type:"primary",disabled:!o.length,loading:s,onClick:()=>{t(o),d()},"data-testid":"save-btn",children:"Save"})]})]})},_=s(28120);let w={ATTENTION_REQUIRED:{index:0,hash:"#attention-required"},RECENT_ACTIVITY:{index:1,hash:"#recent-activity"},IGNORED:{index:2,hash:"#ignored"}},S=e=>{let t=e.startsWith("#")?e:"#".concat(e);return Object.values(w).find(e=>e.hash===t)},I=e=>Object.values(w).find(t=>t.index===e);var R=e=>{let{systemId:t}=e,s=(0,a.useRouter)(),[n,r]=(0,i.useState)((()=>{var e;let t=s.asPath.split("#")[1];return t?null===(e=S(t))||void 0===e?void 0:e.index:w.ATTENTION_REQUIRED.index})()),o=(0,i.useCallback)(async e=>{if(r(e),s.isReady){let t=I(e);if(t){let e={...s.query};await s.replace({pathname:s.pathname,query:e,hash:t.hash},void 0,{shallow:!0})}}},[s]),l=[{label:"Attention required",params:{diff_status:[_.LL.ADDITION],system:t}},{label:"Recent activity",params:{diff_status:[_.LL.MONITORED]}},{label:"Ignored",params:{diff_status:[_.LL.MUTED],system:t}}];return{filterTabs:l,filterTabIndex:n,onTabChange:o,activeParams:l[n].params}},k=s(57454),T=s(29850),A=s(77685);let{Text:D}=u.AntTypography,P=e=>{let{onSave:t,isSaving:s,...a}=e,[r,o]=(0,i.useState)(),[l,d]=(0,i.useState)(!1),c=(0,i.useCallback)(e=>{e.preventDefault(),d(!0)},[]),m=()=>{d(!1)},h=()=>{o(void 0),a.onClose()};return(0,n.jsxs)(y.Z,{title:"Assign system",...a,onClose:h,children:[(0,n.jsxs)(u.jqI,{vertical:!0,gap:20,className:"pb-6 pt-4",children:[(0,n.jsx)(D,{children:"Assign a system to the selected assets. If no system exists, select 'Add new system' to create one."}),(0,n.jsx)(T.R,{placeholder:"Search or select...",onSelect:(e,t)=>{o(t)},onAddSystem:c,value:r})]})," ",(0,n.jsxs)(u.jqI,{justify:"space-between",children:[(0,n.jsx)(u.wpx,{htmlType:"reset",onClick:h,"data-testid":"cancel-btn",children:"Cancel"}),(0,n.jsx)(u.wpx,{htmlType:"submit",type:"primary",disabled:!r,loading:s,onClick:()=>{t(r)},"data-testid":"save-btn",children:"Save"})]}),l&&(0,n.jsx)(A.i,{isOpen:!0,onClose:m,onSuccessfulSubmit:(e,t)=>{m(),o({label:t,value:e})},toastOnSuccess:!0})]})};var N=s(8411),z=s(72625);let E=e=>{let{asset:t}=e,[s,{isLoading:a}]=(0,f.EY)(),[i,{isLoading:r}]=(0,f.nS)(),{successAlert:o,errorAlert:l}=(0,p.V)(),d=a||r,{urn:c,name:m,resource_type:h,diff_status:v}=t,x=async()=>{let e=await s({urnList:[c]});(0,g.D4)(e)?l((0,g.e$)(e.error)):o("".concat(h,' "').concat(m,'" has been added to the system inventory.'),"Confirmed")},y=async()=>{let e=await i({urnList:[c]});(0,g.D4)(e)?l((0,g.e$)(e.error)):o("".concat(h,' "').concat(m,'" has been ignored and will not appear in future scans.'),"Ignored")};return(0,n.jsxs)(u.vyj,{children:[(0,n.jsx)(u.esZ,{title:t.system?void 0:"This asset requires a system before you can add it to the inventory.",children:(0,n.jsx)(u.wpx,{"data-testid":"add-btn",size:"small",onClick:x,disabled:!t.system||d,loading:a,children:"Add"})}),v!==_.LL.MUTED&&(0,n.jsx)(u.wpx,{"data-testid":"ignore-btn",size:"small",onClick:y,disabled:d,loading:r,children:"Ignore"})]})};var L=s(34929),q=s(78238),M=s(26183),Z=s(31883),O=e=>{var t;let{asset:s,readonly:a}=e,[r,o]=(0,i.useState)(!1),[l]=(0,f.Ak)(),{successAlert:d,errorAlert:c}=(0,p.V)(),{getDataUseDisplayName:m}=(0,L.Z)(),h=s.user_assigned_data_uses||s.data_uses||[],v=async e=>{let t=await l({monitorId:s.monitor_config_id,urnList:[s.urn],dataUses:[...h,e]});(0,Z.D4)(t)?c((0,g.e$)(t.error)):d("Consent category added to ".concat(s.resource_type,' "').concat(s.name,'" .'),"Confirmed"),o(!1)},x=async e=>{let t=await l({monitorId:s.monitor_config_id,urnList:[s.urn],dataUses:h.filter(t=>t!==e)});(0,Z.D4)(t)?c((0,g.e$)(t.error)):d("Consent category removed from ".concat(s.resource_type,' "').concat(s.name,'".'),"Confirmed")},y=(null===(t=s.user_assigned_data_uses)||void 0===t?void 0:t.length)?s.user_assigned_data_uses:s.data_uses,b=null==y?void 0:y.filter(e=>(0,q.Z)(e));return a?(0,n.jsx)(M.Z,{children:null==b?void 0:b.map(e=>(0,n.jsx)(u.j8w,{color:"white",children:m(e)},e))}):(0,n.jsxs)(M.Z,{children:[!r&&(0,n.jsxs)(n.Fragment,{children:[null==b?void 0:b.map(e=>(0,n.jsx)(u.j8w,{"data-testid":"data-use-".concat(e),color:"white",closable:!0,onClose:()=>x(e),closeButtonLabel:"Remove data use",children:m(e)},e)),(0,n.jsx)(u.j8w,{onClick:()=>o(!0),"data-testid":"taxonomy-add-btn",addable:!0,"aria-label":"Add data use"})]}),r&&(0,n.jsx)(u.xuv,{className:"select-wrapper",position:"absolute",zIndex:10,top:"0",left:"0",width:"100%",height:"max",bgColor:"#fff",children:(0,n.jsx)(j.Z,{selectedTaxonomies:b||[],onSelect:v,onBlur:()=>o(!1),open:!0})})]})},U=s(43862),B=s(70675);let V=e=>{let{aggregateSystem:t,monitorConfigId:s,readonly:a}=e,{resource_type:r,name:o,urn:l,system:d,user_assigned_system_key:c,system_key:m}=t,[h,v]=(0,i.useState)(!1),[x,f]=(0,i.useState)(!1),[y,{isLoading:j}]=(0,B.NA)(),{successAlert:b,errorAlert:C}=(0,p.V)(),_=(0,i.useCallback)(e=>{e.preventDefault(),f(!0)},[]),w=async(e,t,n)=>{let a=await y({staged_resource_urn:l,monitor_config_id:s,user_assigned_system_key:e});(0,g.D4)(a)?C((0,g.e$)(a.error)):b(n?"".concat(t," has been added to your system inventory and the ").concat(r,' "').concat(o,'" has been assigned to that system.'):"".concat(r,' "').concat(o,'" has been assigned to ').concat(t,"."),"Confirmed"),v(!1)};return a?(0,n.jsx)("div",{style:(0,U.J9)(),children:(0,n.jsx)(u.j8w,{"data-testid":"system-badge",color:"white",children:d})}):(0,n.jsxs)(n.Fragment,{children:[!h&&(0,n.jsx)("div",{style:(0,U.J9)(),children:d?(0,n.jsxs)(u.j8w,{onClick:()=>v(!0),"data-testid":"system-badge",children:[d,(0,n.jsx)(u.PJP.I8b,{})]}):(0,n.jsx)(u.j8w,{onClick:()=>v(!0),"data-testid":"add-system-btn",addable:!0})}),!!h&&(0,n.jsx)(T.R,{variant:"borderless",className:"w-full",autoFocus:!0,defaultOpen:!0,defaultValue:c||m,onBlur:e=>{var t;(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("id"))!=="add-new-system"&&v(!1)},onAddSystem:_,onSelect:(e,t)=>w(e,t.label),loading:j}),x&&(0,n.jsx)(A.i,{isOpen:!0,onClose:()=>{f(!1)},onSuccessfulSubmit:(e,t)=>w(e,t,!0)})]})},W=e=>{let{readonly:t}=e,s=(0,c.Cl)(),a=[s.accessor(e=>e.name,{id:"name",cell:e=>(0,n.jsx)(x.G3,{value:e.getValue()}),header:"Asset",size:300}),s.accessor(e=>e.resource_type,{id:"resource_type",cell:e=>(0,n.jsx)(x.G3,{value:e.getValue()}),header:"Type"}),s.accessor(e=>e.system,{id:"system",cell:e=>!!e.row.original.monitor_config_id&&(0,n.jsx)(V,{aggregateSystem:e.row.original,monitorConfigId:e.row.original.monitor_config_id,readonly:t}),header:"System",size:200,meta:{noPadding:!0}}),s.display({id:"data_use",cell:e=>(0,n.jsx)(O,{asset:e.row.original,readonly:t}),header:"Categories of consent",size:400,meta:{disableRowClick:!0}}),s.accessor(e=>e.locations,{id:"locations",cell:e=>(0,n.jsx)(z.mb,{values:e.getValue().map(e=>{var t;return{label:null!==(t=N.Z8[e])&&void 0!==t?t:e,key:e}}),cellProps:e}),header:"Locations",size:300,meta:{showHeaderMenu:!0,disableRowClick:!0}}),s.accessor(e=>e.domain,{id:"domain",cell:e=>(0,n.jsx)(x.G3,{value:e.getValue()}),header:"Domain"}),s.accessor(e=>e.page,{id:"page",cell:e=>(0,n.jsx)(z.tc,{values:e.getValue(),valueSuffix:"pages",cellProps:e}),header:e=>(0,n.jsx)(z.Rr,{value:"Detected on",...e}),meta:{showHeaderMenu:!0,disableRowClick:!0}})];return t?{columns:a}:{columns:[s.display({id:"select",cell:e=>{let{row:t}=e;return(0,n.jsx)(x.k,{isChecked:t.getIsSelected(),onChange:t.getToggleSelectedHandler(),dataTestId:"select-".concat(t.original.name||t.id)})},header:e=>{let{table:t}=e;return(0,n.jsx)(x.k,{isChecked:t.getIsAllPageRowsSelected(),isIndeterminate:t.getIsSomeRowsSelected(),onChange:t.getToggleAllRowsSelectedHandler(),dataTestId:"select-all-rows"})},maxSize:40}),...a,s.display({id:"actions",cell:e=>(0,n.jsx)(E,{asset:e.row.original}),header:"Actions",meta:{disableRowClick:!0}})]}},$=e=>{let{monitorId:t,systemId:s,onSystemName:r}=e,l=(0,a.useRouter)(),[m,y]=(0,i.useState)(s),[j,b]=(0,i.useState)({}),[w,S]=(0,i.useState)(!1),[I,T]=(0,i.useState)(!1),[A,{isLoading:D}]=(0,f.EY)(),[N,{isLoading:z}]=(0,f.nS)(),[E,{isLoading:L}]=(0,f.rs)(),[q,{isLoading:M}]=(0,f.sX)(),[Z,{isLoading:O}]=(0,f.Vr)(),U=D||z||L||M,B=U||s===o.Kl,{PAGE_SIZES:V,pageSize:$,setPageSize:F,onPreviousPageClick:H,isPreviousPageDisabled:X,onNextPageClick:J,isNextPageDisabled:K,startRange:G,endRange:Q,pageIndex:Y,setTotalPages:ee,resetPageIndexToDefault:et}=(0,x.oi)(),[es,en]=(0,i.useState)(""),{successAlert:ea,errorAlert:ei}=(0,p.V)();(0,i.useEffect)(()=>{et()},[t,es,et]);let{filterTabs:er,filterTabIndex:eo,onTabChange:el,activeParams:ed}=R({systemId:s}),{data:ec,isLoading:eu,isFetching:em}=(0,f.WJ)({key:t,page:Y,size:$,search:es,...ed});(0,i.useEffect)(()=>{if(ec){var e;let t=(null===(e=ec.items[0])||void 0===e?void 0:e.system)||m||s||"";ee(ec.pages||1),y(t),null==r||r(t)}},[ec,s,r,ee,m]);let eh=ed.diff_status.includes(_.LL.MONITORED),{columns:ev}=W({readonly:eh}),eg=(0,d.b7)({getCoreRowModel:(0,c.sC)(),columns:ev,manualPagination:!0,data:(null==ec?void 0:ec.items)||[],columnResizeMode:"onChange",onRowSelectionChange:b,state:{rowSelection:j}}),ep=eg.getSelectedRowModel().rows.map(e=>e.original.urn),ex=async()=>{let e=await A({urnList:ep});(0,g.D4)(e)?ei((0,g.e$)(e.error)):(eg.resetRowSelection(),ea("".concat(ep.length," assets from ").concat(m," have been added to the system inventory."),"Confirmed"))},ef=async e=>{if("string"==typeof(null==e?void 0:e.value)){let s=await q({monitorId:t,urnList:ep,systemKey:e.value});(0,g.D4)(s)?ei((0,g.e$)(s.error)):(eg.resetRowSelection(),ea("".concat(ep.length," assets have been assigned to ").concat(e.label,"."),"Confirmed"))}S(!1)},ey=async e=>{let s=null==ec?void 0:ec.items.filter(e=>ep.includes(e.urn));if(!s)return;let n=s.map(t=>{let s=h()([...t.user_assigned_data_uses||t.data_uses||[],...e]);return{urn:t.urn,user_assigned_data_uses:s}}),a=await Z({monitorId:t,assets:n});(0,g.D4)(a)?ei((0,g.e$)(a.error)):(eg.resetRowSelection(),ea("Consent categories added to ".concat(ep.length," assets").concat(m?" from ".concat(m):"","."),"Confirmed")),T(!1)},ej=async()=>{let e=await N({urnList:ep});(0,g.D4)(e)?ei((0,g.e$)(e.error)):(eg.resetRowSelection(),ea("".concat(ep.length," assets from ").concat(m," have been ignored and will not appear in future scans."),"Confirmed"))},eb=async()=>{let e=(null==ec?void 0:ec.items.length)||0,n=await E({monitor_config_key:t,resolved_system_ids:[s]});(0,g.D4)(n)?ei((0,g.e$)(n.error)):(l.push("".concat(o.vi,"/").concat(t)),ea("".concat(e," assets from ").concat(m," have been added to the system inventory."),"Confirmed"))};return t&&s?eu?(0,n.jsx)(x.I4,{rowHeight:36,numRows:36}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{data:er,"data-testid":"system-tabs",index:eo,isLazy:!0,isManual:!0,onChange:el}),(0,n.jsxs)(x.Q$,{children:[(0,n.jsx)(k.M,{value:es,onChange:en}),(0,n.jsxs)(u.kCb,{alignItems:"center",children:[!!ep.length&&(0,n.jsx)(u.xvT,{fontSize:"xs",fontWeight:"semibold",minW:16,mr:6,"data-testid":"selected-count",children:"".concat(ep.length," selected")}),(0,n.jsxs)(u.Ugi,{children:[(0,n.jsxs)(u.v2r,{children:[(0,n.jsx)(u.j2t,{as:u.wpx,icon:(0,n.jsx)(u.PJP._ME,{}),iconPosition:"end",loading:U,"data-testid":"bulk-actions-menu",disabled:!ep.length||U||eh,type:"primary",children:"Actions"}),(0,n.jsxs)(u.qyq,{children:[(0,n.jsx)(u.sNh,{fontSize:"small",onClick:ex,"data-testid":"bulk-add",children:"Add"}),(0,n.jsx)(u.sNh,{fontSize:"small",onClick:()=>T(!0),"data-testid":"bulk-add-data-use",children:"Add consent category"}),(0,n.jsx)(u.sNh,{fontSize:"small",onClick:()=>{S(!0)},"data-testid":"bulk-assign-system",children:"Assign system"}),!ed.diff_status.includes(_.LL.MUTED)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.RaW,{}),(0,n.jsx)(u.sNh,{fontSize:"small",onClick:ej,"data-testid":"bulk-ignore",children:"Ignore"})]})]})]}),(0,n.jsx)(u.esZ,{title:B?"These assets require a system before you can add them to the inventory.":void 0,children:(0,n.jsx)(u.wpx,{onClick:eb,disabled:B,loading:L,type:"primary",icon:(0,n.jsx)(u.PJP.MCw,{}),iconPosition:"end","data-testid":"add-all",children:"Add all"})})]})]})]}),(0,n.jsx)(x.ZK,{tableInstance:eg,emptyTableNotice:(0,n.jsx)(u.oj8,{image:u.oj8.PRESENTED_IMAGE_SIMPLE,description:"All caught up!"})}),(0,n.jsx)(x.s8,{totalRows:(null==ec?void 0:ec.total)||0,pageSizes:V,setPageSize:F,onPreviousPageClick:H,isPreviousPageDisabled:X||em,onNextPageClick:J,isNextPageDisabled:K||em,startRange:G,endRange:Q}),(0,n.jsx)(P,{isOpen:w,onClose:()=>{S(!1)},onSave:ef,isSaving:M}),(0,n.jsx)(C,{isOpen:I,onClose:()=>{T(!1)},onSave:ey,isSaving:O})]}):null};var F=()=>{let e=(0,a.useRouter)(),t=decodeURIComponent(e.query.monitorId),s=decodeURIComponent(e.query.systemId),[d,c]=(0,i.useState)(s===o.Kl?"Uncategorized assets":s);return(0,n.jsxs)(r.Z,{title:"Action center - Discovered assets",children:[(0,n.jsx)(l.Z,{heading:"Action center",breadcrumbItems:[{title:"All activity",href:o.vi},{title:t,href:"".concat(o.vi,"/").concat(t)},{title:s===o.Kl?"Uncategorized assets":d}]}),(0,n.jsx)($,{monitorId:t,systemId:s,onSystemName:c})]})}},31883:function(e,t,s){"use strict";s.d(t,{Bw:function(){return n.Bw},D4:function(){return n.D4}});var n=s(19043)}},function(e){e.O(0,[8033,6060,2858,2866,9278,4481,146,3938,2888,9774,179],function(){return e(e.s=25654)}),_N_E=e.O()}]);