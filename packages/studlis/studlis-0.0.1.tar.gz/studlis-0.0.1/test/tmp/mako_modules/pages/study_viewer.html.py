# -*- coding:utf-8 -*-
from mako import runtime, filters, cache
UNDEFINED = runtime.UNDEFINED
STOP_RENDERING = runtime.STOP_RENDERING
__M_dict_builtin = dict
__M_locals_builtin = locals
_magic_number = 10
_modified_time = 1744104206.426389
_enable_loop = True
_template_filename = 'd:/projekte/studlis/studlis/studlis/webui/pages/study_viewer.html'
_template_uri = 'pages/study_viewer.html'
_source_encoding = 'utf-8'
_exports = []


def render_body(context,**pageargs):
    __M_caller = context.caller_stack._push_frame()
    try:
        __M_locals = __M_dict_builtin(pageargs=pageargs)
        __M_writer = context.writer()
        __M_writer('<template tpl_id="study_viewer">\r\n    <div  class="flex-use-height">\r\n        <div class="controls d-flex">\r\n\r\n\r\n            <button id="btn-back" class="btn btn-outline-primary mr-2" style="width: 150px;" onclick="study_viewer.back();">\r\n                <i class="fas fa-arrow-left"></i> \r\n            </button>\r\n            <button id="btn-forward" class="btn btn-outline-primary mr-2" style="width: 150px;"onclick="study_viewer.next();">\r\n             <i class="fas fa-arrow-right"></i>\r\n            </button>\r\n            <\r\n        </div>\r\n        <div class="row">\r\n\r\n            <div class="col-8">\r\n                <div class="study-doi">\r\n                    <a href="#" class="study-doi-link" target="_blank">\r\n    \r\n                    </a>\r\n                </div>\r\n                <div class="study-name">\r\n    \r\n                </div>\r\n               <div class="abstract">\r\n    \r\n               </div> \r\n    \r\n            </div>\r\n            <div class="col-4 ">\r\n                <div class="study-fields">\r\n    \r\n                </div>\r\n            \r\n            </div>\r\n    \r\n    \r\n        </div>\r\n    </div>\r\n    \r\n\r\n\r\n</template>\r\n<template tpl_id="study_item_int">\r\n    \r\n    <div class="m-1 card">\r\n        <span class="study-field-title"></span><br />\r\n        <input type="text" class="study-field-value m-1 mx-auto d-block" />\r\n\r\n    </div>\r\n\r\n\r\n </template>   \r\n <template tpl_id="study_item_multibool">\r\n    \r\n    <div class="m-1 card">\r\n        <span class="study-field-title"></span><br />\r\n        \r\n        <div class="btn-group flex-wrap multibool-options" role="group" style="max-width: 500px;">\r\n    \r\n          </div>\r\n          \r\n    </div>\r\n </template>   \r\n <template tpl_id="study_item_multibool_item">\r\n    <div>\r\n        <input type="checkbox" style="" class="btn-check" autocomplete="off" />\r\n        <label class="btn btn-outline-primary rounded-0" for="">Three</label>\r\n    </div>\r\n    \r\n </template>\r\n <template tpl_id="study_item_select">\r\n    \r\n    <div class="m-1 card">\r\n        <span class="study-field-title"></span><br />\r\n        \r\n        <div class="btn-group flex-wrap select-options" role="group" style="max-width: 500px;">\r\n    \r\n          </div>\r\n          \r\n    </div>\r\n </template>   \r\n <template tpl_id="study_item_select_item">\r\n    <div>\r\n        <input type="checkbox" style="" class="btn-check" autocomplete="off" />\r\n        <label class="btn btn-outline-primary rounded-0" for="">Three</label>\r\n    </div>\r\n    \r\n </template>\r\n\r\n<script>\r\n    var study_viewer = {};\r\n    study_viewer.list=undefined;\r\n    study_viewer.index=0;\r\n    study_viewer.start_list = function(first_id,first_index,study_list_request_data){\r\n        study_viewer._view(first_id);\r\n        DoRequest("get_study_list_ids",study_list_request_data, function (data) {\r\n            if (data.value) {\r\n                study_viewer.list=data.value;\r\n                study_viewer.index=first_index;\r\n            }\r\n        });\r\n\r\n\r\n    }\r\n\r\n    study_viewer.next = function(){\r\n        if (study_viewer.list==undefined)return;\r\n        if (study_viewer.index<study_viewer.list.length-1){\r\n            study_viewer.index++;\r\n            study_viewer._view(study_viewer.list[study_viewer.index]);\r\n        }else{\r\n            alert("no more studies in this project");\r\n        }\r\n    }\r\n    study_viewer.back = function(){\r\n        if (study_viewer.list==undefined)return;\r\n        if (study_viewer.index>0){\r\n            study_viewer.index--;\r\n            study_viewer._view(study_viewer.list[study_viewer.index]);\r\n        }else{\r\n            alert("no more studies in this project");\r\n        }\r\n    }\r\n\r\n\r\n\r\n    study_viewer.view=function(study_id){\r\n        study_viewer.list=undefined;\r\n        study_viewer.index=0;\r\n        study_viewer._view(study_id);\r\n    }\r\n\r\n    study_viewer._view=function(study_id){\r\n        node = $("#main-view-content").tpl("study_viewer");\r\n        DoRequest("get_study", {"token":session_token,"project":selected_project,"study_id":study_id}, function (data) {\r\n            if (data.value) {\r\n                node.find(".study-name").text(data.value.study.name);\r\n                node.find(".study-doi-link").text(data.value.study.doi);\r\n                node.find(".study-doi-link").attr("href","https://doi.org/"+data.value.study.doi);\r\n                node.find(".abstract").text(data.value.study.abstract);\r\n\r\n                $.each(data.value.project.fields, function (index, field) {\r\n                    let fieldnode=undefined;\r\n                    switch(field.type){\r\n                        case "int":\r\n                            fieldnode = $(".study-fields").appendtpl("study_item_int");\r\n                            break;\r\n                        case "select":\r\n\r\n                            fieldnode = $(".study-fields").appendtpl("study_item_select");\r\n                            fieldnode.attr("id","fld_"+field.name);\r\n                            $.each(field.reference, function (name, item) {\r\n                                let onode=fieldnode.find(".select-options").appendtpl("study_item_select_item");\r\n                                onode.find("label").text(name);\r\n                                onode.find("value").val(name);\r\n                                onode.click(function(){\r\n                                        fieldnode.find(".select-options").find(".btn-check").removeAttr("checked");\r\n                                        $(this).find(".btn-check").attr("checked","checked");\r\n                                        \r\n                                    });\r\n                                onode.find("label").attr("for","fld_"+field.name+"_"+name);\r\n                            });\r\n                            break;\r\n                        case "multibool":\r\n                            fieldnode = $(".study-fields").appendtpl("study_item_multibool");\r\n                            $.each(field.reference, function (name, item) {\r\n                                let onode=fieldnode.find(".multibool-options").appendtpl("study_item_multibool_item");\r\n                                onode.find("label").text(name);\r\n                                onode.find("input").attr("id","fld_"+field.name+"_"+name);\r\n                                onode.find("label").attr("for","fld_"+field.name+"_"+name);\r\n                            });\r\n                            break;\r\n                        default:\r\n                            console.log("unknown field type");\r\n                            return;\r\n                    }   \r\n                    fieldnode.find(".study-field-title").text(field.caption);\r\n                    fieldnode.find(".study-field-value").val(data.value.study["data_"+field.name]);\r\n\r\n                });\r\n  \r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    document.addEventListener("keydown", function(event) {\r\n        if (event.key === "ArrowLeft") {\r\n            study_viewer.back();\r\n        } else if (event.key === "ArrowRight") {\r\n            study_viewer.next();\r\n        }\r\n    });\r\n\r\n</script>')
        return ''
    finally:
        context.caller_stack._pop_frame()


"""
__M_BEGIN_METADATA
{"filename": "d:/projekte/studlis/studlis/studlis/webui/pages/study_viewer.html", "uri": "pages/study_viewer.html", "source_encoding": "utf-8", "line_map": {"16": 0, "21": 1, "27": 21}}
__M_END_METADATA
"""
