

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>agi_core.workers.agi_worker.agi_worker &mdash; AGILab 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />

  
    <link rel="canonical" href="https://thalesgroup.github.io/agilab/_modules/agi_core/workers/agi_worker/agi_worker.html" />
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            AGILab
              <img src="../../../../_static/agi_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../quick-start.html">Quick-Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../quick-start.html#license">LICENSE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../quick-start.html#install-agilab">Install Agilab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../quick-start.html#support">Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../introduction.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../introduction.html#purpose"><strong>Purpose</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../introduction.html#target-audience"><strong>Target Audience</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../introduction.html#main-dependencies"><strong>Main Dependencies</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../introduction.html#technologies-selection-criteria"><strong>Technologies Selection Criteria</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../introduction.html#example-aircraft-telecommunication">Example: Aircraft Telecommunication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../features.html">Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../features.html#agi-core">agi-core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../features.html#agilab">agilab</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cluster.html">Cluster</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../cluster-help.html">Cluster Help</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../cluster-help.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../cluster-help.html#principle">Principle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../key-generation.html">Key Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../key-generation.html#generate-the-keys">Generate the keys</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../key-generation.html#loading-the-private-key-in-ssh-agent">Loading the private key in SSH Agent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../key-generation.html#load-the-private-key">Load the private key</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../key-generation.html#verify-the-key-addition">Verify the key Addition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../key-generation.html#copy-the-public-key-to-the-server">Copy the public key to the server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../key-generation.html#sshd-service">SSHD Service</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../key-generation.html#check-the-configuration">Check the configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../key-generation.html#restart-the-sshd-service">Restart the SSHD service</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../key-generation.html#check-the-service-status">Check the service status:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../key-generation.html#permissions">Permissions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../key-generation.html#on-windows">On Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../key-generation.html#on-linux">On Linux</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../key-generation.html#useful-links">Useful links</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../agilab.html">AGILab</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../edit_help.html">▶️ EDIT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../edit_help.html#sidebar">Sidebar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../edit_help.html#main-content-area">Main Content Area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../edit_help.html#support">Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../execute_help.html">▶️ EXECUTE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../execute_help.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../execute_help.html#sidebar">Sidebar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../execute_help.html#main-content-area">Main Content Area</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../experiment_help.html">▶️ EXPERIMENT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../experiment_help.html#sidebar">Sidebar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../experiment_help.html#main-content-area">Main Content Area</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../views_help.html">▶️ VIEW</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../views_help.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../views_help.html#sidebar">Sidebar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../views_help.html#main-content-area">Main Content Area</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../framework-api.html">Framework API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../agi-env.html">agi_env API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../agi-env.html#usage-example">Usage Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-env.html#instanciation">Instanciation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../agi-env.html#reference">Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-env.html#agi_env.agi_env.AgiEnv"><code class="docutils literal notranslate"><span class="pre">AgiEnv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-env.html#agi_env.agi_env.JumpToMain"><code class="docutils literal notranslate"><span class="pre">JumpToMain</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../agi-managers.html">agi_core.managers API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../agi-managers.html#usage-example">Usage Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-managers.html#installation">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-managers.html#update">Update</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-managers.html#distribute">Distribute</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-managers.html#run">Run</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../agi-managers.html#reference">Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-managers.html#agi_core.managers.agi_runner.agi_runner.AGI"><code class="docutils literal notranslate"><span class="pre">AGI</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-managers.html#agi_core.managers.agi_manager.agi_manager.AgiManager"><code class="docutils literal notranslate"><span class="pre">AgiManager</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../agi-workers.html">agi_core.workers API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../agi-workers.html#workers-reference">Workers Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-workers.html#agi-core-workers-agi-worker">agi_core.workers.agi-worker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-workers.html#agi-core-workers-agent-worker">agi_core.workers.agent-worker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-workers.html#agi-core-workers-dag-worker">agi_core.workers.dag-worker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../agi-workers.html#agi-core-workers-data-worker">agi_core.workers.data-worker</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../my-code-project.html">Example1: My-Code-Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../my-code-project.html#manager-my-code">manager: my_code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCode"><code class="docutils literal notranslate"><span class="pre">MyCode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCode.__init__"><code class="docutils literal notranslate"><span class="pre">MyCode.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCode.args"><code class="docutils literal notranslate"><span class="pre">MyCode.args</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCode.build_distribution"><code class="docutils literal notranslate"><span class="pre">MyCode.build_distribution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCode.convert_functions_to_names"><code class="docutils literal notranslate"><span class="pre">MyCode.convert_functions_to_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCode.do_distrib"><code class="docutils literal notranslate"><span class="pre">MyCode.do_distrib()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCode.onerror"><code class="docutils literal notranslate"><span class="pre">MyCode.onerror()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCode.verbose"><code class="docutils literal notranslate"><span class="pre">MyCode.verbose</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.__init__"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.construct"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.construct()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.copy"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.dict"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.from_orm"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.from_orm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.json"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_config"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_construct"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_construct()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_copy"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_dump"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_dump()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_dump_json"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_dump_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_extra"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_extra</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_fields"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_fields_set"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_fields_set</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_json_schema"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_json_schema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_parametrized_name"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_parametrized_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_post_init"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_post_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_rebuild"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_rebuild()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_validate"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_validate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_validate_json"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_validate_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.model_validate_strings"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.model_validate_strings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.mycode_param1"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.mycode_param1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.parse_file"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.parse_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.parse_obj"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.parse_obj()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.parse_raw"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.parse_raw()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.schema"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.schema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.schema_json"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.schema_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.update_forward_refs"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.update_forward_refs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code.my_code.MyCodeArgs.validate"><code class="docutils literal notranslate"><span class="pre">MyCodeArgs.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../my-code-project.html#worker-my-code-worker">worker: my_code_worker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.algo_A"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.algo_A()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.algo_B"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.algo_B()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.algo_C"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.algo_C()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.algo_X"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.algo_X()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.algo_Y"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.algo_Y()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.algo_Z"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.algo_Z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.build"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.cython_decorators"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.cython_decorators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.dask_home"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.dask_home</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.do_works"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.do_works()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.exec"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.exec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.exec_mono_process"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.exec_mono_process()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.exec_multi_process"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.exec_multi_process()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.expand"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.expand()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.expand_and_join"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.expand_and_join()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.get_worker_info"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.get_worker_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.home_dir"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.home_dir</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.is_managed_pc"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.is_managed_pc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.join"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.join()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.logs"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.logs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.mode"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.new"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.new()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.normalize_path"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.normalize_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.onerror"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.onerror()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.run"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.share_path"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.share_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.start"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.stop"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.stop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.t0"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.t0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.topological_sort"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.topological_sort()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.verbose"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.verbose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.worker"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.worker</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.worker_id"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.worker_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../my-code-project.html#my_code_worker.my_code_worker.MyCodeWorker.works"><code class="docutils literal notranslate"><span class="pre">MyCodeWorker.works()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../flight-project.html">Example2: Flight-Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../flight-project.html#manager-flight">manager: flight</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight"><code class="docutils literal notranslate"><span class="pre">Flight</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.__init__"><code class="docutils literal notranslate"><span class="pre">Flight.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.args"><code class="docutils literal notranslate"><span class="pre">Flight.args</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.build_distribution"><code class="docutils literal notranslate"><span class="pre">Flight.build_distribution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.convert_functions_to_names"><code class="docutils literal notranslate"><span class="pre">Flight.convert_functions_to_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.data_out"><code class="docutils literal notranslate"><span class="pre">Flight.data_out</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.do_distrib"><code class="docutils literal notranslate"><span class="pre">Flight.do_distrib()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.extract_plane_from_file_name"><code class="docutils literal notranslate"><span class="pre">Flight.extract_plane_from_file_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.get_data_from_files"><code class="docutils literal notranslate"><span class="pre">Flight.get_data_from_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.get_data_from_hawk"><code class="docutils literal notranslate"><span class="pre">Flight.get_data_from_hawk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.get_partition_by_planes"><code class="docutils literal notranslate"><span class="pre">Flight.get_partition_by_planes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.ivq_logs"><code class="docutils literal notranslate"><span class="pre">Flight.ivq_logs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.onerror"><code class="docutils literal notranslate"><span class="pre">Flight.onerror()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.Flight.verbose"><code class="docutils literal notranslate"><span class="pre">Flight.verbose</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs"><code class="docutils literal notranslate"><span class="pre">FlightArgs</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.__init__"><code class="docutils literal notranslate"><span class="pre">FlightArgs.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.check_date"><code class="docutils literal notranslate"><span class="pre">FlightArgs.check_date()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.check_date_order"><code class="docutils literal notranslate"><span class="pre">FlightArgs.check_date_order()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.check_valid_regex"><code class="docutils literal notranslate"><span class="pre">FlightArgs.check_valid_regex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.construct"><code class="docutils literal notranslate"><span class="pre">FlightArgs.construct()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.copy"><code class="docutils literal notranslate"><span class="pre">FlightArgs.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.data_source"><code class="docutils literal notranslate"><span class="pre">FlightArgs.data_source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.datemax"><code class="docutils literal notranslate"><span class="pre">FlightArgs.datemax</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.datemin"><code class="docutils literal notranslate"><span class="pre">FlightArgs.datemin</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.dict"><code class="docutils literal notranslate"><span class="pre">FlightArgs.dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.files"><code class="docutils literal notranslate"><span class="pre">FlightArgs.files</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.from_orm"><code class="docutils literal notranslate"><span class="pre">FlightArgs.from_orm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.json"><code class="docutils literal notranslate"><span class="pre">FlightArgs.json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_computed_fields"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_computed_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_config"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_construct"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_construct()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_copy"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_dump"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_dump()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_dump_json"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_dump_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_extra"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_extra</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_fields"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_fields</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_fields_set"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_fields_set</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_json_schema"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_json_schema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_parametrized_name"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_parametrized_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_post_init"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_post_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_rebuild"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_rebuild()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_validate"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_validate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_validate_json"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_validate_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.model_validate_strings"><code class="docutils literal notranslate"><span class="pre">FlightArgs.model_validate_strings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.nfile"><code class="docutils literal notranslate"><span class="pre">FlightArgs.nfile</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.nread"><code class="docutils literal notranslate"><span class="pre">FlightArgs.nread</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.nskip"><code class="docutils literal notranslate"><span class="pre">FlightArgs.nskip</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.output_format"><code class="docutils literal notranslate"><span class="pre">FlightArgs.output_format</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.parse_file"><code class="docutils literal notranslate"><span class="pre">FlightArgs.parse_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.parse_obj"><code class="docutils literal notranslate"><span class="pre">FlightArgs.parse_obj()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.parse_raw"><code class="docutils literal notranslate"><span class="pre">FlightArgs.parse_raw()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.path"><code class="docutils literal notranslate"><span class="pre">FlightArgs.path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.sampling_rate"><code class="docutils literal notranslate"><span class="pre">FlightArgs.sampling_rate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.schema"><code class="docutils literal notranslate"><span class="pre">FlightArgs.schema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.schema_json"><code class="docutils literal notranslate"><span class="pre">FlightArgs.schema_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.update_forward_refs"><code class="docutils literal notranslate"><span class="pre">FlightArgs.update_forward_refs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight.flight.FlightArgs.validate"><code class="docutils literal notranslate"><span class="pre">FlightArgs.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../flight-project.html#worker-flight-worker">worker: flight_worker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker"><code class="docutils literal notranslate"><span class="pre">FlightWorker</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.build"><code class="docutils literal notranslate"><span class="pre">FlightWorker.build()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.calculate_speed"><code class="docutils literal notranslate"><span class="pre">FlightWorker.calculate_speed()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.cython_decorators"><code class="docutils literal notranslate"><span class="pre">FlightWorker.cython_decorators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.dask_home"><code class="docutils literal notranslate"><span class="pre">FlightWorker.dask_home</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.do_works"><code class="docutils literal notranslate"><span class="pre">FlightWorker.do_works()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.exec"><code class="docutils literal notranslate"><span class="pre">FlightWorker.exec()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.exec_mono_process"><code class="docutils literal notranslate"><span class="pre">FlightWorker.exec_mono_process()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.exec_multi_process"><code class="docutils literal notranslate"><span class="pre">FlightWorker.exec_multi_process()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.expand"><code class="docutils literal notranslate"><span class="pre">FlightWorker.expand()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.expand_and_join"><code class="docutils literal notranslate"><span class="pre">FlightWorker.expand_and_join()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.get_worker_info"><code class="docutils literal notranslate"><span class="pre">FlightWorker.get_worker_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.home_dir"><code class="docutils literal notranslate"><span class="pre">FlightWorker.home_dir</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.is_managed_pc"><code class="docutils literal notranslate"><span class="pre">FlightWorker.is_managed_pc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.join"><code class="docutils literal notranslate"><span class="pre">FlightWorker.join()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.logs"><code class="docutils literal notranslate"><span class="pre">FlightWorker.logs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.mode"><code class="docutils literal notranslate"><span class="pre">FlightWorker.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.new"><code class="docutils literal notranslate"><span class="pre">FlightWorker.new()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.normalize_path"><code class="docutils literal notranslate"><span class="pre">FlightWorker.normalize_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.onerror"><code class="docutils literal notranslate"><span class="pre">FlightWorker.onerror()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.pool_init"><code class="docutils literal notranslate"><span class="pre">FlightWorker.pool_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.pool_vars"><code class="docutils literal notranslate"><span class="pre">FlightWorker.pool_vars</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.preprocess_df"><code class="docutils literal notranslate"><span class="pre">FlightWorker.preprocess_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.run"><code class="docutils literal notranslate"><span class="pre">FlightWorker.run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.share_path"><code class="docutils literal notranslate"><span class="pre">FlightWorker.share_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.start"><code class="docutils literal notranslate"><span class="pre">FlightWorker.start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.stop"><code class="docutils literal notranslate"><span class="pre">FlightWorker.stop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.t0"><code class="docutils literal notranslate"><span class="pre">FlightWorker.t0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.verbose"><code class="docutils literal notranslate"><span class="pre">FlightWorker.verbose</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.work_done"><code class="docutils literal notranslate"><span class="pre">FlightWorker.work_done()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.work_init"><code class="docutils literal notranslate"><span class="pre">FlightWorker.work_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.work_pool"><code class="docutils literal notranslate"><span class="pre">FlightWorker.work_pool()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.worker"><code class="docutils literal notranslate"><span class="pre">FlightWorker.worker</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.worker_id"><code class="docutils literal notranslate"><span class="pre">FlightWorker.worker_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../flight-project.html#flight_worker.flight_worker.FlightWorker.works"><code class="docutils literal notranslate"><span class="pre">FlightWorker.works()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../directory-structure.html">Project Files Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../troubleshouting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../troubleshouting.html#a-prerequisite">A - Prerequisite:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../troubleshouting.html#b-list-of-available-scripts">B- List of Available Scripts:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../troubleshouting.html#c-exemple-of-tests-sequence">C - Exemple of Tests Sequence:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../troubleshouting.html#known-bugs">Known Bugs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../troubleshouting.html#uv-sync-failed">&lt;UV&gt; Sync Failed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../troubleshouting.html#dask-debug-issue">&lt;DASK&gt; Debug Issue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../troubleshouting.html#pycharm-run-debug-configuration-is-broken">&lt;PYCHARM&gt; Run/Debug Configuration is Broken</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html">Licences</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../gui-licenses.html">Gui Licenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../core-licenses.html">Core Licenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../env-licenses.html">Env Licenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../my-code-project-licenses.html">My-code-project Licenses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../flight-project-licenses.html">Flight-project Licenses</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">AGILab</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">agi_core.workers.agi_worker.agi_worker</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for agi_core.workers.agi_worker.agi_worker</h1><div class="highlight"><pre>
<span></span><span class="c1"># BSD 3-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2025, Jean-Pierre Morard, THALES SIX GTS France SAS</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<span class="c1"># 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<span class="c1"># 3. Neither the name of Jean-Pierre Morard nor the names of its contributors, or THALES SIX GTS France SAS, may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">agi_worker module</span>

<span class="sd">    Auteur: Jean-Pierre Morard</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">######################################################</span>
<span class="c1"># Agi Framework call back functions</span>
<span class="c1">######################################################</span>
<span class="c1"># Internal Libraries:</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">getpass</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">stat</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">abc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>

<span class="c1"># External Libraries:</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">redirect_stdout</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">distutils.sysconfig</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_python_lib</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span><span class="p">,</span> <span class="n">PureWindowsPath</span><span class="p">,</span> <span class="n">PurePosixPath</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">zipfile</span><span class="w"> </span><span class="kn">import</span> <span class="n">ZipFile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">parso</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">humanize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">agi_env</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgiEnv</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">agi_core.managers.agi_manager</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgiManager</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="AgiWorker">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">AgiWorker</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    class AgiWorker v1.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_insts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">_built</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_pool_init</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_work_pool</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">share_path</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">worker_id</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">worker</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">home_dir</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">logs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dask_home</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">worker</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">is_managed_pc</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;T0&quot;</span><span class="p">)</span>
    <span class="n">cython_decorators</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;njit&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="AgiWorker.start">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.start">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Start the worker and print out a message if verbose mode is enabled.</span>

<span class="sd">        Args:</span>
<span class="sd">            None</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;AgiWorker.start - worker #</span><span class="si">{</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">worker_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">worker</span><span class="si">}</span><span class="s2"> - mode: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></div>


<div class="viewcode-block" id="AgiWorker.stop">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.stop">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;stop - worker #</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">worker_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="si">}</span><span class="s2"> - mode: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="AgiWorker.expand_and_join">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.expand_and_join">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expand_and_join</span><span class="p">(</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Join two paths after expanding the first path.</span>

<span class="sd">        Args:</span>
<span class="sd">            path1 (str): The first path to expand and join.</span>
<span class="sd">            path2 (str): The second path to join with the expanded first path.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The joined path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">is_managed_pc</span><span class="p">:</span>
            <span class="n">net_path</span> <span class="o">=</span> <span class="n">AgiEnv</span><span class="o">.</span><span class="n">normalize_path</span><span class="p">(</span><span class="s2">&quot;//127.0.0.1&quot;</span> <span class="o">+</span> <span class="n">path1</span><span class="p">[</span><span class="mi">6</span><span class="p">:])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># your nfs account in order to mount it as net drive on windows</span>
                <span class="n">cmd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;net use &#39;Z:&#39; &#39;</span><span class="si">{</span><span class="n">net_path</span><span class="si">}</span><span class="s2">&#39; /user:nsbl 2633&quot;</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">path1</span><span class="p">),</span> <span class="n">path2</span><span class="p">)</span></div>


<div class="viewcode-block" id="AgiWorker.expand">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.expand">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expand</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">base_directory</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Normalize Windows-style backslashes to POSIX forward slashes</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expand a given path to an absolute path.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): The path to expand.</span>
<span class="sd">            base_directory (str, optional): The base directory to use for expanding the path. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The expanded absolute path.</span>

<span class="sd">        Raises:</span>
<span class="sd">            None</span>

<span class="sd">        Note:</span>
<span class="sd">            This method handles both Unix and Windows paths and expands &#39;~&#39; notation to the user&#39;s home directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">normalized_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="c1"># Check if the path starts with `~`, expand to home directory only in that case</span>
        <span class="k">if</span> <span class="n">normalized_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">):</span>
            <span class="n">expanded_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">normalized_path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Use base_directory if provided; otherwise, assume current working directory</span>
            <span class="n">base_directory</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">Path</span><span class="p">(</span><span class="n">base_directory</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">base_directory</span>
                <span class="k">else</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;~/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">expanded_path</span> <span class="o">=</span> <span class="p">(</span><span class="n">base_directory</span> <span class="o">/</span> <span class="n">normalized_path</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">expanded_path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">AgiEnv</span><span class="o">.</span><span class="n">normalize_path</span><span class="p">(</span><span class="n">expanded_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="AgiWorker.join">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.join">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">join</span><span class="p">(</span><span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">):</span>
        <span class="c1"># path to data base on symlink Path.home()/data(symlink)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Join two file paths.</span>

<span class="sd">        Args:</span>
<span class="sd">            path1 (str): The first file path.</span>
<span class="sd">            path2 (str): The second file path.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The combined file path.</span>

<span class="sd">        Raises:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">path1</span><span class="p">),</span> <span class="n">path2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_stdout</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">          func:</span>
<span class="sd">          *args:</span>
<span class="sd">          **kwargs:</span>
<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">redirect_stdout</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="n">result</span>

<div class="viewcode-block" id="AgiWorker.exec">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.exec">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">exec</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">worker</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;execute a command within a subprocess</span>

<span class="sd">        Args:</span>
<span class="sd">          cmd: the str of the command</span>
<span class="sd">          path: the path where to lunch the command</span>
<span class="sd">          worker:</span>
<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">AgiEnv</span><span class="o">.</span><span class="n">normalize_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">path</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;WARNING&quot;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;warning: worker </span><span class="si">{</span><span class="n">worker</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;error on agi_worker </span><span class="si">{</span><span class="n">worker</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_class_loader</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">target_class</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">pck</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;load_target</span>

<span class="sd">        Args:</span>
<span class="sd">          module:</span>
<span class="sd">          target_class:</span>
<span class="sd">          mode:</span>
<span class="sd">          pck:</span>
<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">module</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">module</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_worker&quot;</span><span class="p">):</span>
            <span class="c1"># raise ImportError(f&#39;trying to load {module} in cython but it is already loaded in python&#39;)</span>
            <span class="n">module</span> <span class="o">+=</span> <span class="s2">&quot;_cy&quot;</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># raise ImportError(f&#39;trying to load {module} in python but it is already loaded in cython&#39;)</span>
            <span class="c1"># module = f&quot;{pck}.{module}&quot;</span>
            <span class="n">module</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pck</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">target_module</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Dynamically import the target class from the module</span>
            <span class="n">target_module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">fromlist</span><span class="o">=</span><span class="p">[</span><span class="n">target_class</span><span class="p">])</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">target_module</span><span class="p">,</span> <span class="n">target_class</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ModuleNotFoundError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="c1"># Raise a more descriptive ImportError if the target class cannot be imported</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;file: &quot;</span><span class="p">,</span> <span class="vm">__file__</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">__import__(&#39;</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&#39;, fromlist=[&#39;</span><span class="si">{</span><span class="n">target_class</span><span class="si">}</span><span class="s2">&#39;])&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">getattr(&#39;</span><span class="si">{</span><span class="n">target_module</span><span class="si">}</span><span class="s2">&#39;, &#39;</span><span class="si">{</span><span class="n">target_class</span><span class="si">}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sys.path:</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;from </span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2"> import </span><span class="si">{</span><span class="n">target_class</span><span class="si">}</span><span class="s2"> failed due to: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;file: &quot;</span><span class="p">,</span> <span class="vm">__file__</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">__import__(&#39;</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&#39;, fromlist=[&#39;</span><span class="si">{</span><span class="n">target_class</span><span class="si">}</span><span class="s2">&#39;])&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">getattr(&#39;</span><span class="si">{</span><span class="n">target_module</span><span class="si">}</span><span class="s2">&#39;, &#39;</span><span class="si">{</span><span class="n">target_class</span><span class="si">}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sys.path:</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;something wrong happened in _class_loader&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>

<div class="viewcode-block" id="AgiWorker.onerror">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.onerror">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">onerror</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">exc_info</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Error handler for `shutil.rmtree`.</span>

<span class="sd">        If the error is due to an access error (read only file)</span>
<span class="sd">        it attempts to add write permission and then retries.</span>

<span class="sd">        If the error is for another reason it re-raises the error.</span>

<span class="sd">        Usage : `shutil.rmtree(path, onerror=onerror)`</span>

<span class="sd">        Args:</span>
<span class="sd">          func:</span>
<span class="sd">          path:</span>
<span class="sd">          exc_info:</span>
<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Check if file access issue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">access</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">W_OK</span><span class="p">):</span>
                <span class="c1"># Try to change the permissions of the file to writable</span>
                <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">stat</span><span class="o">.</span><span class="n">S_IWUSR</span><span class="p">)</span>
                <span class="c1"># Try the operation again</span>
                <span class="n">func</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;warning failed to grant write access to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

        <span class="c1"># else:</span>
        <span class="c1"># Reraise the error if it&#39;s not a permission issue</span>
        <span class="c1"># raise</span>

<div class="viewcode-block" id="AgiWorker.run">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.run">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">workers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">env</span> <span class="o">=</span> <span class="n">AgiEnv</span><span class="p">(</span><span class="n">active_app</span><span class="o">=</span><span class="n">app</span><span class="p">)</span>
        <span class="n">module</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">module</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">wenv_abs</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">wenv_abs</span>

            <span class="c1"># Look for any files or directories in the Cython lib path that match the &quot;*cy*&quot; pattern.</span>
            <span class="n">cython_libs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">wenv_abs</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*cy*&quot;</span><span class="p">))</span>

            <span class="c1"># If a Cython library is found, normalize its path and set it as lib_path.</span>
            <span class="n">lib_path</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">cython_libs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">())</span> <span class="k">if</span> <span class="n">cython_libs</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">lib_path</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">lib_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lib_path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;warning: no cython library found at </span><span class="si">{</span><span class="n">lib_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">target_worker</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">target_worker</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">AgiWorker</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
                <span class="n">target_worker</span><span class="p">,</span>
                <span class="n">env</span><span class="o">.</span><span class="n">target_worker_class</span><span class="p">,</span>
                <span class="n">target_worker</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
                <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                <span class="n">env</span><span class="o">=</span><span class="n">env</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">target_class</span> <span class="o">=</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">_class_loader</span><span class="p">(</span>
            <span class="n">module</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">target_class</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">env</span>
        <span class="p">)</span>

        <span class="c1"># Instantiate the class with arguments</span>
        <span class="n">target_inst</span> <span class="o">=</span> <span class="n">target_class</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">workers</span><span class="p">,</span> <span class="n">workers_tree</span><span class="p">,</span> <span class="n">workers_tree_info</span> <span class="o">=</span> <span class="n">AgiManager</span><span class="o">.</span><span class="n">do_distrib</span><span class="p">(</span>
                <span class="n">target_inst</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">workers</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="mi">48</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">workers_tree</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">do_works</span><span class="p">(</span><span class="n">workers_tree</span><span class="p">,</span> <span class="n">workers_tree_info</span><span class="p">)</span>
        <span class="n">runtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span>
        <span class="n">env</span><span class="o">.</span><span class="n">_run_time</span> <span class="o">=</span> <span class="n">runtime</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">env</span><span class="o">.</span><span class="n">mode2str</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">humanize</span><span class="o">.</span><span class="n">precisedelta</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">runtime</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span></div>


<div class="viewcode-block" id="AgiWorker.new">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.new">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">new</span><span class="p">(</span>
            <span class="n">target_module</span><span class="p">,</span>
            <span class="n">target_class</span><span class="p">,</span>
            <span class="n">target_package</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">worker_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">worker</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
            <span class="n">env</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;new worker instance</span>
<span class="sd">        Args:</span>
<span class="sd">          module: instanciate and load target my_code_worker module</span>
<span class="sd">          target_module:</span>
<span class="sd">          target_class:</span>
<span class="sd">          target_package:</span>
<span class="sd">          mode: (Default value = mode)</span>
<span class="sd">          verbose: (Default value = 0)</span>
<span class="sd">          worker_id: (Default value = 0)</span>
<span class="sd">          worker: (Default value = &#39;localhost&#39;)</span>
<span class="sd">          args: (Default value = None)</span>
<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;venv:&quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">prefix</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;AgiWorker.new - worker #</span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">worker</span><span class="si">}</span><span class="s2"> from: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># import of derived Class of AgiManager, name target_inst which is typically an instance of MyCode</span>
        <span class="n">worker_class</span> <span class="o">=</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">_class_loader</span><span class="p">(</span>
            <span class="n">target_module</span><span class="p">,</span> <span class="n">target_class</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">target_package</span><span class="p">,</span> <span class="n">env</span>
        <span class="p">)</span>

        <span class="c1"># Instantiate the class with arguments</span>
        <span class="n">worker_inst</span> <span class="o">=</span> <span class="n">worker_class</span><span class="p">()</span>
        <span class="n">worker_inst</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="n">worker_inst</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="n">worker_inst</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="n">worker_inst</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target_package</span>

        <span class="c1"># Instantiate the base class</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="c1"># AgiWorker._pool_init = worker_inst.pool_init</span>
        <span class="c1"># AgiWorker._work_pool = worker_inst.work_pool</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">_insts</span><span class="p">[</span><span class="n">worker_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">worker_inst</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">_built</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">worker_id</span> <span class="o">=</span> <span class="n">worker_id</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">worker_inst</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="AgiWorker.get_worker_info">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.get_worker_info">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_worker_info</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;def get_worker_info():</span>

<span class="sd">        Args:</span>
<span class="sd">          worker_id:</span>
<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">worker</span> <span class="o">=</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">worker</span>

        <span class="c1"># Informations sur la RAM</span>
        <span class="n">ram</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span>
        <span class="n">ram_total</span> <span class="o">=</span> <span class="p">[</span><span class="n">ram</span><span class="o">.</span><span class="n">total</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span><span class="p">]</span>
        <span class="n">ram_available</span> <span class="o">=</span> <span class="p">[</span><span class="n">ram</span><span class="o">.</span><span class="n">available</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">9</span><span class="p">]</span>

        <span class="c1"># Nombre de CPU</span>
        <span class="n">cpu_count</span> <span class="o">=</span> <span class="p">[</span><span class="n">psutil</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()]</span>

        <span class="c1"># Fréquence de l&#39;horloge du CPU</span>
        <span class="n">cpu_frequency</span> <span class="o">=</span> <span class="p">[</span><span class="n">psutil</span><span class="o">.</span><span class="n">cpu_freq</span><span class="p">()</span><span class="o">.</span><span class="n">current</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">3</span><span class="p">]</span>

        <span class="c1"># Vitesse du réseau</span>
        <span class="c1"># path = AgiWorker.share_path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">share_path</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">AgiEnv</span><span class="o">.</span><span class="n">normalize_path</span><span class="p">(</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">share_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">worker</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">))</span>
        <span class="c1"># start timer</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">af</span><span class="p">:</span>
            <span class="n">af</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="n">size</span><span class="p">)</span>

        <span class="c1"># how much time it took</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">write_speed</span> <span class="o">=</span> <span class="p">[</span><span class="n">size</span> <span class="o">/</span> <span class="n">elapsed</span><span class="p">]</span>

        <span class="c1"># delete the output-data file</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="c1"># Retourner les informations sous forme de dictionnaire</span>
        <span class="n">system_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ram_total&quot;</span><span class="p">:</span> <span class="n">ram_total</span><span class="p">,</span>
            <span class="s2">&quot;ram_available&quot;</span><span class="p">:</span> <span class="n">ram_available</span><span class="p">,</span>
            <span class="s2">&quot;cpu_count&quot;</span><span class="p">:</span> <span class="n">cpu_count</span><span class="p">,</span>
            <span class="s2">&quot;cpu_frequency&quot;</span><span class="p">:</span> <span class="n">cpu_frequency</span><span class="p">,</span>
            <span class="s2">&quot;network_speed&quot;</span><span class="p">:</span> <span class="n">write_speed</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">system_info</span></div>


<div class="viewcode-block" id="AgiWorker.build">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.build">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">target_worker</span><span class="p">,</span> <span class="n">dask_home</span><span class="p">,</span> <span class="n">worker</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function to build target code on a my_code_AgiWorker.</span>

<span class="sd">        Args:</span>
<span class="sd">          app(str): app to build</span>
<span class="sd">          target_worker(str): module to build</span>
<span class="sd">          dask_home(str): path to dask home</span>
<span class="sd">          worker: current worker</span>
<span class="sd">          mode: (Default value = 0)</span>
<span class="sd">          verbose: (Default value = 0)</span>
<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;build - worker #</span><span class="si">{</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">worker_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">worker</span><span class="si">}</span><span class="s2"> from: </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">())</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;T0&quot;</span><span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;~/MyApp/&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;~/&quot;</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">home_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">logs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">AgiWorker</span><span class="o">.</span><span class="n">home_dir</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">target_worker</span><span class="si">}</span><span class="s2">_trace.txt&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">dask_home</span> <span class="o">=</span> <span class="n">dask_home</span>
        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">worker</span> <span class="o">=</span> <span class="n">worker</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">logs</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;set verbose=3 to see something in this trace file ...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;starting worker_built ...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;home_dir: </span><span class="si">{</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">home_dir</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;worker_build(target_worker=</span><span class="si">{</span><span class="n">target_worker</span><span class="si">}</span><span class="s2">,</span><span class="se">\n\t</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;dask_home=</span><span class="si">{</span><span class="n">dask_home</span><span class="si">}</span><span class="s2">,</span><span class="se">\n\t</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;mode=</span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">,</span><span class="se">\n\t</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;verbose=</span><span class="si">{</span><span class="n">verbose</span><span class="si">}</span><span class="s2">,</span><span class="se">\n\t</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;worker=</span><span class="si">{</span><span class="n">worker</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">dask_home</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t\t</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># enabling to launch the build on another user account than the agi-core one</span>
                <span class="n">extract_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">home_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;wenv&quot;</span> <span class="o">/</span> <span class="n">target_worker</span>
                <span class="n">extract_src</span> <span class="o">=</span> <span class="n">extract_path</span> <span class="o">/</span> <span class="s2">&quot;src&quot;</span>

                <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;extract_path: </span><span class="si">{</span><span class="n">extract_path</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">extract_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;sys.path:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># retrieve the egg file name without extension from the dask-scratch-space</span>
                <span class="n">egg_src</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">dask_home</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*</span><span class="si">{</span><span class="n">app</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">*.src&quot;</span><span class="p">)),</span>
                    <span class="kc">None</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">egg_src</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;No file starting with &#39;</span><span class="si">{</span><span class="n">app</span><span class="si">}</span><span class="s2">&#39; and not having suffix &#39;.src&#39; was found in </span><span class="si">{</span><span class="n">dask_home</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;worker_egg: </span><span class="si">{</span><span class="n">egg_src</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">mode</span> <span class="o">&amp;</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="c1"># case cython requested</span>
                    <span class="k">if</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">_built</span><span class="p">:</span>
                        <span class="c1"># case cython already built</span>
                        <span class="k">return</span>

                    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unzip: </span><span class="si">{</span><span class="n">egg_src</span><span class="si">}</span><span class="se">\n</span><span class="s2">to: </span><span class="si">{</span><span class="n">extract_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="c1"># unzip it into the wenv</span>
                    <span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">egg_src</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
                        <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">extract_src</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; done!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;copyfile: &#39;setup&#39; to </span><span class="si">{</span><span class="n">extract_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extract_path</span><span class="p">,</span> <span class="s2">&quot;src/agi_core/workers/agi_worker/setup&quot;</span><span class="p">),</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extract_path</span><span class="p">,</span> <span class="s2">&quot;setup&quot;</span><span class="p">),</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; done!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="n">sys_prefix</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">get_python_lib</span><span class="p">())</span>

                    <span class="c1"># clean the target lib if any</span>
                    <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;pyd&quot;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span> <span class="k">else</span> <span class="s2">&quot;so&quot;</span>
                    <span class="n">target_lib_iter</span> <span class="o">=</span> <span class="n">sys_prefix</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*</span><span class="si">{</span><span class="n">target_worker</span><span class="si">}</span><span class="s2">*.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">lib</span> <span class="ow">in</span> <span class="n">target_lib_iter</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; removing:  </span><span class="si">{</span><span class="n">lib</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">lib</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; done!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sys_prefix: </span><span class="si">{</span><span class="n">sys_prefix</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="c1"># build the target extension</span>
                    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="s2">&quot;cd&quot;</span><span class="p">,</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">extract_path</span><span class="p">),</span>
                        <span class="s2">&quot;&amp;&amp;&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;uv&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;run&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;python&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;setup&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;build_ext&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;--debug&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;-d&quot;</span><span class="p">,</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">extract_path</span><span class="p">)</span>
                    <span class="p">]</span>

                    <span class="c1"># Fixing side effect: add extract_path as a string</span>
                    <span class="n">extract_path_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">extract_path</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">extract_path_str</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extract_path_str</span><span class="p">)</span>

                    <span class="n">target_lib</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">extract_path</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="sa">f</span><span class="s2">&quot;.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
                        <span class="kc">None</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">target_lib</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No file with extension &#39;.</span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&#39; found in </span><span class="si">{</span><span class="n">extract_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span>
                        <span class="n">target_lib</span><span class="p">,</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys_prefix</span><span class="p">,</span> <span class="n">target_lib</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;running cmd: </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="se">\n</span><span class="s2">from path: </span><span class="si">{</span><span class="n">extract_path</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="n">res</span> <span class="o">=</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">extract_path</span><span class="p">,</span> <span class="n">worker</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;stdout: </span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">stdout</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;stderr: </span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; done!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="n">AgiWorker</span><span class="o">.</span><span class="n">_built</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># case worker egg need to be added to sys.path</span>
                    <span class="n">egg_dest</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="n">extract_path</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">egg_src</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.egg&quot;</span>
                    <span class="p">)</span>

                    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;copy:</span><span class="se">\n</span><span class="si">{</span><span class="n">egg_src</span><span class="si">}</span><span class="se">\n</span><span class="s2">to:</span><span class="se">\n</span><span class="si">{</span><span class="n">egg_dest</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">egg_src</span><span class="p">,</span> <span class="n">egg_dest</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">egg_dest</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">egg_dest</span><span class="p">)</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">egg_dest</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;sys.path:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; done!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># os.remove(AgiWorker.logs)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;worker&lt;</span><span class="si">{</span><span class="n">worker</span><span class="si">}</span><span class="s2">&gt; - fail to build </span><span class="si">{</span><span class="n">target_worker</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">dask_home</span><span class="si">}</span><span class="s2">, see </span><span class="si">{</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">logs</span><span class="si">}</span><span class="s2"> for details&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">err</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="AgiWorker.do_works">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.do_works">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">do_works</span><span class="p">(</span><span class="n">workers_tree</span><span class="p">,</span> <span class="n">workers_tree_info</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;run of workers</span>

<span class="sd">        Args:</span>
<span class="sd">          chunk: distribution tree</span>
<span class="sd">          chunks:</span>
<span class="sd">        Returns:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">worker_id</span> <span class="o">=</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">worker_id</span>
        <span class="k">if</span> <span class="n">AgiWorker</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;do_works - worker #</span><span class="si">{</span><span class="n">worker_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">AgiWorker</span><span class="o">.</span><span class="n">worker</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;AgiWorker.work - #</span><span class="si">{</span><span class="n">worker_id</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">workers_tree</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">AgiWorker</span><span class="o">.</span><span class="n">_insts</span><span class="p">[</span><span class="n">worker_id</span><span class="p">]</span><span class="o">.</span><span class="n">works</span><span class="p">(</span><span class="n">workers_tree</span><span class="p">,</span> <span class="n">workers_tree_info</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="AgiWorker.normalize_path">
<a class="viewcode-back" href="../../../../agi-workers.html#agi_core.workers.agi_worker.agi_worker.AgiWorker.normalize_path">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">normalize_path</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">PureWindowsPath</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span>
            <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">PurePosixPath</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)))</span>
        <span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, THALES SIX GTS France SAS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>